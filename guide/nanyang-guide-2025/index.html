<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>躬耕南阳 - 菌子种植助手</title>
    <link rel="icon" type="image/svg+xml" href="./assets/logo.svg" />
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
      :root {
        --primary: #4caf50;
        --dark: #2c3e50;
        --light: #f5f7fa;
        --border: #ddd;
        --danger: #e74c3c;
        --warning: #f39c12;
        --accent: #8e44ad;
        --info: #3498db;
      }
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: var(--light);
        color: #333;
      }
      .container {
        max-width: 1100px;
        margin: 0 auto;
        background: white;
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      }

      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        flex-wrap: wrap;
        gap: 15px;
      }
      h1 {
        margin: 0;
        font-size: 1.6rem;
        color: var(--dark);
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .user-controls {
        display: flex;
        gap: 10px;
        align-items: center;
        background: #eee;
        padding: 5px 10px;
        border-radius: 8px;
      }
      select,
      button,
      input[type="text"] {
        padding: 8px 12px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 0.9rem;
      }
      button {
        cursor: pointer;
        background-color: var(--info);
        color: white;
        border: none;
        transition: 0.2s;
        border-radius: 4px;
      }
      button:hover {
        filter: brightness(1.1);
      }
      button.danger {
        background-color: var(--danger);
      }
      .icon-btn {
        width: 28px;
        height: 28px;
        padding: 0;
        border-radius: 8px;
        border: 1px solid #d0d7e2;
        background: white;
        color: #5b6b82;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
        line-height: 1;
      }
      .icon-btn:hover {
        border-color: var(--primary);
        color: var(--primary);
        filter: none;
      }
      .icon-btn.danger {
        border-color: #f0b2b2;
        color: #d84343;
        background: #fff5f5;
      }
      .icon-btn.danger:hover {
        border-color: #e57373;
        color: #c62828;
      }
      .btn-deliver-order {
        background-color: var(--primary);
      }
      .tabs {
        display: flex;
        margin-bottom: 25px;
        border-bottom: 2px solid #eee;
        overflow-x: auto;
        scrollbar-width: none;
        -ms-overflow-style: none;
      }
      .tabs::-webkit-scrollbar {
        display: none;
      }
      .tab {
        padding: 12px 25px;
        cursor: pointer;
        font-weight: bold;
        color: #7f8c8d;
        position: relative;
        transition: 0.3s;
        white-space: nowrap;
      }
      .tab:hover {
        color: var(--primary);
      }
      .tab.active {
        color: var(--primary);
      }
      .tab.active::after {
        content: "";
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 100%;
        height: 3px;
        background: var(--primary);
      }

      .section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin: 30px 0 15px;
        border-left: 5px solid var(--primary);
        padding-left: 15px;
        flex-wrap: wrap;
        gap: 10px;
      }
      .section-title {
        font-size: 1.2rem;
        font-weight: bold;
        margin: 0;
      }
      .filter-switch {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.9rem;
        cursor: pointer;
        user-select: none;
      }
      .collection-search {
        display: flex;
        align-items: center;
        gap: 8px;
        flex-wrap: wrap;
      }
      .collection-order-toggle {
        border: 1px solid #d4deee;
        background: white;
        color: #4f6b9b;
        font-size: 0.8rem;
        padding: 6px 12px;
        border-radius: 999px;
        cursor: pointer;
      }
      .collection-order-toggle:hover {
        border-color: var(--primary);
        color: var(--primary);
      }
      .collection-order-toggle.active {
        background: #eef3ff;
        border-color: #9bbcf0;
        color: #3f5f9a;
      }

      .tags-container {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }
      .tag {
        padding: 6px 14px;
        border: 1px solid #ccc;
        border-radius: 20px;
        cursor: pointer;
        font-size: 0.9rem;
        user-select: none;
        transition: 0.2s;
        background: white;
      }
      .tag:hover {
        border-color: var(--primary);
        color: var(--primary);
      }
      .tag.selected {
        background-color: var(--primary);
        color: white;
        border-color: var(--primary);
      }

      .collection-layout {
        display: flex;
        gap: 20px;
        position: relative;
        align-items: flex-start;
      }
      .collection-main {
        flex: 1;
        min-width: 0;
      }

      .toc-sidebar {
        width: 160px;
        position: sticky;
        top: 20px;
        background: #f8f9fa;
        border-radius: 8px;
        padding: 10px;
        max-height: 80vh;
        overflow-y: auto;
        flex-shrink: 0;
        border: 1px solid #eee;
      }
      .toc-title {
        font-size: 0.9rem;
        font-weight: bold;
        color: #666;
        margin-bottom: 10px;
        padding-left: 5px;
      }
      .toc-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      .toc-item {
        font-size: 0.85rem;
        padding: 6px 10px;
        border-radius: 4px;
        cursor: pointer;
        color: #555;
        transition: 0.2s;
        text-decoration: none;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
      }
      .toc-label {
        flex: 1;
        min-width: 0;
      }
      .toc-progress {
        font-size: 0.75rem;
        font-weight: bold;
        white-space: nowrap;
      }
      .toc-progress.progress-complete {
        color: var(--primary);
      }
      .toc-progress.progress-partial {
        color: var(--warning);
      }
      .toc-progress.progress-empty {
        color: #bbb;
      }
      .toc-item:hover {
        background: #e8f5e9;
        color: var(--primary);
      }
      .toc-item.unowned {
        color: #aaa;
      }
      .toc-item.unowned:hover {
        color: #666;
      }
      .toc-item.active {
        background: var(--primary);
        color: white !important;
      }

      .collection-group-header {
        display: flex;
        align-items: center;
        cursor: pointer;
        user-select: none;
        padding: 10px 0;
        margin-bottom: 10px;
        transition: 0.2s;
      }
      .collection-group-header:hover {
        opacity: 0.8;
      }
      .group-arrow {
        margin-right: 10px;
        transition: transform 0.3s;
        font-size: 0.8rem;
        color: #999;
      }
      .group-arrow.open {
        transform: rotate(90deg);
      }
      .collection-group-title {
        font-size: 1.1rem;
        color: var(--dark);
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 10px;
        flex: 1;
      }
      .collection-group-title::after {
        content: "";
        flex: 1;
        height: 1px;
        background: #eee;
        margin-left: 15px;
      }
      .collection-group-action {
        border: 1px solid #d4deee;
        background: white;
        color: #4f6b9b;
        font-size: 0.75rem;
        padding: 4px 10px;
        border-radius: 999px;
        cursor: pointer;
        white-space: nowrap;
      }
      .collection-group-action:hover {
        border-color: var(--primary);
        color: var(--primary);
      }

      .collection-grid {
        display: grid;
        grid-template-columns: repeat(6, minmax(0, 1fr));
        gap: 12px;
        animation: slideDown 0.3s ease-out;
      }
      .collection-grid.ingame-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-5px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .mushroom-card {
        border: 1px solid #eee;
        padding: 10px;
        border-radius: 8px;
        cursor: pointer;
        position: relative;
        background: #fff;
        transition: 0.2s;
        display: flex;
        flex-direction: column;
        gap: 5px;
      }
      .mushroom-card .target-img-box {
        align-self: center;
      }
      .mushroom-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      }
      .mushroom-card.collected {
        background-color: #f1f8e9;
        border-color: #c5e1a5;
        opacity: 0.6;
      }
      .mushroom-card.is-pending {
        background-color: #fff7e8;
        border-color: var(--warning);
        border-style: dashed;
      }
      .mushroom-card.is-locked {
        filter: grayscale(1);
        opacity: 0.6;
      }
      .mushroom-card.collected::after {
        content: "✔";
        position: absolute;
        right: 8px;
        top: 8px;
        color: var(--primary);
        font-weight: bold;
      }
      .m-name {
        font-weight: bold;
        font-size: 0.9rem;
      }
      .m-info {
        font-size: 0.8rem;
        color: #777;
      }

      .rec-card {
        border: 1px solid #e0e0e0;
        border-radius: 10px;
        margin-bottom: 20px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
      }
      .rec-header {
        background: var(--dark);
        color: white;
        padding: 12px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .rec-score {
        background: var(--primary);
        color: white;
        padding: 3px 10px;
        border-radius: 12px;
        font-size: 0.85rem;
        font-weight: bold;
      }
      .rec-header-actions {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .rec-pin {
        background: transparent;
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.45);
        font-size: 0.75rem;
        padding: 4px 10px;
        border-radius: 12px;
      }
      .rec-pin.active {
        background: #fff7e8;
        border-color: #fff7e8;
        color: white;
        box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.15) inset;
      }
      .rec-pin:hover {
        background: rgba(255, 255, 255, 0.15);
      }
      .rec-copy {
        background: transparent;
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.45);
        font-size: 0.75rem;
        padding: 4px 10px;
        border-radius: 12px;
      }
      .rec-copy:hover {
        background: rgba(255, 255, 255, 0.15);
      }
      .toast {
        position: fixed;
        left: 50%;
        bottom: 24px;
        transform: translateX(-50%) translateY(8px);
        background: rgba(33, 33, 33, 0.95);
        color: white;
        padding: 8px 14px;
        border-radius: 999px;
        font-size: 0.8rem;
        opacity: 0;
        pointer-events: none;
        transition: 0.2s ease;
        z-index: 999;
      }
      .toast.show {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
      .rec-config {
        padding: 15px 20px;
        background: #f8f9fa;
        border-bottom: 1px solid #eee;
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
        font-weight: 600;
        color: #444;
      }
      .rec-config .rarity-common {
        color: #2b6cb0;
      }
      .rec-config .rarity-rare {
        color: #7a3ed1;
      }
      .rec-config .rarity-legend {
        color: #b8860b;
      }
      .rec-config-tip {
        margin-left: auto;
        font-size: 0.9rem;
        color: #8a8a8a;
        text-align: right;
      }
      .rec-body {
        padding: 20px;
      }
      .target-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
        gap: 15px;
      }
      .target-cell {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 8px;
        padding: 10px;
        border: 1px solid #eee;
        border-radius: 8px;
        background: white;
        cursor: pointer;
        position: relative;
        transition: all 0.2s;
        overflow: hidden;
      }
      .target-cell:hover {
        border-color: var(--primary);
        box-shadow: 0 4px 12px rgba(76, 175, 80, 0.2);
        transform: translateY(-2px);
      }
      .target-cell:not(.is-pending):hover::before {
        content: "✔";
        position: absolute;
        top: 5px;
        right: 5px;
        color: white;
        background: var(--primary);
        border-radius: 50%;
        width: 20px;
        height: 20px;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 1;
        z-index: 2;
      }
      .target-cell.is-failed {
        border: 2px dashed var(--warning);
        background: #fffcf5;
      }

      .target-img-box {
        width: 60px;
        height: 60px;
        background: #f9f9f9;
        border-radius: 8px;
        overflow: hidden;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .target-img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }
      .long-time-tag {
        position: absolute;
        right: 0px;
        bottom: 0px;
        background: rgba(195, 164, 251, 0.9);
        color: white;
        font-size: 1rem;
        border-radius: 999px;
        letter-spacing: 0.02em;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        z-index: 12;
        pointer-events: none;
      }
      .target-tags {
        position: absolute;
        left: 2px;
        top: 2px;
        display: flex;
        flex-direction: column;
        gap: 2px;
        z-index: 12;
        pointer-events: none;
      }
      .target-tag {
        font-size: 0.62rem;
        padding: 2px 4px;
        border-radius: 999px;
        font-weight: 600;
        color: white;
        text-align: center;
      }
      .tag-immortal {
        background: rgba(212, 175, 55, 0.95);
      }
      .tag-easy {
        background: rgba(76, 175, 80, 0.92);
      }
      .tag-normal {
        background: rgba(255, 167, 38, 0.92);
      }
      .tag-hard {
        background: rgba(239, 108, 0, 0.92);
      }
      .tag-jail {
        background: rgba(117, 117, 117, 0.92);
      }
      .target-placeholder {
        font-size: 24px;
        color: #ddd;
      }
      .target-name {
        font-size: 0.75rem;
        font-weight: bold;
        line-height: 1.3;
        min-height: 2.6em;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .target-cell.is-pending {
        border-color: var(--warning);
        background: #fff7e8;
      }
      .pending-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(243, 156, 18, 1);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        gap: 6px;
        z-index: 10;
        border-radius: 8px;
        animation: fadeIn 0.2s;
        text-align: center;
        padding: 0;
      }
      .pending-img {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }
      .pending-tag {
        position: absolute;
        top: 0px;
        left: 0px;
        background: rgba(122, 79, 0, 0.9);
        color: white;
        font-size: 0.65rem;
        padding: 2px 6px;
        border-radius: 999px;
        letter-spacing: 0.02em;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      .pending-title {
        font-size: 0.72rem;
        font-weight: bold;
        letter-spacing: 0.02em;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.25);
        line-height: 1;
      }
      .pending-actions {
        display: flex;
        gap: 4px;
        justify-content: center;
        flex-wrap: wrap;
      }
      .pending-action {
        background: rgba(255, 255, 255, 0.95);
        color: #7a4f00;
        border: 1px solid rgba(255, 255, 255, 0.6);
        font-size: 0.72rem;
        padding: 4px 12px;
        border-radius: 999px;
      }
      .pending-action.confirm {
        background: rgba(243, 156, 18, 0.18);
        color: #7a4f00;
        border: 1px solid rgba(243, 156, 18, 0.35);
      }

      .condition-badge {
        font-size: 0.75rem;
        padding: 3px 8px;
        border-radius: 12px;
        font-weight: bold;
      }
      .badge-soup {
        background-color: #424242;
        color: #ffffff;
        border: 1px solid #212121;
      }
      .badge-tablet {
        background-color: #ffcdd2;
        color: #c62828;
        border: 1px solid #ef9a9a;
      }
      .badge-insect {
        background-color: #e8f5e9;
        color: #2e7d32;
        border: 1px solid #a5d6a7;
      }
      .badge-normal {
        background-color: #f5f5f5;
        color: #757575;
        border: 1px solid #e0e0e0;
        font-weight: normal;
      }

      .empty-tip {
        text-align: center;
        color: #999;
        padding: 40px;
        background: #fafafa;
        border-radius: 8px;
        margin-top: 20px;
      }
      .empty-guide {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 12px;
        align-items: center;
      }
      .empty-guide-item {
        display: flex;
        align-items: center;
        gap: 6px;
        flex-wrap: wrap;
        justify-content: center;
      }
      .empty-link {
        border: 1px solid #c5e1a5;
        background: #eef7e5;
        color: #2e7d32;
        border-radius: 999px;
        padding: 2px 10px;
        font-size: 0.85rem;
        cursor: pointer;
      }
      .empty-link:hover {
        border-color: var(--primary);
        color: var(--primary);
      }
      .time-selector {
        display: flex;
        gap: 15px;
        background: #f0f2f5;
        padding: 10px 20px;
        border-radius: 30px;
        width: fit-content;
        align-items: center;
        flex-wrap: wrap;
      }
      .time-progress-wrap {
        display: flex;
        align-items: center;
        gap: 12px;
        flex-wrap: wrap;
      }
      .time-progress {
        font-size: 0.85rem;
        color: #666;
      }
      .progress-unlockable {
        margin-left: 10px;
        color: #6b7a8b;
        font-weight: 600;
      }
      .progress-unlockable-secondary {
        margin-left: 8px;
        color: #8a97aa;
        font-weight: 600;
      }
      .order-panel {
        background: #f8f9fa;
        border: 1px solid #eee;
        border-radius: 10px;
        padding: 12px 16px;
        margin-bottom: 20px;
      }
      .order-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 10px;
      }
      .order-title {
        font-weight: bold;
        color: #444;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .order-header-actions {
        display: flex;
        align-items: center;
        gap: 10px;
        flex-wrap: wrap;
      }
      .order-add-btn {
        border-color: var(--primary);
        color: var(--primary);
      }
      .order-add-btn:hover {
        background: var(--primary);
        color: white;
      }
      .order-list-toggle {
        background: #f4f7fb;
        color: #4f6b9b;
        border: 1px solid #d4deee;
        border-radius: 999px;
        padding: 2px 10px;
        font-size: 0.75rem;
        cursor: pointer;
      }
      .order-list-toggle:hover {
        background: #e6edf7;
      }
      .order-options {
        display: flex;
        align-items: center;
        flex-wrap: wrap;
        gap: 12px;
        font-size: 0.85rem;
        color: #666;
      }
      .order-form {
        margin-top: 8px;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .order-name-row {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .order-reward-row {
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .order-reward-row input[type="number"] {
        width: 120px;
      }
      .order-reward-label {
        font-size: 0.8rem;
        color: #666;
      }
      .order-presets {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
      }
      .order-preset {
        background: white;
        border: 1px solid #eee;
        border-radius: 999px;
        padding: 4px 10px;
        font-size: 0.8rem;
        cursor: pointer;
        color: #555;
      }
      .order-preset:hover {
        border-color: var(--primary);
        color: var(--primary);
      }
      .order-search {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 4px;
        flex-wrap: wrap;
      }
      .order-search input[type="text"] {
        flex: 1;
        min-width: 220px;
      }
      .order-results {
        margin-top: 8px;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
        gap: 10px;
      }
      .order-results-wrap {
        margin-top: 8px;
        background: #f1f4f8;
        border: 1px dashed #d0dae8;
        border-radius: 10px;
        padding: 8px;
      }
      .order-picker {
        max-height: 60vh;
        overflow-y: auto;
      }
      .collection-picker {
        width: 100%;
        flex-basis: 100%;
      }
      .order-picker-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
        margin-bottom: 6px;
      }
      .order-picker-tabs {
        display: flex;
        gap: 6px;
        flex-wrap: nowrap;
        overflow-x: auto;
        padding-bottom: 4px;
        scrollbar-width: none;
      }
      .order-picker-tabs::-webkit-scrollbar {
        display: none;
      }
      .order-picker-tab {
        background: white;
        border: 1px solid #d6ddea;
        border-radius: 999px;
        padding: 2px 10px;
        font-size: 0.72rem;
        cursor: pointer;
        color: #5b6f91;
        white-space: nowrap;
      }
      .order-picker-tab:hover {
        border-color: var(--primary);
        color: var(--primary);
      }
      .order-picker-tab.active {
        border-color: var(--primary);
        color: var(--primary);
        background: rgba(62, 121, 191, 0.08);
      }
      .order-picker-close {
        background: white;
        border: 1px solid #d6ddea;
        border-radius: 999px;
        padding: 2px 10px;
        font-size: 0.7rem;
        cursor: pointer;
        color: #5b6f91;
      }
      .order-picker-close:hover {
        border-color: var(--primary);
        color: var(--primary);
      }
      .order-picker-group + .order-picker-group {
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px dashed #d0dae8;
      }
      .order-picker-title {
        font-size: 0.78rem;
        font-weight: 600;
        color: #536a88;
      }
      .order-picker .order-results {
        margin-top: 6px;
        grid-template-columns: repeat(9, minmax(0, 1fr));
      }
      .order-subtitle {
        font-size: 0.75rem;
        color: #6f82a3;
        font-weight: 600;
        margin-bottom: 6px;
      }
      .order-result {
        background: white;
        border: 1px solid #eee;
        border-radius: 8px;
        padding: 8px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
        cursor: pointer;
        font-size: 0.75rem;
        text-align: center;
      }
      .order-result:hover {
        border-color: var(--primary);
        color: var(--primary);
      }
      .order-result:hover .order-result-name {
        color: var(--primary);
      }
      .handbook-result {
        position: relative;
      }
      .handbook-result.collected {
        background-color: #f1f8e9;
        border-color: #c5e1a5;
        opacity: 0.6;
      }
      .handbook-result.is-pending {
        background-color: #fff7e8;
        border-color: var(--warning);
        border-style: dashed;
      }
      .handbook-result.is-locked {
        filter: grayscale(1);
        opacity: 0.6;
      }
      .order-result-name {
        font-weight: 600;
        color: #444;
        line-height: 1.2;
        min-height: 2.4em;
      }
      .order-result-img {
        width: 54px;
        height: 54px;
      }
      .order-results .order-empty {
        grid-column: 1 / -1;
      }
      .order-result-meta {
        color: #888;
        font-size: 0.75rem;
      }
      .order-items {
        margin-top: 8px;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .order-edit-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 10px;
      }
      .order-item {
        background: white;
        border: 1px solid #eee;
        border-radius: 8px;
        padding: 8px 10px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
        flex-wrap: wrap;
      }
      .order-edit-cell {
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 6px;
        position: relative;
        padding: 8px;
        justify-content: flex-start;
      }
      .order-item-name {
        font-size: 0.85rem;
        font-weight: 600;
        color: #444;
        line-height: 1.2;
        min-height: 2.4em;
      }
      .order-item-fields {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
        font-size: 0.75rem;
        color: #666;
      }
      .order-item-row {
        display: flex;
        align-items: center;
        gap: 6px;
      }
      .order-item-fields input[type="number"] {
        width: 64px;
      }
      .order-item-remove {
        border: none;
        background: #f1f1f1;
        color: #666;
        border-radius: 50%;
        width: 22px;
        height: 22px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8rem;
        cursor: pointer;
        padding: 0;
      }
      .order-edit-cell .order-item-remove {
        position: absolute;
        top: 6px;
        right: 6px;
      }
      .order-item-remove:hover {
        background: #e2e2e2;
      }
      .order-actions {
        display: flex;
        align-items: center;
        gap: 8px;
        flex-wrap: wrap;
        margin-top: 8px;
      }
      .order-empty {
        margin-top: 8px;
        font-size: 0.8rem;
        color: #999;
      }
      .order-list {
        margin-top: 12px;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
        gap: 12px;
      }
      .order-list-note {
        margin-top: 12px;
        padding: 10px 12px;
        border-radius: 10px;
        background: #fff7e8;
        color: #8a6d3b;
        font-size: 0.8rem;
        line-height: 1.5;
      }
      .order-card {
        background: white;
        border: 1px solid #eee;
        border-radius: 10px;
        padding: 10px;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .order-card.highlight {
        border-color: rgba(199, 50, 45, 0.7);
        box-shadow: 0 0 0 2px rgba(215, 92, 48, 0.2);
        background: #fbf7f6;
      }
      .order-card.ready {
        border-color: #8bc98b;
        background: #f2fff2;
      }
      .order-card.ready.highlight {
        border-color: rgba(199, 50, 45, 0.7);
        box-shadow: 0 0 0 2px rgba(215, 92, 48, 0.2);
        background: #fbf7f6;
      }
      .order-card.ready .order-card-title {
        color: #2e7d32;
      }
      .order-card.focused {
        animation: orderFocus 1.35s ease-out;
      }
      @keyframes orderFocus {
        0% {
          box-shadow: 0 0 0 0 rgba(88, 180, 107, 0);
        }
        40% {
          box-shadow: 0 0 0 6px rgba(88, 180, 107, 0.35);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(88, 180, 107, 0);
        }
      }
      .order-float {
        position: fixed;
        right: 24px;
        top: 50%;
        transform: translateY(-50%);
        width: 320px;
        background: linear-gradient(180deg, #ffffff 0%, #f4fbf5 100%);
        border: 1px solid #d7eadb;
        border-radius: 16px;
        padding: 16px 18px;
        box-shadow: 0 16px 36px rgba(0, 0, 0, 0.14);
        z-index: 99;
        transition: background 0.3s ease, border-color 0.3s ease;
      }
      .order-float.collapsed {
        width: 140px;
        padding: 14px;
      }
      .order-float.night {
        background: linear-gradient(180deg, #1f2a3a 0%, #202f45 100%);
        border-color: rgba(133, 171, 224, 0.4);
        color: #e6eefc;
      }
      .order-float.pulse {
        animation: floatPulse 1.1s ease-out;
      }
      @keyframes floatPulse {
        0% {
          box-shadow: 0 16px 36px rgba(0, 0, 0, 0.14),
            0 0 0 0 rgba(76, 175, 80, 0);
        }
        40% {
          box-shadow: 0 18px 40px rgba(0, 0, 0, 0.18),
            0 0 0 8px rgba(76, 175, 80, 0.3);
        }
        100% {
          box-shadow: 0 16px 36px rgba(0, 0, 0, 0.14),
            0 0 0 0 rgba(76, 175, 80, 0);
        }
      }
      .order-float-head {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 10px;
        margin-bottom: 14px;
      }
      .order-float.collapsed .order-float-head {
        justify-content: center;
        margin-bottom: 10px;
      }
      .order-float-icon {
        border: none;
        background: #f6f3ea;
        border-radius: 14px;
        width: 56px;
        height: 56px;
        font-size: 1.6rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: inset 0 0 0 1px rgba(88, 180, 107, 0.25);
      }
      .order-float.collapsed .order-float-icon {
        width: 64px;
        height: 64px;
        font-size: 1.8rem;
      }
      .order-float.night .order-float-icon {
        background: rgba(143, 177, 229, 0.16);
        box-shadow: inset 0 0 0 1px rgba(133, 171, 224, 0.35);
      }
      .order-float-heading {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 2px;
      }
      .order-float-title {
        font-size: 1rem;
        font-weight: 600;
        color: #2f4d3a;
        margin: 0;
      }
      .order-float-subtitle {
        font-size: 0.75rem;
        color: #6a7c6e;
      }
      .order-float.night .order-float-subtitle {
        color: rgba(230, 238, 252, 0.75);
      }
      .order-float.night .order-float-title {
        color: #e6eefc;
      }
      .order-float-toggle {
        display: inline-flex;
        gap: 2px;
        padding: 2px;
        border-radius: 999px;
        border: 1px solid #cfe5d1;
        background: #eff7f0;
      }
      .order-float-toggle button {
        border: none;
        background: transparent;
        color: inherit;
        font-size: 0.7rem;
        padding: 4px 8px;
        border-radius: 999px;
        cursor: pointer;
      }
      .order-float-toggle button.active {
        background: #2e7d32;
        color: white;
      }
      .order-float.night .order-float-toggle {
        border-color: rgba(133, 171, 224, 0.5);
        background: rgba(255, 255, 255, 0.08);
      }
      .order-float.night .order-float-toggle button.active {
        background: #4f6b9b;
      }
      .order-float-collapse {
        border: 1px solid #d7eadb;
        background: #f4fbf5;
        color: #2f4d3a;
        border-radius: 999px;
        padding: 4px 10px;
        font-size: 0.7rem;
        cursor: pointer;
      }
      .order-float.night .order-float-collapse {
        border-color: rgba(133, 171, 224, 0.4);
        background: rgba(255, 255, 255, 0.08);
        color: #e6eefc;
      }
      .order-float-collapsed {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        gap: 6px;
      }
      .order-float-collapsed-hint {
        font-size: 0.7rem;
        color: #2f4d3a;
      }
      .order-float.night .order-float-collapsed-hint {
        color: #e6eefc;
      }
      .order-float-expand {
        border: 1px solid #cfe5d1;
        background: #ffffff;
        color: #2f4d3a;
        border-radius: 999px;
        padding: 4px 10px;
        font-size: 0.7rem;
        cursor: pointer;
      }
      .order-float.night .order-float-expand {
        border-color: rgba(133, 171, 224, 0.4);
        background: rgba(255, 255, 255, 0.08);
        color: #e6eefc;
      }
      .order-float-list {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .order-float-item {
        border: 1px solid #cfe5d1;
        background: #f4fbf5;
        color: #2f4d3a;
        border-radius: 8px;
        padding: 6px 8px;
        font-size: 0.8rem;
        text-align: left;
      }
      .order-float-item:hover {
        border-color: var(--primary);
        color: var(--primary);
        background: #eef8ef;
      }
      .order-float.night .order-float-item {
        border-color: rgba(133, 171, 224, 0.4);
        background: rgba(255, 255, 255, 0.08);
        color: #e6eefc;
      }
      .order-float.night .order-float-item:hover {
        border-color: #8fb1e5;
        color: white;
        background: rgba(143, 177, 229, 0.2);
      }
      .order-float-section {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .order-float-section-title {
        font-size: 0.8rem;
        font-weight: 600;
        color: #4f6b9b;
      }
      .order-float.night .order-float-section-title {
        color: #c9d9f3;
      }
      .order-float-progress {
        font-size: 0.75rem;
        color: #4f6b9b;
        border: none;
        background: transparent;
        padding: 0;
        cursor: pointer;
        text-align: left;
      }
      .order-float-unlockable {
        font-size: 0.7rem;
        color: #6f82a3;
        margin-top: 4px;
      }
      .order-float.night .order-float-progress {
        color: #c9d9f3;
      }
      .order-float.night .order-float-unlockable {
        color: rgba(201, 217, 243, 0.85);
      }
      .order-float-empty {
        font-size: 0.75rem;
        color: #8a9a8c;
      }
      .order-float.night .order-float-empty {
        color: rgba(230, 238, 252, 0.6);
      }
      .order-float-figure {
        display: flex;
        align-items: flex-end;
        gap: 10px;
        margin-top: 14px;
      }
      .order-float-img {
        width: 56px;
        height: 56px;
        object-fit: contain;
      }
      .order-float-bubble {
        position: relative;
        flex: 1;
        background: white;
        color: #2f4d3a;
        border: 1px solid #d7eadb;
        border-radius: 12px;
        padding: 8px 10px;
        font-size: 0.75rem;
        line-height: 1.4;
        display: flex;
        align-items: center;
        gap: 6px;
        flex-wrap: wrap;
      }
      .order-float-bubble .bubble-link {
        border: none;
        background: transparent;
        color: #2e7d32;
        font-size: 0.75rem;
        padding: 0;
        cursor: pointer;
        text-decoration: underline;
      }
      .order-float-bubble::after {
        content: "";
        position: absolute;
        left: -6px;
        bottom: 12px;
        width: 10px;
        height: 10px;
        background: inherit;
        border-left: 1px solid #d7eadb;
        border-bottom: 1px solid #d7eadb;
        transform: rotate(45deg);
      }
      .order-float.night .order-float-bubble {
        background: rgba(255, 255, 255, 0.12);
        color: #e6eefc;
        border-color: rgba(133, 171, 224, 0.4);
      }
      .order-float.night .order-float-bubble .bubble-link {
        color: #c9d9f3;
      }
      .order-float.night .order-float-bubble::after {
        border-left-color: rgba(133, 171, 224, 0.4);
        border-bottom-color: rgba(133, 171, 224, 0.4);
      }
      .mobile-only {
        display: none;
      }
      @media (max-width: 720px) {
        .order-float {
          left: 16px;
          right: 16px;
          top: auto;
          bottom: 16px;
          transform: none;
          width: auto;
        }
        .order-float.collapsed {
          left: auto;
          right: 16px;
          width: fit-content;
          max-width: none;
          padding: 10px;
        }
      }
      @media (max-width: 720px) {
        body {
          padding: 12px;
        }
        .container {
          padding: 16px;
          border-radius: 10px;
        }
        header {
          flex-direction: column;
          align-items: flex-start;
        }
        h1 {
          font-size: 1.35rem;
        }
        .user-controls {
          width: 100%;
          flex-wrap: wrap;
        }
        .user-controls select,
        .user-controls button,
        .user-controls input[type="text"] {
          flex: 1 1 120px;
        }
        .tabs {
          margin-bottom: 16px;
        }
        .tab {
          padding: 10px 14px;
          font-size: 0.9rem;
        }
        .section-header {
          margin: 20px 0 12px;
          align-items: flex-start;
        }
        .time-selector {
          width: 100%;
          flex-wrap: wrap;
          justify-content: flex-start;
        }
        .collection-layout {
          flex-direction: column;
        }
        .collection-main {
          order: 1;
        }
        .toc-sidebar {
          width: 100%;
          position: static;
          max-height: none;
          margin-top: 12px;
        }
        .collection-grid {
          grid-template-columns: repeat(3, minmax(0, 1fr));
          gap: 10px;
        }
        .collection-grid.ingame-grid {
          grid-template-columns: repeat(3, minmax(0, 1fr));
        }
        .order-picker-tabs {
          display: grid;
          grid-template-columns: repeat(3, minmax(0, 1fr));
          gap: 6px;
          overflow-x: visible;
        }
        .order-picker-tab {
          width: 100%;
          text-align: center;
        }
        .order-results {
          grid-template-columns: repeat(3, minmax(0, 1fr));
        }
        .order-picker .order-results {
          grid-template-columns: repeat(3, minmax(0, 1fr));
        }
        .mobile-only {
          display: inline;
        }
        .m-name {
          font-size: 0.8rem;
        }
        .rec-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 8px;
        }
        .rec-header-actions {
          width: 100%;
          flex-wrap: wrap;
          justify-content: flex-start;
        }
        .rec-config {
          padding: 12px 14px;
          gap: 10px;
          font-size: 0.9rem;
        }
        .rec-body {
          padding: 14px;
        }
        .target-grid {
          gap: 10px;
        }
        .target-cell {
          padding: 8px;
          gap: 6px;
        }
        .target-img-box {
          width: 52px;
          height: 52px;
        }
        .target-name {
          font-size: 0.7rem;
        }
        .order-panel {
          padding: 10px 12px;
        }
        .order-header {
          flex-direction: column;
          align-items: flex-start;
        }
        .order-header-actions {
          width: 100%;
          justify-content: space-between;
        }
        .order-options {
          width: 100%;
          flex-direction: column;
          align-items: flex-start;
        }
        .order-list {
          grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        }
        .order-item-grid {
          grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
        }
        .order-float {
          max-height: 70vh;
          overflow-y: auto;
          padding: 14px 16px;
        }
        .order-float-head {
          flex-wrap: wrap;
          align-items: flex-start;
        }
        .order-float-icon {
          width: 48px;
          height: 48px;
          font-size: 1.4rem;
        }
        .order-float-toggle {
          width: 100%;
          justify-content: flex-start;
        }
        .order-float-figure {
          align-items: center;
        }
        .toast {
          bottom: 92px;
        }
      }
      .order-card-header {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        gap: 8px;
        flex-wrap: wrap;
      }
      .order-card-title {
        font-weight: 600;
        color: #444;
        display: flex;
        align-items: center;
        gap: 8px;
        flex-wrap: wrap;
      }
      .order-reward {
        font-size: 0.7rem;
        color: #9a6a00;
        background: #fff3cf;
        border-radius: 999px;
        padding: 2px 8px;
      }
      .order-card-actions {
        display: flex;
        align-items: center;
        gap: 6px;
        flex-wrap: wrap;
      }
      .order-item-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
        gap: 8px;
      }
      .order-item-grid.compact-3 {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
      .order-item-cell {
        border: 1px dashed #9bbcf0;
        background: #f4f8ff;
        border-radius: 8px;
        padding: 6px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 6px;
        text-align: center;
        position: relative;
      }
      .order-target-tip {
        position: fixed;
        left: 0;
        top: 0;
        background: rgba(35, 35, 35, 0.95);
        color: white;
        font-size: 0.65rem;
        line-height: 1.4;
        padding: 6px 8px;
        border-radius: 8px;
        box-shadow: 0 8px 18px rgba(0, 0, 0, 0.18);
        z-index: 999;
        display: inline-flex;
        flex-direction: column;
        gap: 2px;
        pointer-events: none;
      }
      .order-target-tip-line {
        white-space: nowrap;
        display: inline-flex;
        align-items: center;
        gap: 4px;
      }
      .order-target-tip-key {
        color: rgba(255, 255, 255, 0.75);
      }
      .order-target-tip .tooltip-rarity-common {
        color: #7db9ff;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
        font-weight: 600;
      }
      .order-target-tip .tooltip-rarity-rare {
        color: #c9a1ff;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
        font-weight: 600;
      }
      .order-target-tip .tooltip-rarity-legend {
        color: #ffd46a;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
        font-weight: 600;
      }
      .order-target-tip .tooltip-condition-soup {
        color: #ffcf6a;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
        font-weight: 600;
      }
      .order-target-tip .tooltip-condition-tablet {
        color: #ff8a8a;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
        font-weight: 600;
      }
      .order-count {
        font-size: 0.7rem;
        color: #4f6b9b;
        background: #e6efff;
        padding: 2px 6px;
        border-radius: 999px;
      }
      .order-count.met {
        background: #daf3da;
        color: #2e7d32;
        border: 1px solid #bfe7bf;
      }
      .order-add-badge {
        border: none;
        background: #58b46b;
        color: white;
        border-radius: 50%;
        width: 26px;
        height: 26px;
        font-size: 0.7rem;
        display: flex;
        align-items: center;
        justify-content: center;
        position: absolute;
        top: 4px;
        right: 4px;
        box-shadow: 0 4px 10px rgba(88, 180, 107, 0.25);
        cursor: pointer;
      }
      .order-add-badge:hover {
        background: #3f9b52;
      }
      .order-target-section {
        padding: 12px 20px 0;
      }
      .order-target-title {
        font-size: 0.85rem;
        font-weight: bold;
        color: #4f6b9b;
        margin-bottom: 8px;
      }
      .order-target-grid {
        margin-bottom: 10px;
      }
      .order-target-cell {
        border: 1px dashed #9bbcf0;
        background: #f4f8ff;
        cursor: pointer;
      }
      .order-target-cell.collected:hover::before {
        content: "+1";
        border: none;
        background: #58b46b;
        color: white;
        border-radius: 50%;
        width: 26px;
        height: 26px;
        font-size: 0.7rem;
        display: flex;
        align-items: center;
        justify-content: center;
        position: absolute;
        top: 4px;
        right: 4px;
        box-shadow: 0 4px 10px rgba(88, 180, 107, 0.25);
        cursor: pointer;
      }
      .order-target-cell.collected {
        border-color: #bcd2f5;
        background: #f7f9fd;
        opacity: 0.85;
      }
      .order-collected-tag {
        position: absolute;
        top: 0px;
        left: 0px;
        background: rgba(79, 107, 155, 0.85);
        color: white;
        font-size: 0.65rem;
        padding: 2px 6px;
        border-radius: 999px;
      }
      .order-meta {
        display: flex;
        justify-content: center;
        font-size: 0.75rem;
        color: #6f82a3;
        gap: 6px;
        flex-wrap: wrap;
      }
      .order-target-cell.order-met,
      .order-item-cell.order-met,
      .target-cell.order-mode.order-met {
        border-color: #8bc98b;
        background: #f2fff2;
      }
      .order-met .order-count {
        background: #daf3da;
        color: #2e7d32;
        border: 1px solid #bfe7bf;
      }
      .rec-order-badge {
        background: rgba(255, 255, 255, 0.15);
        border: 1px solid rgba(255, 255, 255, 0.35);
        color: white;
        padding: 3px 10px;
        border-radius: 12px;
        font-size: 0.75rem;
      }
      .rec-order-sources {
        padding: 10px 20px 0;
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        align-items: center;
        font-size: 0.85rem;
        color: #5c6f85;
      }
      .rec-order-sources-label {
        font-weight: 600;
        color: #3f5268;
      }
      .rec-order-source-tag {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        background: #eef3ff;
        border: 1px dashed #b8c8f0;
        color: #3f5f9a;
        padding: 2px 8px;
        border-radius: 999px;
        font-size: 0.75rem;
      }
      .rec-order-source-name {
        font-weight: 600;
      }
      .rec-order-source-icons {
        display: inline-flex;
        gap: 4px;
        align-items: center;
      }
      .rec-order-source-icon {
        position: relative;
        display: inline-flex;
        align-items: center;
      }
      .rec-order-source-img {
        width: 18px;
        height: 18px;
        border-radius: 4px;
        object-fit: cover;
        background: rgba(63, 95, 154, 0.1);
      }
      .focus-tip {
        position: absolute;
        left: 50%;
        top: calc(100% + 6px);
        transform: translateX(-50%) translateY(6px);
        background: rgba(32, 45, 66, 0.96);
        color: white;
        padding: 8px 10px;
        border-radius: 10px;
        font-size: 0.75rem;
        line-height: 1.2;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
        opacity: 0;
        pointer-events: none;
        transition: 0.15s ease;
        z-index: 5;
        min-width: 90px;
      }
      .focus-tip::after {
        content: "";
        position: absolute;
        top: -4px;
        left: 50%;
        transform: translateX(-50%) rotate(45deg);
        width: 8px;
        height: 8px;
        background: inherit;
      }
      .rec-order-source-icon:hover .focus-tip {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
      .focus-tip-img {
        width: 64px;
        height: 64px;
        border-radius: 6px;
        object-fit: cover;
        background: rgba(255, 255, 255, 0.12);
      }
      .focus-tip-name {
        font-weight: 600;
        text-align: center;
      }
      .focus-tip-count {
        font-size: 0.7rem;
        color: #d6e4ff;
      }
      .rec-order-badge.active {
        background: var(--warning);
        border-color: var(--warning);
      }
      .target-cell.order-mode {
        border: 1px dashed #9bbcf0;
        background: #f4f8ff;
      }
      .target-cell.order-mode:hover::before {
        content: "+1";
        position: absolute;
        top: 5px;
        right: 5px;
        color: white;
        background: #58b46b;
        border-radius: 50%;
        width: 22px;
        height: 22px;
        font-size: 0.7rem;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 1;
        z-index: 2;
        box-shadow: 0 4px 10px rgba(88, 180, 107, 0.25);
      }

      .history-list {
        list-style: none;
        padding: 0;
        margin: 0;
      }
      .history-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        border-bottom: 1px solid #eee;
        background: white;
        transition: 0.2s;
      }
      .history-item:hover {
        background: #fcfcfc;
      }
      .h-info {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      .h-name {
        font-weight: bold;
        font-size: 1rem;
        color: var(--dark);
      }
      .h-time {
        font-size: 0.8rem;
        color: #999;
      }
      .h-meta {
        font-size: 0.8rem;
        color: #666;
      }
      .btn-revoke {
        background: white;
        border: 1px solid var(--danger);
        color: var(--danger);
        font-size: 0.85rem;
        padding: 5px 12px;
        border-radius: 20px;
      }
      .btn-revoke:hover {
        background: var(--danger);
        color: white;
      }

      @media (max-width: 768px) {
        .collection-layout {
          flex-direction: column;
        }
        .toc-sidebar {
          width: 100%;
          position: static;
          max-height: none;
          margin-bottom: 20px;
          display: flex;
          flex-wrap: wrap;
          gap: 5px;
        }
        .toc-list {
          flex-direction: row;
          flex-wrap: wrap;
        }
        .toc-title {
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <div id="app" class="container">
      <header>
        <h1>
          🍄 菌子种植助手
          <span
            style="
              font-size: 0.8rem;
              background: var(--accent);
              color: white;
              padding: 2px 6px;
              border-radius: 4px;
              vertical-align: middle;
            "
            >已收录全图鉴数据</span
          >
        </h1>
        <div class="user-controls">
          <span style="font-size: 0.9rem">👤</span>
          <select v-model="currentUserIndex">
            <option v-for="(user, index) in users" :key="index" :value="index">
              {{ user.name }}
            </option>
          </select>
          <button @click="addUser" style="padding: 4px 10px">+</button>
          <button
            v-if="users.length > 1"
            @click="deleteUser"
            class="danger"
            style="padding: 4px 10px"
          >
            🗑
          </button>
          <button @click="exportUserData" style="padding: 4px 10px">
            导出
          </button>
          <button @click="triggerImport" style="padding: 4px 10px">导入</button>
          <input
            ref="importInput"
            type="file"
            accept="application/json"
            style="display: none"
            @change="handleImportFile"
          />
        </div>
      </header>

      <div class="tabs">
        <div
          class="tab"
          :class="{active: currentTab === 'rec'}"
          @click="currentTab = 'rec'"
        >
          🔍 开图鉴
        </div>
        <div
          class="tab"
          :class="{active: currentTab === 'order'}"
          @click="currentTab = 'order'"
        >
          🎯 清订单
        </div>
        <div
          class="tab"
          :class="{active: currentTab === 'inv'}"
          @click="currentTab = 'inv'"
        >
          🎒 设备仓库
        </div>
        <div
          class="tab"
          :class="{active: currentTab === 'col'}"
          @click="currentTab = 'col'"
        >
          📖 菌子图鉴
        </div>
        <div
          class="tab"
          :class="{active: currentTab === 'log'}"
          @click="currentTab = 'log'"
        >
          📜 收集记录
        </div>
        <div
          class="tab"
          :class="{active: currentTab === 'order-log'}"
          @click="currentTab = 'order-log'"
        >
          🧾 订单记录
        </div>
      </div>

      <div v-if="currentTab === 'rec' || currentTab === 'order'">
        <div
          class="section-header"
          style="border: none; padding: 0; margin-top: 0"
        >
          <div class="time-progress-wrap">
            <div class="time-selector">
              <label style="cursor: pointer"
                ><input type="radio" v-model="currentTime" value="白天" /> ☀️
                白天</label
              >
              <label style="cursor: pointer"
                ><input type="radio" v-model="currentTime" value="黑夜" /> 🌙
                黑夜</label
              >
            </div>
            <div
              v-if="currentTab === 'rec'"
              class="time-progress"
              style="padding-left: 1rem"
            >
              图鉴进度 {{ currentUser.collected.length }}/{{ database.length }}
              <span class="progress-unlockable"
                >当前设备还可解锁 {{ unlockableCount }} 种</span
              >
            </div>
          </div>

          <div style="font-size: 0.85rem; color: #666; text-align: right">
            <span style="color: var(--primary)"
              >💡 点击标记待收获，待收获可转为已收集</span
            ><br />
            <span style="color: var(--warning)"
              >⚠️ 收集记录和订单记录处可撤销操作</span
            >
          </div>
        </div>

        <div ref="orderPanelRef" class="order-panel">
          <div class="order-header">
            <div class="order-title">
              订单目标 ({{ orders.length }})
              <button
                v-if="!orderFormVisible"
                class="icon-btn order-add-btn"
                title="添加新订单"
                aria-label="添加新订单"
                @click="startNewOrder"
              >
                &#x2795;
              </button>
            </div>
            <div class="order-header-actions">
              <button
                v-if="orders.length"
                class="order-list-toggle"
                @click="toggleOrderListCollapse"
              >
                {{ orderListCollapsed ? '展开订单列表' : '收起订单列表' }}
              </button>
              <div v-if="currentTab === 'rec'" class="order-options">
                <label class="filter-switch">
                  <input type="checkbox" v-model="showOrderHints" />
                  推荐方案中提示订单菌子
                </label>
                <label class="filter-switch">
                  <input
                    type="checkbox"
                    v-model="orderAffectsRanking"
                    :disabled="!showOrderHints || orders.length === 0"
                  />
                  订单菌子计入排序权重
                </label>
              </div>
            </div>
          </div>
          <div v-if="orderFormVisible" class="order-form">
            <div class="order-name-row">
              <input type="text" v-model="orderDraft.name" placeholder="单主" />
              <div class="order-reward-row">
                <span class="order-reward-label">报酬</span>
                <input
                  type="number"
                  min="0"
                  v-model.number="orderDraft.reward"
                />
              </div>
              <div class="order-presets">
                <button
                  v-for="preset in orderPresets"
                  :key="preset"
                  class="order-preset"
                  @click="setOrderPreset(preset)"
                >
                  {{ preset }}
                </button>
              </div>
            </div>
            <div class="order-search">
              <input
                type="text"
                v-model="orderQuery"
                placeholder="搜索并添加订单所需的菌子...可用拼音"
                @focus="orderPickerVisible = true"
                @click="orderPickerVisible = true"
              />
            </div>
            <div
              v-if="orderPickerVisible && !orderQuery"
              class="order-results-wrap order-picker"
            >
              <div class="order-picker-header">
                <div class="order-subtitle">按类别添加</div>
                <button
                  class="order-picker-close"
                  @click="orderPickerVisible = false"
                >
                  收起
                </button>
              </div>
              <div v-if="orderCategoryGroups.length" class="order-picker-tabs">
                <button
                  v-for="group in orderCategoryGroups"
                  :key="group.category"
                  class="order-picker-tab"
                  :class="{ active: orderPickerCategory === group.category }"
                  @click="setOrderPickerCategory(group.category)"
                >
                  {{ group.category }}
                </button>
              </div>
              <div v-if="orderCategoryGroups.length === 0" class="order-empty">
                暂无可选菌子
              </div>
              <div v-else class="order-picker-group">
                <div class="order-results">
                  <div
                    v-for="m in orderActiveCategory.items"
                    :key="m.id"
                    class="order-result"
                    @click="addOrderItem(m.id)"
                  >
                    <div class="target-img-box order-result-img">
                      <img
                        :src="getOrderTargetImgSrc(m.name)"
                        class="target-img"
                        @error="handleImgError"
                        :alt="m.name"
                      />
                    </div>
                    <div class="order-result-name">{{ m.name }}</div>
                  </div>
                </div>
              </div>
            </div>
            <div v-if="orderQuery" class="order-results-wrap">
              <div class="order-subtitle">搜索结果</div>
              <div class="order-results">
                <div
                  v-for="m in orderCandidates"
                  :key="m.id"
                  class="order-result"
                  @click="addOrderItem(m.id)"
                >
                  <div class="target-img-box order-result-img">
                    <img
                      :src="getOrderTargetImgSrc(m.name)"
                      class="target-img"
                      @error="handleImgError"
                      :alt="m.name"
                    />
                  </div>
                  <div class="order-result-name">{{ m.name }}</div>
                </div>
                <div v-if="orderCandidates.length === 0" class="order-empty">
                  没有找到匹配的菌子
                </div>
              </div>
            </div>
            <div v-if="orderDraft.items.length" class="order-items">
              <div class="order-subtitle">已添加菌子</div>
              <div class="order-edit-grid">
                <div
                  v-for="item in orderDraft.items"
                  :key="item.id"
                  class="order-item order-edit-cell"
                >
                  <div class="target-img-box order-result-img">
                    <img
                      :src="getOrderTargetImgSrc(getOrderItemName(item.id))"
                      class="target-img"
                      @error="handleImgError"
                      :alt="getOrderItemName(item.id)"
                    />
                  </div>
                  <div class="order-item-name">
                    {{ getOrderItemName(item.id) }}
                  </div>
                  <div class="order-item-fields">
                    <div class="order-item-row">
                      <span>当前</span>
                      <input
                        style="text-align: center"
                        type="number"
                        min="0"
                        :value="getOrderCount(item.id)"
                        @input="setOrderCount(item.id, $event.target.value)"
                      />
                    </div>
                    <div class="order-item-row">
                      <span>需求</span>
                      <input
                        style="text-align: center"
                        type="number"
                        min="1"
                        :value="item.required"
                        @input="setOrderRequired(item, $event.target.value)"
                      />
                    </div>
                  </div>
                  <button
                    class="order-item-remove"
                    title="移除"
                    @click="removeOrderItem(item.id)"
                  >
                    ×
                  </button>
                </div>
              </div>
            </div>
            <div v-else-if="!orderQuery" class="order-empty">
              未添加订单菌子
            </div>
            <div class="order-actions">
              <button @click="saveOrder">
                {{ isEditingOrder ? '保存修改' : '创建订单' }}
              </button>
              <button class="danger" @click="cancelOrderEdit">
                {{ isEditingOrder ? '取消修改' : '取消' }}
              </button>
            </div>
          </div>
          <div v-if="orders.length">
            <div v-if="!orderListCollapsed" class="order-list-note">
              目前菌子左上角的难易度tag仅作试验，不完全具有参考价值，建议查看鼠标指向图片（手机/平板点图片大概也会有？）时显示的具体条件。<br />欢迎在小红书反馈实际感受及调整建议
              @Nope 或 @麻圆（不识字版）
            </div>
            <div v-if="!orderListCollapsed" class="order-list">
              <div
                v-for="order in orders"
                :key="order.id"
                class="order-card"
                :class="{
                  highlight: isEditingOrder && orderDraft.id === order.id,
                  ready: isOrderReady(order),
                  focused: focusOrderId === order.id,
                }"
                :id="`order-card-${order.id}`"
              >
                <div class="order-card-header">
                  <div class="order-card-title">
                    {{ formatOrderName(order.name) }}
                    <span class="order-reward"
                      >报酬 {{ getOrderReward(order) }}</span
                    >
                  </div>
                  <div class="order-card-actions">
                    <button
                      v-if="isEditingOrder && orderDraft.id === order.id"
                      class="icon-btn danger"
                      title="删除订单"
                      aria-label="删除订单"
                      @click="deleteOrder(order)"
                    >
                      &#x1F5D1;
                    </button>
                    <button
                      v-else
                      class="icon-btn"
                      title="修改订单"
                      aria-label="修改订单"
                      @click="editOrder(order)"
                    >
                      🖊
                    </button>
                    <button
                      class="btn-deliver-order"
                      v-if="isOrderReady(order)"
                      @click="deliverOrder(order)"
                    >
                      交付订单
                    </button>
                  </div>
                </div>
                <div
                  class="order-item-grid"
                  :class="{ 'compact-3': isThreeColumnOrder(order.name) }"
                >
                  <div
                    v-for="item in order.items"
                    :key="item.id"
                    class="order-item-cell"
                    :class="{ 'order-met': isOrderItemMet(item.id, item.required) }"
                  >
                    <div
                      class="target-img-box"
                      @mouseenter="showOrderHoverTip(item.id, $event)"
                      @mousemove="moveOrderHoverTip($event)"
                      @mouseleave="hideOrderHoverTip"
                    >
                      <img
                        :src="getOrderTargetImgSrc(getOrderItemName(item.id))"
                        class="target-img"
                        @error="handleImgError"
                        :alt="getOrderItemName(item.id)"
                      />
                      <div class="target-tags">
                        <div
                          v-if="getLegendaryCount(item.id) > 0"
                          class="target-tag tag-immortal"
                          :style="getImmortalTagStyle(item.id)"
                        >
                          仙
                        </div>
                        <div
                          v-if="getComplexityLabel(item.id)"
                          class="target-tag"
                          :class="getComplexityClass(item.id)"
                        >
                          {{ getComplexityLabel(item.id) }}
                        </div>
                      </div>
                      <div
                        v-if="isLongTimeMushroom(getOrderItemName(item.id))"
                        class="long-time-tag"
                      >
                        ⌚
                      </div>
                    </div>
                    <div class="target-name">
                      {{ getOrderItemName(item.id) }}
                    </div>
                    <div
                      class="order-count"
                      :class="{met: isOrderItemMet(item.id, item.required)}"
                    >
                      {{ getOrderCount(item.id) }}/{{ item.required }}
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div v-else class="order-empty">订单列表已收起</div>
          </div>
          <div v-else class="order-empty">暂未添加订单</div>
        </div>
        <div
          v-if="orderHoverTip.visible"
          class="order-target-tip"
          :style="{
            left: orderHoverTip.x + 'px',
            top: orderHoverTip.y + 'px',
          }"
        >
          <div
            v-for="(line, idx) in orderHoverTip.lines"
            :key="`order-tip-${idx}`"
            class="order-target-tip-line"
          >
            <span class="order-target-tip-key">{{ line.label }}</span>
            <span :class="line.className">{{ line.value }}</span>
          </div>
        </div>

        <div
          class="order-float"
          :class="{
            night: currentTime === '黑夜',
            pulse: orderFloatPulse,
            collapsed: orderFloatCollapsed,
          }"
        >
          <div class="order-float-head">
            <button
              type="button"
              class="order-float-icon"
              @click="toggleTime"
              :title="currentTime === '白天' ? '切换到黑夜' : '切换到白天'"
            >
              <span v-if="currentTime === '白天'">☀️</span>
              <span v-else>🌙</span>
            </button>
            <template v-if="!orderFloatCollapsed">
              <div class="order-float-heading">
                <div class="order-float-title">快捷面板</div>
                <div class="order-float-subtitle">
                  {{ currentTime === '白天' ? '正在推荐白天可种的蘑菇' :
                  '正在推荐夜间可种的蘑菇' }}
                </div>
                <button
                  type="button"
                  class="order-float-progress"
                  @click="currentTab = 'col'"
                >
                  图鉴进度 {{ currentUser.collected.length }}/{{ database.length
                  }}
                </button>
              </div>
              <button
                type="button"
                class="order-float-collapse"
                @click="orderFloatCollapsed = true"
              >
                收起
              </button>
            </template>
          </div>
          <template v-if="!orderFloatCollapsed">
            <div class="order-float-section">
              <div class="order-float-section-title">可交付订单</div>
              <div v-if="readyOrders.length" class="order-float-list">
                <button
                  v-for="order in readyOrders"
                  :key="order.id"
                  type="button"
                  class="order-float-item"
                  @click="focusOrderCard(order)"
                >
                  {{ formatOrderName(order.name) }}
                </button>
              </div>
              <div v-else class="order-float-empty">暂无可交付订单</div>
            </div>
            <div class="order-float-figure">
              <img
                src="./assets/chara/傅融.png"
                alt="订单提示"
                class="order-float-img"
              />
              <div class="order-float-bubble">
                <template v-if="panelNotice">
                  <span>{{ panelNotice.message }}</span>
                  <button
                    type="button"
                    class="bubble-link"
                    @click="undoPanelNotice"
                  >
                    撤销
                  </button>
                </template>
                <template v-else-if="isInventoryEmpty || isHandbookEmpty">
                  <template v-if="isInventoryEmpty">
                    <span>请先在</span>
                    <button
                      type="button"
                      class="bubble-link"
                      @click="currentTab = 'inv'"
                    >
                      设备仓库
                    </button>
                    <span>登记已拥有的设备，</span>
                  </template>
                  <template v-if="isInventoryEmpty && isHandbookEmpty">
                    <span>并在</span>
                  </template>
                  <template v-if="!isInventoryEmpty && isHandbookEmpty">
                    <span>还需要在</span>
                  </template>
                  <template v-if="isHandbookEmpty">
                    <button
                      type="button"
                      class="bubble-link"
                      @click="currentTab = 'col'"
                    >
                      菌子图鉴
                    </button>
                    <span>登记已收集的菌子</span>
                  </template>
                  <template v-if="isInventoryEmpty && isHandbookEmpty">
                    <span class="mobile-only"
                      >设备仓库右边还有内容哦，滑动看看</span
                    >
                  </template>
                </template>
                <template v-else> {{ readyOrderMessage }} </template>
              </div>
            </div>
          </template>
          <div v-else class="order-float-collapsed">
            <button
              type="button"
              class="order-float-progress"
              @click="currentTab = 'col'"
            >
              已收集 {{ currentUser.collected.length }}/{{ database.length }}
            </button>
            <div class="order-float-unlockable">
              {{ currentTime }}还可解锁 {{ currentTime === '白天' ?
              unlockableByTime.day : unlockableByTime.night }} 种
            </div>
            <div v-if="readyOrders.length" class="order-float-collapsed-hint">
              🟢可交付订单
            </div>
            <button
              type="button"
              class="order-float-expand"
              @click="orderFloatCollapsed = false"
            >
              展开
            </button>
          </div>
        </div>

        <div v-if="activeRecommendations.length === 0" class="empty-tip">
          <template v-if="currentUser.collected.length === 0">
            🌱 图鉴进度为 0，请先完成以下步骤：
            <div class="empty-guide">
              <div class="empty-guide-item">
                1. 点击
                <button
                  type="button"
                  class="empty-link"
                  @click="currentTab = 'inv'"
                >
                  设备仓库
                </button>
                去登记已拥有的设备
              </div>
              <div class="empty-guide-item">
                2. 点击
                <button
                  type="button"
                  class="empty-link"
                  @click="currentTab = 'col'"
                >
                  菌子图鉴
                </button>
                登记已收集的菌子
              </div>
            </div>
          </template>
          <template v-else-if="currentTab === 'order'">
            📦 暂无订单推荐。<br /><br />
            可能原因：<br />
            1. 还没有添加订单目标。<br />
            2. 当前时间段内订单菌子不符合时间条件。<br />
            3. 你的【设备仓库】还没录入数据。
          </template>
          <template v-else>
            🤔 暂无推荐方案。<br /><br />
            可能原因：<br />
            1. 你的【设备仓库】还没录入数据。<br />
            2. 你太强了，当前时间段内可种的菌子都集齐了！
          </template>
        </div>

        <div ref="recListTop"></div>
        <div
          class="rec-card"
          v-for="(rec, idx) in activeRecommendations"
          :key="rec.key"
        >
          <div class="rec-header">
            <span>推荐方案 #{{ idx + 1 }}</span>
            <div class="rec-header-actions">
              <button
                class="rec-pin"
                :class="{active: isPlanPinned(rec)}"
                @click="togglePinPlan(rec)"
              >
                {{ isPlanPinned(rec) ? '📌' : '置顶' }}
              </button>
              <button
                class="rec-copy"
                title="复制方案代码"
                @click="copyPlanCode(rec)"
              >
                复制到 MaaYuan
              </button>
              <span
                v-if="
                  currentTab === 'rec' &&
                  showOrderHints &&
                  orderTargets.length > 0
                "
                class="rec-order-badge"
                :class="{active: rec.orderCount > 0}"
                :title="rec.orderCount > 0 ? '包含订单目标' : '无订单目标'"
              >
                订单: {{ rec.orderCount }}
              </span>
              <span class="rec-score">可解锁: {{ rec.count }} 种</span>
            </div>
          </div>
          <div class="rec-config">
            <span>
              🪵
              <span :class="getRarityClass('branch', rec.branch)">
                {{ rec.branch }}
              </span>
            </span>
            <span style="color: #666">+</span>
            <span>
              💡
              <span :class="getRarityClass('lamp', rec.lamp)">
                {{ rec.lamp === '/' ? '无/任意' : rec.lamp }}
              </span>
            </span>
            <span style="color: #666">+</span>
            <span>
              💧
              <span :class="getRarityClass('waterer', rec.waterer)">
                {{ rec.waterer === '/' ? '无/任意' : rec.waterer }}
              </span>
            </span>
            <span v-if="hasLongTimeInPlan(rec)" class="rec-config-tip"
              >有⌚标记的菌子的生长时间更久，使用道具前记得检查一下</span
            >
          </div>
          <div
            v-if="
              currentTab === 'order' &&
              rec.orderSources &&
              rec.orderSources.length
            "
            class="rec-order-sources"
          >
            <span class="rec-order-sources-label">对应订单</span>
            <div
              v-for="source in rec.orderSources"
              :key="source.id"
              class="rec-order-source-tag"
            >
              <span class="rec-order-source-name">{{ source.name }}</span>
              <span class="rec-order-source-icons">
                <span
                  v-for="m in source.items"
                  :key="`${source.id}-${m.id}`"
                  class="rec-order-source-icon"
                >
                  <img
                    :src="getOrderTargetImgSrc(m.name)"
                    :alt="m.name"
                    class="rec-order-source-img"
                    @error="$event.target.style.display = 'none'"
                  />
                  <span class="focus-tip">
                    <img
                      :src="getOrderTargetImgSrc(m.name)"
                      :alt="m.name"
                      class="focus-tip-img"
                      @error="$event.target.style.display = 'none'"
                    />
                    <span class="focus-tip-name">{{ m.name }}</span>
                    <span class="focus-tip-count"
                      >{{ getOrderCount(m.id) }}/{{ m.required }}</span
                    >
                  </span>
                </span>
              </span>
            </div>
          </div>
          <div
            v-if="
              currentTab === 'rec' &&
              showOrderHints &&
              orderTargets.length > 0 &&
              rec.orderMatches.length > 0
            "
            class="order-target-section"
          >
            <div class="order-target-title">订单目标菌子</div>
            <div class="target-grid order-target-grid">
              <div
                class="target-cell order-target-cell"
                v-for="t in rec.orderMatches"
                :key="t.id"
                :class="{
                  collected: currentUser.collected.includes(t.id),
                  'order-met': isOrderItemMet(t.id, t.required),
                }"
                @click="requestOrderIncrement(t.id, 'order-target')"
              >
                <div class="target-img-box">
                  <img
                    :src="getMushroomImgSrc(t.category, t.condition)"
                    class="target-img"
                    @error="handleImgError"
                    :alt="t.category"
                  />
                  <div
                    v-if="currentUser.collected.includes(t.id)"
                    class="order-collected-tag"
                  >
                    已收集
                  </div>
                  <div v-if="isLongTimeMushroom(t.name)" class="long-time-tag">
                    ⌚
                  </div>
                </div>
                <div class="target-name">{{ t.name }}</div>
                <div class="order-meta">
                  <span
                    class="order-count"
                    :class="{met: isOrderItemMet(t.id, t.required)}"
                    >{{ getOrderCount(t.id) }}/{{ t.required }}</span
                  >
                </div>
                <div class="order-meta">
                  <span
                    class="condition-badge"
                    :class="getBadgeClass(t.condition)"
                  >
                    {{ t.condition === '/' ? '无特殊条件' : t.condition }}
                  </span>
                </div>
              </div>
            </div>
          </div>
          <div class="rec-body">
            <div class="target-grid">
              <div
                class="target-cell"
                v-for="m in rec.mushrooms"
                :class="{
                  'is-failed': m.isFailed,
                  'is-pending': isPendingHarvest(m.id),
                  'order-mode': currentTab === 'order',
                  'order-met':
                    currentTab === 'order' &&
                    isOrderItemMet(m.id, getOrderRequiredTotal(m.id)),
                }"
                @click="
                  currentTab === 'order'
                    ? requestOrderIncrement(m.id, 'order-rec')
                    : handleCollectionClick(m.id, rec)
                "
              >
                <div class="target-img-box">
                  <img
                    :src="getMushroomImgSrc(m.category, m.condition)"
                    class="target-img"
                    @error="handleImgError"
                    :alt="m.category"
                  />
                  <div v-if="isLongTimeMushroom(m.name)" class="long-time-tag">
                    ⌚
                  </div>
                  <div v-if="isPendingHarvest(m.id)" class="pending-overlay">
                    <div class="pending-tag">待收获</div>
                    <img
                      :src="getOrderTargetImgSrc(m.name)"
                      class="pending-img"
                      @error="handleImgError"
                      :alt="m.name"
                    />
                  </div>
                </div>
                <div class="target-name">{{ m.name }}</div>
                <div
                  v-if="currentTab === 'order' && !isPendingHarvest(m.id)"
                  class="order-meta"
                >
                  <span
                    class="order-count"
                    :class="{
                      met: isOrderItemMet(m.id, getOrderRequiredTotal(m.id)),
                    }"
                    >{{ getOrderCount(m.id) }}/{{ getOrderRequiredTotal(m.id)
                    }}</span
                  >
                </div>
                <div v-if="isPendingHarvest(m.id)" class="pending-actions">
                  <button
                    class="pending-action confirm"
                    @click.stop="confirmHarvest(m.id)"
                  >
                    确认收集
                  </button>
                </div>
                <div
                  v-if="!isPendingHarvest(m.id)"
                  class="condition-badge"
                  :class="getBadgeClass(m.condition)"
                >
                  {{ m.condition === '/' ? '无特殊条件' : m.condition }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div v-if="currentTab === 'inv'">
        <div class="section-header">
          <h3 class="section-title">选择已拥有的枝干</h3>
        </div>
        <div class="tags-container">
          <div
            class="tag"
            v-for="item in allBranches"
            :class="{selected: currentUser.inventory.branches.includes(item)}"
            @click="toggleInventory('branches', item)"
          >
            {{ item }}
          </div>
        </div>
        <div class="section-header">
          <h3 class="section-title">选择已拥有的灯具</h3>
        </div>
        <div class="tags-container">
          <div
            class="tag"
            v-for="item in allLamps"
            :class="{selected: currentUser.inventory.lamps.includes(item)}"
            @click="toggleInventory('lamps', item)"
          >
            {{ item }}
          </div>
        </div>
        <div class="section-header">
          <h3 class="section-title">选择已拥有的补水器</h3>
        </div>
        <div class="tags-container">
          <div
            class="tag"
            v-for="item in allWaterers"
            :class="{selected: currentUser.inventory.waterers.includes(item)}"
            @click="toggleInventory('waterers', item)"
          >
            {{ item }}
          </div>
        </div>
      </div>

      <div v-if="currentTab === 'col'">
        <div class="section-header" style="margin-top: 0">
          <div class="collection-search">
            <input
              type="text"
              v-model="searchQuery"
              placeholder="搜索名称...偷偷支持了拼音和首字母搜索"
              style="width: 260px"
              @focus="handbookPickerVisible = true"
              @click="handbookPickerVisible = true"
            />
            <button
              type="button"
              class="collection-order-toggle"
              :class="{active: useIngameOrder}"
              @click="useIngameOrder = !useIngameOrder"
            >
              {{ useIngameOrder ? '切换回【枝干】分类展示' :
              '切换到【游戏内图鉴】顺序展示' }}
            </button>
            <span
              v-if="useIngameOrder"
              style="color: #e57373; font-size: 0.75rem"
            >
              需要确保游戏内图鉴时打开右上角没有新培育的提示，且第一个菌子是适中蓝莓味竹荪
            </span>
          </div>
          <div
            v-if="handbookPickerVisible && !searchQuery"
            class="order-results-wrap order-picker collection-picker"
          >
            <div class="order-picker-header">
              <div class="order-subtitle">按类别查看</div>
              <button
                class="order-picker-close"
                @click="handbookPickerVisible = false"
              >
                收起
              </button>
            </div>
            <div v-if="handbookCategoryGroups.length" class="order-picker-tabs">
              <button
                v-for="group in handbookCategoryGroups"
                :key="group.category"
                class="order-picker-tab"
                :class="{ active: handbookPickerCategory === group.category }"
                @click="setHandbookPickerCategory(group.category)"
              >
                {{ group.category }}
              </button>
            </div>
            <div v-if="handbookCategoryGroups.length === 0" class="order-empty">
              暂无可选菌子
            </div>
            <div v-else class="order-picker-group">
              <div class="order-results">
                <div
                  v-for="m in handbookActiveCategory.items"
                  :key="m.id"
                  class="order-result handbook-result"
                  :class="{
                      collected: currentUser.collected.includes(m.id),
                      'is-pending': isPendingHarvest(m.id),
                      'is-locked': !isMushroomObtainable(m),
                    }"
                  @click="markHandbookCollected(m.id)"
                >
                  <div class="target-img-box order-result-img">
                    <img
                      :src="getOrderTargetImgSrc(m.name)"
                      class="target-img"
                      @error="handleImgError"
                      :alt="m.name"
                    />
                  </div>
                  <div class="order-result-name">{{ m.name }}</div>
                </div>
              </div>
            </div>
          </div>
          <label class="filter-switch">
            <input type="checkbox" v-model="showOnlyUncollected" />
            只显示未拥有
          </label>
        </div>
        <div style="margin-bottom: 20px; color: #666; font-size: 0.9rem">
          总进度: {{ currentUser.collected.length }} / {{ database.length }}
          <span class="progress-unlockable"
            >当前设备还可解锁 {{ unlockableCount }} 种</span
          >
        </div>

        <div class="collection-layout">
          <div class="collection-main">
            <div v-if="groupedDatabase.length === 0" class="empty-tip">
              没有找到匹配的菌子 🍂
            </div>

            <div
              v-for="group in groupedDatabase"
              :key="group.branchName"
              :id="'group-' + group.branchName"
              class="collection-section"
            >
              <div
                class="collection-group-header"
                @click="toggleSection(group)"
              >
                <span
                  class="group-arrow"
                  :class="{open: isSectionExpanded(group)}"
                  >▶</span
                >
                <div class="collection-group-title">
                  {{ group.branchName === '/' ? '未能长大的系列' :
                  group.branchName }}
                  <span
                    style="
                      font-size: 0.8rem;
                      color: #999;
                      font-weight: normal;
                      margin-left: 10px;
                    "
                  >
                    ({{ group.collectedCount }}/{{ group.totalCount }})
                  </span>
                </div>
                <button
                  v-if="!useIngameOrder"
                  type="button"
                  class="collection-group-action"
                  @click.stop="selectGroupAll(group)"
                >
                  一键勾选
                </button>
              </div>

              <div
                class="collection-grid"
                :class="{ 'ingame-grid': useIngameOrder }"
                v-show="isSectionExpanded(group)"
              >
                <div
                  class="mushroom-card"
                  v-for="m in group.items"
                  :class="{collected: currentUser.collected.includes(m.id), 'is-pending': isPendingHarvest(m.id), 'is-locked': !isMushroomObtainable(m)}"
                  @click="toggleCollected(m.id)"
                >
                  <div class="target-img-box">
                    <img
                      :src="getOrderTargetImgSrc(m.name)"
                      class="target-img"
                      @error="handleImgError"
                      :alt="m.name"
                    />
                  </div>
                  <div class="m-name" style="text-align: center">
                    {{ m.name }}
                  </div>
                  <div class="m-info" style="text-align: center">
                    {{ m.lamp }} | {{ m.waterer }}
                    <span
                      v-if="m.condition !== '/'"
                      :style="{color: m.condition === '消食片' ? 'red' : 'inherit'}"
                      >| {{ m.condition }}</span
                    >
                    <br />
                    时段: {{ m.time }}
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="toc-sidebar">
            <div class="toc-title">快速导航</div>
            <ul class="toc-list">
              <li v-for="group in groupedDatabase" :key="group.branchName">
                <a
                  href="#"
                  class="toc-item"
                  :class="{unowned: !group.isOwned && group.branchName !== '/'}"
                  @click.prevent="scrollToSection(group.branchName)"
                >
                  <span class="toc-label"
                    >{{ group.branchName === '/' ? '未能长大的' :
                    group.branchName }}</span
                  >
                  <span class="toc-progress" :class="group.progressClass"
                    >{{ group.collectedCount }}/{{ group.totalCount }}</span
                  >
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div v-if="currentTab === 'log'">
        <div class="section-header" style="margin-top: 0">
          <h3 class="section-title">种植收集记录</h3>
          <span style="font-size: 0.85rem; color: #999"
            >仅记录通过推荐页面的收集操作</span
          >
        </div>
        <div
          v-if="!currentUser.history || currentUser.history.length === 0"
          class="empty-tip"
        >
          暂无收集记录 📜
        </div>
        <ul class="history-list">
          <li
            v-for="(log, idx) in reversedHistory"
            :key="log.timestamp"
            class="history-item"
          >
            <div class="h-info">
              <span class="h-name">{{ getHistoryName(log) }}</span>
              <span class="h-time">{{ formatTime(log.timestamp) }}</span>
            </div>
            <button class="btn-revoke" @click="revokeHistoryItem(log)">
              撤销记录
            </button>
          </li>
        </ul>
      </div>

      <div v-if="currentTab === 'order-log'">
        <div class="section-header" style="margin-top: 0">
          <h3 class="section-title">订单记录</h3>
          <span style="font-size: 0.85rem; color: #999"
            >可撤销交付、删除或库存 +1 操作</span
          >
        </div>
        <div
          v-if="!currentUser.orderHistory || currentUser.orderHistory.length === 0"
          class="empty-tip"
        >
          暂无订单记录 📦
        </div>
        <ul class="history-list">
          <li
            v-for="record in reversedOrderHistory"
            :key="record.timestamp"
            class="history-item"
          >
            <div class="h-info">
              <span class="h-name">{{ getOrderRecordTitle(record) }}</span>
              <span class="h-time">{{ formatTime(record.timestamp) }}</span>
              <span class="h-meta">{{ formatOrderRecord(record) }}</span>
            </div>
            <button class="btn-revoke" @click="revokeOrderRecord(record)">
              {{ getOrderRecordActionLabel(record) }}
            </button>
          </li>
        </ul>
      </div>
      <div class="toast" :class="{show: toastVisible}">{{ toastMessage }}</div>
    </div>

    <script>
      const { createApp, ref, reactive, computed, watch, onMounted, nextTick } =
        Vue;

      const RAW_DATA = [
        {
          id: "ny-192f0y0",
          category: "宝石菌",
          name: "未能长大的宝石菌",
          branch: "/",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-r8i6l2",
          category: "草帽菌",
          name: "未能长大的草帽菌",
          branch: "/",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-18lbda3",
          category: "地星菌",
          name: "未能长大的地星菌",
          branch: "/",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-b4lyvb",
          category: "鹿角菌",
          name: "未能长大的鹿角菌",
          branch: "/",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-1hjwx7g",
          category: "美灵芝",
          name: "未能长大的美灵芝",
          branch: "/",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-1cs57pz",
          category: "鸟巢菌",
          name: "未能长大的鸟巢菌",
          branch: "/",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-1qtyl6y",
          category: "泡泡菌",
          name: "未能长大的泡泡菌",
          branch: "/",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-15dvm2c",
          category: "珊瑚菌",
          name: "未能长大的珊瑚菌",
          branch: "/",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-tya561",
          category: "竹荪",
          name: "未能长大的竹荪",
          branch: "/",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-lin390",
          category: "菜菜菌",
          name: "未能长大的菜菜菌",
          branch: "/",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-wi7tiw",
          category: "刺头菌",
          name: "未能长大的刺头菌",
          branch: "/",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-z4c06a",
          category: "猴头菌",
          name: "未能长大的猴头菌",
          branch: "/",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-r96if2",
          category: "喇叭菌",
          name: "未能长大的喇叭菌",
          branch: "/",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-ul3i1f",
          category: "猫爪菌",
          name: "未能长大的猫爪菌",
          branch: "/",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-1sn6jqs",
          category: "幽灵菌",
          name: "未能长大的幽灵菌",
          branch: "/",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "未杀虫",
          isFailed: true,
        },
        {
          id: "ny-j7sayi",
          category: "鸟巢菌",
          name: "超小型陶瓷鸟巢菌",
          branch: "爱心鳞木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1y1wz2n",
          category: "鸟巢菌",
          name: "标准厨余鸟巢菌",
          branch: "爱心鳞木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-atyzjl",
          category: "鸟巢菌",
          name: "超大型陶瓷鸟巢菌",
          branch: "爱心鳞木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-zp7oy7",
          category: "美灵芝",
          name: "纤小红颜美灵芝",
          branch: "爱心鳞木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1jw72t6",
          category: "美灵芝",
          name: "寻常滞销美灵芝",
          branch: "爱心鳞木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1tpumas",
          category: "美灵芝",
          name: "硕大红颜美灵芝",
          branch: "爱心鳞木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-ehxj3c",
          category: "草帽菌",
          name: "普通恶毒草帽菌",
          branch: "爱心鳞木",
          lamp: "魂魂烛台",
          waterer: "/",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1u7nvpl",
          category: "草帽菌",
          name: "普通蓝瘦草帽菌",
          branch: "爱心鳞木",
          lamp: "魂魂烛台",
          waterer: "/",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1ita1oj",
          category: "草帽菌",
          name: "小斑比草帽菌",
          branch: "爱心鳞木",
          lamp: "魂魂烛台",
          waterer: "/",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-h4qvpq",
          category: "草帽菌",
          name: "小老土草帽菌",
          branch: "爱心鳞木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1vqitk3",
          category: "草帽菌",
          name: "大斑比草帽菌",
          branch: "爱心鳞木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-q9xad9",
          category: "草帽菌",
          name: "小蓝瘦草帽菌",
          branch: "爱心鳞木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-5vdipj",
          category: "泡泡菌",
          name: "超小实习泡泡菌",
          branch: "爱心鳞木",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-ln0yb6",
          category: "泡泡菌",
          name: "超大亚健康泡泡菌",
          branch: "爱心鳞木",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-ocd8fw",
          category: "泡泡菌",
          name: "超小过劳泡泡菌",
          branch: "爱心鳞木",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1pge64r",
          category: "泡泡菌",
          name: "常见看破一切泡泡菌",
          branch: "爱心鳞木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-65y62u",
          category: "泡泡菌",
          name: "常见过劳泡泡菌",
          branch: "爱心鳞木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1ok92xk",
          category: "泡泡菌",
          name: "超小亚健康泡泡菌",
          branch: "爱心鳞木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1lo03mo",
          category: "宝石菌",
          name: "小小躺板板宝石菌",
          branch: "爱心鳞木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-7m7d69",
          category: "宝石菌",
          name: "常规坏种宝石菌",
          branch: "爱心鳞木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-cuwkp7",
          category: "宝石菌",
          name: "庞大躺板板宝石菌",
          branch: "爱心鳞木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-17l59cu",
          category: "竹荪",
          name: "清淡莲藕味竹荪",
          branch: "爱心鳞木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1mvrmlv",
          category: "竹荪",
          name: "适中猪肉味竹荪",
          branch: "爱心鳞木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-bu5ir1",
          category: "竹荪",
          name: "浓厚莲藕味竹荪",
          branch: "爱心鳞木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-hwwakc",
          category: "草帽菌",
          name: "普通老土草帽菌",
          branch: "柏木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-12ocknh",
          category: "草帽菌",
          name: "普通洁癖草帽菌",
          branch: "柏木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1vlm2db",
          category: "草帽菌",
          name: "普通健美草帽菌",
          branch: "柏木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-hvicf4",
          category: "泡泡菌",
          name: "常见实习泡泡菌",
          branch: "柏木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-12ngbch",
          category: "泡泡菌",
          name: "常见新手泡泡菌",
          branch: "柏木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-16bvaob",
          category: "泡泡菌",
          name: "常见菜色泡泡菌",
          branch: "柏木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-10pt1qi",
          category: "刺头菌",
          name: "中等善良刺头菌",
          branch: "柏木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1g0x3tr",
          category: "刺头菌",
          name: "中等邪恶刺头菌",
          branch: "柏木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-kahhcx",
          category: "刺头菌",
          name: "中等寒冰刺头菌",
          branch: "柏木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-pumi5f",
          category: "猫爪菌",
          name: "一般傲娇猫爪菌",
          branch: "柏木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-afkxce",
          category: "猫爪菌",
          name: "一般萌萌猫爪菌",
          branch: "柏木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-yo9gsg",
          category: "猫爪菌",
          name: "一般暗黑猫爪菌",
          branch: "柏木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1m68jut",
          category: "竹荪",
          name: "适中黄花菜味竹荪",
          branch: "常春藤木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-6gzw2s",
          category: "竹荪",
          name: "适中莲藕味竹荪",
          branch: "常春藤木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-7rd2zi",
          category: "竹荪",
          name: "适中番茄味竹荪",
          branch: "常春藤木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-11ptez4",
          category: "美灵芝",
          name: "寻常瘦身美灵芝",
          branch: "常春藤木",
          lamp: "魂魂烛台",
          waterer: "小鸟长颈壶",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1mlowm9",
          category: "美灵芝",
          name: "寻常红颜美灵芝",
          branch: "常春藤木",
          lamp: "魂魂烛台",
          waterer: "小鸟长颈壶",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1e1dljv",
          category: "美灵芝",
          name: "寻常阴湿美灵芝",
          branch: "常春藤木",
          lamp: "魂魂烛台",
          waterer: "小鸟长颈壶",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-uk5v90",
          category: "猴头菌",
          name: "平凡社牛猴头菌",
          branch: "常春藤木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1avated",
          category: "猴头菌",
          name: "平凡笨蛋猴头菌",
          branch: "常春藤木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-fs1atj",
          category: "猴头菌",
          name: "平凡宅宅猴头菌",
          branch: "常春藤木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-sg18le",
          category: "鸟巢菌",
          name: "标准不可燃鸟巢菌",
          branch: "常春藤木",
          lamp: "火炬",
          waterer: "小鸟长颈壶",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-codszr",
          category: "鸟巢菌",
          name: "标准陶瓷鸟巢菌",
          branch: "常春藤木",
          lamp: "火炬",
          waterer: "小鸟长颈壶",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-sfa4tl",
          category: "鸟巢菌",
          name: "标准可燃鸟巢菌",
          branch: "常春藤木",
          lamp: "火炬",
          waterer: "小鸟长颈壶",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-x8xrw6",
          category: "珊瑚菌",
          name: "中级贾诩珊瑚菌",
          branch: "枫木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-h8xm0r",
          category: "珊瑚菌",
          name: "中级公孙珊珊瑚菌",
          branch: "枫木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-11jjoph",
          category: "珊瑚菌",
          name: "中级董奉珊瑚菌",
          branch: "枫木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-51cbws",
          category: "喇叭菌",
          name: "寻常封心锁爱喇叭菌",
          branch: "枫木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-ptaau5",
          category: "喇叭菌",
          name: "寻常黄金喇叭菌",
          branch: "枫木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-12stusv",
          category: "喇叭菌",
          name: "寻常陷阵营喇叭菌",
          branch: "枫木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-p6f7o0",
          category: "地星菌",
          name: "路边朴素地星菌",
          branch: "枫木",
          lamp: "火炬",
          waterer: "竹筒滴漏",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-19yd6ld",
          category: "地星菌",
          name: "路边森系地星菌",
          branch: "枫木",
          lamp: "火炬",
          waterer: "竹筒滴漏",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1lx549n",
          category: "地星菌",
          name: "路边荷塘夜色地星菌",
          branch: "枫木",
          lamp: "火炬",
          waterer: "竹筒滴漏",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1reugrq",
          category: "珊瑚菌",
          name: "缩水公孙珊珊瑚菌",
          branch: "葛藤木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1bk8w4r",
          category: "珊瑚菌",
          name: "中级张郃珊瑚菌",
          branch: "葛藤木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1appizp",
          category: "珊瑚菌",
          name: "膨胀公孙珊珊瑚菌",
          branch: "葛藤木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-6edb2a",
          category: "喇叭菌",
          name: "小巧黄金喇叭菌",
          branch: "葛藤木",
          lamp: "/",
          waterer: "小鸟长颈壶",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1pggkuf",
          category: "喇叭菌",
          name: "寻常超火爆喇叭菌",
          branch: "葛藤木",
          lamp: "/",
          waterer: "小鸟长颈壶",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-8a13s9",
          category: "喇叭菌",
          name: "特大黄金喇叭菌",
          branch: "葛藤木",
          lamp: "/",
          waterer: "小鸟长颈壶",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1sg85w5",
          category: "地星菌",
          name: "小只森系地星菌",
          branch: "葛藤木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1c8j1mc",
          category: "地星菌",
          name: "路边粉毛地星菌",
          branch: "葛藤木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-uj4rf2",
          category: "地星菌",
          name: "巨型森系地星菌",
          branch: "葛藤木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-psb2ur",
          category: "菜菜菌",
          name: "小型幽州菜菜菌",
          branch: "葛藤木",
          lamp: "火炬",
          waterer: "/",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-acrt7i",
          category: "菜菜菌",
          name: "通常水平太菜菜菌",
          branch: "葛藤木",
          lamp: "火炬",
          waterer: "/",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-ub0e7k",
          category: "菜菜菌",
          name: "大型幽州菜菜菌",
          branch: "葛藤木",
          lamp: "火炬",
          waterer: "/",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-9swyuf",
          category: "鹿角菌",
          name: "微型深渊鹿角菌",
          branch: "葛藤木",
          lamp: "火炬",
          waterer: "小鸟长颈壶",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1oznhr6",
          category: "鹿角菌",
          name: "中庸二刺螈鹿角菌",
          branch: "葛藤木",
          lamp: "火炬",
          waterer: "小鸟长颈壶",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-p5th8s",
          category: "鹿角菌",
          name: "巨体深渊鹿角菌",
          branch: "葛藤木",
          lamp: "火炬",
          waterer: "小鸟长颈壶",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1f3snvy",
          category: "猴头菌",
          name: "微小笨蛋猴头菌",
          branch: "葛藤木",
          lamp: "铜盏油灯",
          waterer: "/",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1uewpz7",
          category: "猴头菌",
          name: "平凡高智商猴头菌",
          branch: "葛藤木",
          lamp: "铜盏油灯",
          waterer: "/",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1bm2me5",
          category: "猴头菌",
          name: "超级笨蛋猴头菌",
          branch: "葛藤木",
          lamp: "铜盏油灯",
          waterer: "/",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-q9ripn",
          category: "幽灵菌",
          name: "小号挑染幽灵菌",
          branch: "葛藤木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-6dwx4m",
          category: "幽灵菌",
          name: "中号冰山幽灵菌",
          branch: "葛藤木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-u9gyg8",
          category: "幽灵菌",
          name: "大号挑染幽灵菌",
          branch: "葛藤木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-uyc7cyn",
          category: "美灵芝",
          name: "硕大苍白美灵芝",
          branch: "黄金建木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-27stxrx",
          category: "美灵芝",
          name: "硕大瘦身美灵芝",
          branch: "黄金建木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-ojlksvt",
          category: "美灵芝",
          name: "纤小阴湿美灵芝",
          branch: "黄金建木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1waqkij",
          category: "美灵芝",
          name: "硕大阴湿美灵芝",
          branch: "黄金建木",
          lamp: "羽绒无烟灯",
          waterer: "深蓝之谜",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-d85lw6",
          category: "美灵芝",
          name: "纤小潮人美灵芝",
          branch: "黄金建木",
          lamp: "羽绒无烟灯",
          waterer: "深蓝之谜",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-163rseg",
          category: "美灵芝",
          name: "硕大潮人美灵芝",
          branch: "黄金建木",
          lamp: "羽绒无烟灯",
          waterer: "深蓝之谜",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1u9lq8b",
          category: "竹荪",
          name: "浓厚番茄味竹荪",
          branch: "黄金建木",
          lamp: "魂魂烛台",
          waterer: "深蓝之谜",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-b805ae",
          category: "竹荪",
          name: "清淡蓝莓味竹荪",
          branch: "黄金建木",
          lamp: "魂魂烛台",
          waterer: "深蓝之谜",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1vfihso",
          category: "竹荪",
          name: "浓厚蓝莓味竹荪",
          branch: "黄金建木",
          lamp: "魂魂烛台",
          waterer: "深蓝之谜",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1v593w5",
          category: "竹荪",
          name: "浓厚墨鱼丸味竹荪",
          branch: "黄金建木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1el9qms",
          category: "竹荪",
          name: "清淡番茄味竹荪",
          branch: "黄金建木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1577jn2",
          category: "竹荪",
          name: "浓厚黄花菜味竹荪",
          branch: "黄金建木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-6bmkgcq",
          category: "宝石菌",
          name: "庞大白切黑宝石菌",
          branch: "黄金建木",
          lamp: "火炬",
          waterer: "陶滴壶",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-cuvw4nc",
          category: "宝石菌",
          name: "小小酥酪宝石菌",
          branch: "黄金建木",
          lamp: "火炬",
          waterer: "陶滴壶",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-l8x2h05",
          category: "宝石菌",
          name: "庞大酥酪宝石菌",
          branch: "黄金建木",
          lamp: "火炬",
          waterer: "陶滴壶",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-5ac4fj",
          category: "宝石菌",
          name: "庞大夜光宝石菌",
          branch: "黄金建木",
          lamp: "铜盏油灯",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-ppo8ka",
          category: "宝石菌",
          name: "庞大番茄炒蛋宝石菌",
          branch: "黄金建木",
          lamp: "铜盏油灯",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-19gn0g4",
          category: "宝石菌",
          name: "小小白切黑宝石菌",
          branch: "黄金建木",
          lamp: "铜盏油灯",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-otbqqn",
          category: "刺头菌",
          name: "中等太白金星刺头菌",
          branch: "尖刺棘木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-9qkex6",
          category: "刺头菌",
          name: "中等魔法少女刺头菌",
          branch: "尖刺棘木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-98suj8",
          category: "刺头菌",
          name: "袖珍小荧光刺头菌",
          branch: "尖刺棘木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1a1jq7f",
          category: "刺头菌",
          name: "袖珍善良刺头菌",
          branch: "尖刺棘木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-q66tgm",
          category: "刺头菌",
          name: "巨巨荧光刺头菌",
          branch: "尖刺棘木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-x44ny0",
          category: "刺头菌",
          name: "袖珍魔法少女刺头菌",
          branch: "尖刺棘木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-g2pasg",
          category: "珊瑚菌",
          name: "中级戏学珊瑚菌",
          branch: "尖刺棘木",
          lamp: "魂魂烛台",
          waterer: "/",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-10qpr01",
          category: "珊瑚菌",
          name: "中级陈登珊瑚菌",
          branch: "尖刺棘木",
          lamp: "魂魂烛台",
          waterer: "/",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1okrrrf",
          category: "珊瑚菌",
          name: "缩水张郃珊瑚菌",
          branch: "尖刺棘木",
          lamp: "魂魂烛台",
          waterer: "/",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-au20ydx",
          category: "珊瑚菌",
          name: "缩水贾诩珊瑚菌",
          branch: "尖刺棘木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-0z33h6k",
          category: "珊瑚菌",
          name: "膨胀张郃珊瑚菌",
          branch: "尖刺棘木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-3do40v8",
          category: "珊瑚菌",
          name: "缩水陈登珊瑚菌",
          branch: "尖刺棘木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-ajcn6b",
          category: "喇叭菌",
          name: "寻常夕阳喇叭菌",
          branch: "尖刺棘木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1u9cn26",
          category: "喇叭菌",
          name: "寻常青春痘喇叭菌",
          branch: "尖刺棘木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1o42r4g",
          category: "喇叭菌",
          name: "小巧超火爆喇叭菌",
          branch: "尖刺棘木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-13tygux",
          category: "喇叭菌",
          name: "小巧封心锁爱喇叭菌",
          branch: "尖刺棘木",
          lamp: "铜盏油灯",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-nlrnqw",
          category: "喇叭菌",
          name: "特大超火爆喇叭菌",
          branch: "尖刺棘木",
          lamp: "铜盏油灯",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-13qzvze",
          category: "喇叭菌",
          name: "小巧青春痘喇叭菌",
          branch: "尖刺棘木",
          lamp: "铜盏油灯",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-85katv",
          category: "猫爪菌",
          name: "迷你傲娇猫爪菌",
          branch: "尖刺棘木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1rs4gu6",
          category: "猫爪菌",
          name: "巨大凑凑猫爪菌",
          branch: "尖刺棘木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-q1f39s",
          category: "猫爪菌",
          name: "迷你红温猫爪菌",
          branch: "尖刺棘木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1i28cpi",
          category: "猫爪菌",
          name: "一般撞色猫爪菌",
          branch: "尖刺棘木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-2wywbf",
          category: "猫爪菌",
          name: "一般红温猫爪菌",
          branch: "尖刺棘木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1jt74ol",
          category: "猫爪菌",
          name: "迷你凑凑猫爪菌",
          branch: "尖刺棘木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-11ksndq",
          category: "宝石菌",
          name: "常规酥酪宝石菌",
          branch: "尖晶矿木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-h4yuer",
          category: "宝石菌",
          name: "常规夜光宝石菌",
          branch: "尖晶矿木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-pfnn59",
          category: "宝石菌",
          name: "小小坏种宝石菌",
          branch: "尖晶矿木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1wu2dvn",
          category: "宝石菌",
          name: "小小番茄炒蛋宝石菌",
          branch: "尖晶矿木",
          lamp: "白龙长明灯",
          waterer: "小鸟长颈壶",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-i4um5q",
          category: "宝石菌",
          name: "庞大坏种宝石菌",
          branch: "尖晶矿木",
          lamp: "白龙长明灯",
          waterer: "小鸟长颈壶",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-oxra74",
          category: "宝石菌",
          name: "小小夜光宝石菌",
          branch: "尖晶矿木",
          lamp: "白龙长明灯",
          waterer: "小鸟长颈壶",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-ys03a1",
          category: "泡泡菌",
          name: "超大过劳泡泡菌",
          branch: "尖晶矿木",
          lamp: "火炬",
          waterer: "/",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1hygw8o",
          category: "泡泡菌",
          name: "超大实习泡泡菌",
          branch: "尖晶矿木",
          lamp: "火炬",
          waterer: "/",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1eyci22",
          category: "泡泡菌",
          name: "超小菜色泡泡菌",
          branch: "尖晶矿木",
          lamp: "火炬",
          waterer: "/",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-79wzh5z",
          category: "泡泡菌",
          name: "超大菜色泡泡菌",
          branch: "尖晶矿木",
          lamp: "火炬",
          waterer: "小鸟长颈壶",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1bwi2nn",
          category: "泡泡菌",
          name: "超小看破一切泡泡菌",
          branch: "尖晶矿木",
          lamp: "火炬",
          waterer: "小鸟长颈壶",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-vraghjz",
          category: "泡泡菌",
          name: "超大看破一切泡泡菌",
          branch: "尖晶矿木",
          lamp: "火炬",
          waterer: "小鸟长颈壶",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1i9j6r2",
          category: "草帽菌",
          name: "大蓝瘦草帽菌",
          branch: "尖晶矿木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1xgpq4j",
          category: "草帽菌",
          name: "大老土草帽菌",
          branch: "尖晶矿木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-g7pdr1",
          category: "草帽菌",
          name: "小健美草帽菌",
          branch: "尖晶矿木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1uyosuv",
          category: "草帽菌",
          name: "大健美草帽菌",
          branch: "尖晶矿木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1b6rpzm",
          category: "草帽菌",
          name: "小恶毒草帽菌",
          branch: "尖晶矿木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-qlx3w",
          category: "草帽菌",
          name: "大恶毒草帽菌",
          branch: "尖晶矿木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1a0rvtx",
          category: "刺头菌",
          name: "巨巨魔法少女刺头菌",
          branch: "尖晶矿木",
          lamp: "铜盏油灯",
          waterer: "深蓝之谜",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1s9bzfv",
          category: "刺头菌",
          name: "巨巨善良刺头菌",
          branch: "尖晶矿木",
          lamp: "铜盏油灯",
          waterer: "深蓝之谜",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-94akme",
          category: "刺头菌",
          name: "袖珍寒冰刺头菌",
          branch: "尖晶矿木",
          lamp: "铜盏油灯",
          waterer: "深蓝之谜",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-5k5q2pz",
          category: "鹿角菌",
          name: "巨体碧玉鹿角菌",
          branch: "绝世名琴",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-3ufpy8h",
          category: "鹿角菌",
          name: "巨体素描鹿角菌",
          branch: "绝世名琴",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-dccnrnd",
          category: "鹿角菌",
          name: "微型应援棒鹿角菌",
          branch: "绝世名琴",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-2hcx34",
          category: "鹿角菌",
          name: "巨体应援棒鹿角菌",
          branch: "绝世名琴",
          lamp: "羽绒无烟灯",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-n8t769",
          category: "鹿角菌",
          name: "微型蔫蔫鹿角菌",
          branch: "绝世名琴",
          lamp: "羽绒无烟灯",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1522g17",
          category: "鹿角菌",
          name: "巨体蔫蔫鹿角菌",
          branch: "绝世名琴",
          lamp: "羽绒无烟灯",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-pmbih9",
          category: "鸟巢菌",
          name: "超大型可燃鸟巢菌",
          branch: "绝世名琴",
          lamp: "白龙长明灯",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-14630l8",
          category: "鸟巢菌",
          name: "超小型五彩豆鸟巢菌",
          branch: "绝世名琴",
          lamp: "白龙长明灯",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1qkn1sm",
          category: "鸟巢菌",
          name: "超大型五彩豆鸟巢菌",
          branch: "绝世名琴",
          lamp: "白龙长明灯",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-59ydnp",
          category: "鸟巢菌",
          name: "超大型木桩鸟巢菌",
          branch: "绝世名琴",
          lamp: "铜盏油灯",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1nvi9xg",
          category: "鸟巢菌",
          name: "超大型不可燃鸟巢菌",
          branch: "绝世名琴",
          lamp: "铜盏油灯",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1aiy81q",
          category: "鸟巢菌",
          name: "超小型可燃鸟巢菌",
          branch: "绝世名琴",
          lamp: "铜盏油灯",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-9fpjgm",
          category: "猴头菌",
          name: "超级宅宅猴头菌",
          branch: "绝世名琴",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1sl8n4b",
          category: "猴头菌",
          name: "微小隐鸢阁冠名猴头菌",
          branch: "绝世名琴",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1vtxzlx",
          category: "猴头菌",
          name: "超级隐鸢阁冠名猴头菌",
          branch: "绝世名琴",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1on25zx",
          category: "猴头菌",
          name: "超级逃课猴头菌",
          branch: "绝世名琴",
          lamp: "火炬",
          waterer: "小鸟长颈壶",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-dotfgj",
          category: "猴头菌",
          name: "超级社牛猴头菌",
          branch: "绝世名琴",
          lamp: "火炬",
          waterer: "小鸟长颈壶",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1xj8mwe",
          category: "猴头菌",
          name: "微小宅宅猴头菌",
          branch: "绝世名琴",
          lamp: "火炬",
          waterer: "小鸟长颈壶",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-6hla8p",
          category: "刺头菌",
          name: "巨巨寒冰刺头菌",
          branch: "绿松矿木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-plln08",
          category: "刺头菌",
          name: "袖珍太白金星刺头菌",
          branch: "绿松矿木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1tyqfoq",
          category: "刺头菌",
          name: "巨巨太白金星刺头菌",
          branch: "绿松矿木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-j0el06",
          category: "珊瑚菌",
          name: "膨胀董奉珊瑚菌",
          branch: "绿松矿木",
          lamp: "火炬",
          waterer: "/",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-12rca6z",
          category: "珊瑚菌",
          name: "缩水戏学珊瑚菌",
          branch: "绿松矿木",
          lamp: "火炬",
          waterer: "/",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-oubbat",
          category: "珊瑚菌",
          name: "膨胀戏学珊瑚菌",
          branch: "绿松矿木",
          lamp: "火炬",
          waterer: "/",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-weln14",
          category: "珊瑚菌",
          name: "膨胀陈登珊瑚菌",
          branch: "绿松矿木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-d37xo9",
          category: "珊瑚菌",
          name: "膨胀贾诩珊瑚菌",
          branch: "绿松矿木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-19car2r",
          category: "珊瑚菌",
          name: "缩水董奉珊瑚菌",
          branch: "绿松矿木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1b9r6r0",
          category: "猫爪菌",
          name: "巨大暗黑猫爪菌",
          branch: "绿松矿木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-wqz2bh",
          category: "猫爪菌",
          name: "迷你撞色猫爪菌",
          branch: "绿松矿木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-g2fwv",
          category: "猫爪菌",
          name: "巨大撞色猫爪菌",
          branch: "绿松矿木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-prm25d",
          category: "猫爪菌",
          name: "巨大红温猫爪菌",
          branch: "绿松矿木",
          lamp: "羽绒无烟灯",
          waterer: "陶滴壶",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-14ebpao",
          category: "猫爪菌",
          name: "迷你暗黑猫爪菌",
          branch: "绿松矿木",
          lamp: "羽绒无烟灯",
          waterer: "陶滴壶",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-pc9qea",
          category: "猫爪菌",
          name: "巨大傲娇猫爪菌",
          branch: "绿松矿木",
          lamp: "羽绒无烟灯",
          waterer: "陶滴壶",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-4oavt0",
          category: "喇叭菌",
          name: "特大青春痘喇叭菌",
          branch: "绿松矿木",
          lamp: "火炬",
          waterer: "深蓝之谜",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1klel0l",
          category: "喇叭菌",
          name: "特大封心锁爱喇叭菌",
          branch: "绿松矿木",
          lamp: "火炬",
          waterer: "深蓝之谜",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-81qyrb",
          category: "喇叭菌",
          name: "小巧陷阵营喇叭菌",
          branch: "绿松矿木",
          lamp: "火炬",
          waterer: "深蓝之谜",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-e4islz",
          category: "喇叭菌",
          name: "特大陷阵营喇叭菌",
          branch: "绿松矿木",
          lamp: "铜盏油灯",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-u31vyq",
          category: "喇叭菌",
          name: "小巧夕阳喇叭菌",
          branch: "绿松矿木",
          lamp: "铜盏油灯",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1cnpzj0",
          category: "喇叭菌",
          name: "特大夕阳喇叭菌",
          branch: "绿松矿木",
          lamp: "铜盏油灯",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-wy9rpd",
          category: "宝石菌",
          name: "常规番茄炒蛋宝石菌",
          branch: "牵牛藤木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1bpwb8w",
          category: "宝石菌",
          name: "常规躺板板宝石菌",
          branch: "牵牛藤木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1qib8zm",
          category: "宝石菌",
          name: "常规白切黑宝石菌",
          branch: "牵牛藤木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1woex2e",
          category: "泡泡菌",
          name: "超小新手泡泡菌",
          branch: "牵牛藤木",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1h16p0r",
          category: "泡泡菌",
          name: "常见亚健康泡泡菌",
          branch: "牵牛藤木",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-ah5jad",
          category: "泡泡菌",
          name: "超大新手泡泡菌",
          branch: "牵牛藤木",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-13r6gjg",
          category: "猫爪菌",
          name: "迷你萌萌猫爪菌",
          branch: "牵牛藤木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-p01lu5",
          category: "猫爪菌",
          name: "一般凑凑猫爪菌",
          branch: "牵牛藤木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-ad61j3",
          category: "猫爪菌",
          name: "巨大萌萌猫爪菌",
          branch: "牵牛藤木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-12qhqun",
          category: "草帽菌",
          name: "小洁癖草帽菌",
          branch: "牵牛藤木",
          lamp: "火炬",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-5ayy84",
          category: "草帽菌",
          name: "普通斑比草帽菌",
          branch: "牵牛藤木",
          lamp: "火炬",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-nbg61m",
          category: "草帽菌",
          name: "大洁癖草帽菌",
          branch: "牵牛藤木",
          lamp: "火炬",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-104oonq",
          category: "刺头菌",
          name: "袖珍邪恶刺头菌",
          branch: "牵牛藤木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1jrov4r",
          category: "刺头菌",
          name: "中等荧光刺头菌",
          branch: "牵牛藤木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1am4ohh",
          category: "刺头菌",
          name: "巨巨邪恶刺头菌",
          branch: "牵牛藤木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-12j9wdv",
          category: "猴头菌",
          name: "平凡隐鸢阁冠名猴头菌",
          branch: "青金矿木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-n85uam",
          category: "猴头菌",
          name: "平凡逃课猴头菌",
          branch: "青金矿木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-qz93w0",
          category: "猴头菌",
          name: "微小高智商猴头菌",
          branch: "青金矿木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-ix2shz",
          category: "猴头菌",
          name: "微小社牛猴头菌",
          branch: "青金矿木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1yemhvm",
          category: "猴头菌",
          name: "超级高智商猴头菌",
          branch: "青金矿木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-atvang",
          category: "猴头菌",
          name: "微小逃课猴头菌",
          branch: "青金矿木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-3mvu6",
          category: "美灵芝",
          name: "寻常潮人美灵芝",
          branch: "青金矿木",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1eqe7cz",
          category: "美灵芝",
          name: "寻常苍白美灵芝",
          branch: "青金矿木",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1k84d5p",
          category: "美灵芝",
          name: "纤小滞销美灵芝",
          branch: "青金矿木",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1lcegmc",
          category: "美灵芝",
          name: "纤小瘦身美灵芝",
          branch: "青金矿木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-12cbmkl",
          category: "美灵芝",
          name: "硕大滞销美灵芝",
          branch: "青金矿木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1t1149j",
          category: "美灵芝",
          name: "纤小苍白美灵芝",
          branch: "青金矿木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-2ngkh4",
          category: "竹荪",
          name: "清淡黄花菜味竹荪",
          branch: "青金矿木",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-j7fxqh",
          category: "竹荪",
          name: "浓厚猪肉味竹荪",
          branch: "青金矿木",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1xrhg3n",
          category: "竹荪",
          name: "清淡墨鱼丸味竹荪",
          branch: "青金矿木",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-4lyq9s",
          category: "竹荪",
          name: "适中蓝莓味竹荪",
          branch: "青金矿木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-pla1sh",
          category: "竹荪",
          name: "适中墨鱼丸味竹荪",
          branch: "青金矿木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-s4jr8r",
          category: "竹荪",
          name: "清淡猪肉味竹荪",
          branch: "青金矿木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-zixpnt",
          category: "鸟巢菌",
          name: "超小型不可燃鸟巢菌",
          branch: "青金矿木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-jbqa88",
          category: "鸟巢菌",
          name: "超大型厨余鸟巢菌",
          branch: "青金矿木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-uwdaca",
          category: "鸟巢菌",
          name: "超小型木桩鸟巢菌",
          branch: "青金矿木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-10n7cak",
          category: "鸟巢菌",
          name: "标准五彩豆鸟巢菌",
          branch: "青金矿木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1le5xjh",
          category: "鸟巢菌",
          name: "标准木桩鸟巢菌",
          branch: "青金矿木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-cv99mn",
          category: "鸟巢菌",
          name: "超小型厨余鸟巢菌",
          branch: "青金矿木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-kljh1m",
          category: "鹿角菌",
          name: "中庸素描鹿角菌",
          branch: "松木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1012qov",
          category: "鹿角菌",
          name: "中庸深渊鹿角菌",
          branch: "松木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-164d6ap",
          category: "鹿角菌",
          name: "中庸应援棒鹿角菌",
          branch: "松木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-3eag2f",
          category: "菜菜菌",
          name: "通常西凉菜菜菌",
          branch: "松木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-j2i1si",
          category: "菜菜菌",
          name: "通常幽州菜菜菌",
          branch: "松木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-utq4rg",
          category: "菜菜菌",
          name: "通常椰椰菜菜菌",
          branch: "松木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-hjge6h",
          category: "幽灵菌",
          name: "中号暗黑幽灵菌",
          branch: "松木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-10vbsdk",
          category: "幽灵菌",
          name: "中号挑染幽灵菌",
          branch: "松木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-dchapm",
          category: "幽灵菌",
          name: "中号蓝天白云幽灵菌",
          branch: "松木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-5ia73nw",
          category: "地星菌",
          name: "巨型轻骑兵地星菌",
          branch: "绣衣书案",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-rjqwzg9",
          category: "地星菌",
          name: "巨型朴素地星菌",
          branch: "绣衣书案",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-efuf8ng",
          category: "地星菌",
          name: "小只荷塘夜色地星菌",
          branch: "绣衣书案",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1q3hoca",
          category: "地星菌",
          name: "巨型荷塘夜色地星菌",
          branch: "绣衣书案",
          lamp: "羽绒无烟灯",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-15t2glr",
          category: "地星菌",
          name: "小只黄花菜地星菌",
          branch: "绣衣书案",
          lamp: "羽绒无烟灯",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1a6xsvl",
          category: "地星菌",
          name: "巨型黄花菜地星菌",
          branch: "绣衣书案",
          lamp: "羽绒无烟灯",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1pf5qhy",
          category: "菜菜菌",
          name: "大型椰椰菜菜菌",
          branch: "绣衣书案",
          lamp: "白龙长明灯",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-19j33cb",
          category: "菜菜菌",
          name: "小型老菜菜菌",
          branch: "绣衣书案",
          lamp: "白龙长明灯",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-m1se3p",
          category: "菜菜菌",
          name: "大型老菜菜菌",
          branch: "绣衣书案",
          lamp: "白龙长明灯",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1ddvw6d",
          category: "菜菜菌",
          name: "大型裂开菜菜菌",
          branch: "绣衣书案",
          lamp: "羽绒无烟灯",
          waterer: "深蓝之谜",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-wtwix0",
          category: "菜菜菌",
          name: "大型西凉菜菜菌",
          branch: "绣衣书案",
          lamp: "羽绒无烟灯",
          waterer: "深蓝之谜",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1vi3m0u",
          category: "菜菜菌",
          name: "小型椰椰菜菜菌",
          branch: "绣衣书案",
          lamp: "羽绒无烟灯",
          waterer: "深蓝之谜",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1tf4k7w",
          category: "幽灵菌",
          name: "大号蓝天白云幽灵菌",
          branch: "绣衣书案",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-r3iol9",
          category: "幽灵菌",
          name: "小号一口见阿祖幽灵菌",
          branch: "绣衣书案",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-19meear",
          category: "幽灵菌",
          name: "大号一口见阿祖幽灵菌",
          branch: "绣衣书案",
          lamp: "魂魂烛台",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-q742u5",
          category: "幽灵菌",
          name: "大号幻象幽灵菌",
          branch: "绣衣书案",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-5b8l70",
          category: "幽灵菌",
          name: "大号暗黑幽灵菌",
          branch: "绣衣书案",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1ahq5s6",
          category: "幽灵菌",
          name: "小号蓝天白云幽灵菌",
          branch: "绣衣书案",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1q1r8k5",
          category: "地星菌",
          name: "路边黄花菜地星菌",
          branch: "炎溶岩木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1q1r8k5-2",
          category: "地星菌",
          name: "路边轻骑兵地星菌",
          branch: "炎溶岩木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1q1r8k5-3",
          category: "地星菌",
          name: "小只粉毛地星菌",
          branch: "炎溶岩木",
          lamp: "/",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1vyo1f1",
          category: "地星菌",
          name: "小只朴素地星菌",
          branch: "炎溶岩木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-bkrbfg",
          category: "地星菌",
          name: "巨型粉毛地星菌",
          branch: "炎溶岩木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1oyk0za",
          category: "地星菌",
          name: "小只轻骑兵地星菌",
          branch: "炎溶岩木",
          lamp: "火炬",
          waterer: "/",
          time: "/",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-16u8759",
          category: "菜菜菌",
          name: "通常老菜菜菌",
          branch: "炎溶岩木",
          lamp: "魂魂烛台",
          waterer: "/",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1lq9y8s",
          category: "菜菜菌",
          name: "通常裂开菜菜菌",
          branch: "炎溶岩木",
          lamp: "魂魂烛台",
          waterer: "/",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-vgkely",
          category: "菜菜菌",
          name: "小型水平太菜菜菌",
          branch: "炎溶岩木",
          lamp: "魂魂烛台",
          waterer: "/",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-epg3u1",
          category: "菜菜菌",
          name: "小型西凉菜菜菌",
          branch: "炎溶岩木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-xsh2x4",
          category: "菜菜菌",
          name: "大型水平太菜菜菌",
          branch: "炎溶岩木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1fa1qze",
          category: "菜菜菌",
          name: "小型裂开菜菜菌",
          branch: "炎溶岩木",
          lamp: "魂魂烛台",
          waterer: "竹筒滴漏",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-9y8oyn",
          category: "鹿角菌",
          name: "中庸蔫蔫鹿角菌",
          branch: "炎溶岩木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-udkt3e",
          category: "鹿角菌",
          name: "中庸碧玉鹿角菌",
          branch: "炎溶岩木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-829dck",
          category: "鹿角菌",
          name: "微型二刺螈鹿角菌",
          branch: "炎溶岩木",
          lamp: "火炬",
          waterer: "莲蓬花洒",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-uhrvijl",
          category: "鹿角菌",
          name: "微型素描鹿角菌",
          branch: "炎溶岩木",
          lamp: "魂魂烛台",
          waterer: "深蓝之谜",
          time: "黑夜",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-stuaebd",
          category: "鹿角菌",
          name: "巨体二刺螈鹿角菌",
          branch: "炎溶岩木",
          lamp: "魂魂烛台",
          waterer: "深蓝之谜",
          time: "黑夜",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-7e1b1ox",
          category: "鹿角菌",
          name: "微型碧玉鹿角菌",
          branch: "炎溶岩木",
          lamp: "魂魂烛台",
          waterer: "深蓝之谜",
          time: "黑夜",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-1k1hgex",
          category: "幽灵菌",
          name: "小号暗黑幽灵菌",
          branch: "炎溶岩木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-13iz5o8",
          category: "幽灵菌",
          name: "大号冰山幽灵菌",
          branch: "炎溶岩木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-19kxbfu",
          category: "幽灵菌",
          name: "小号幻象幽灵菌",
          branch: "炎溶岩木",
          lamp: "羽绒无烟灯",
          waterer: "莲蓬花洒",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
        {
          id: "ny-8qq57w",
          category: "幽灵菌",
          name: "中号一口见阿祖幽灵菌",
          branch: "炎溶岩木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "/",
          isFailed: false,
        },
        {
          id: "ny-1t922rh",
          category: "幽灵菌",
          name: "中号幻象幽灵菌",
          branch: "炎溶岩木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "滋补汤",
          isFailed: false,
        },
        {
          id: "ny-1tid1cf",
          category: "幽灵菌",
          name: "小号冰山幽灵菌",
          branch: "炎溶岩木",
          lamp: "羽绒无烟灯",
          waterer: "竹筒滴漏",
          time: "白天",
          condition: "消食片",
          isFailed: false,
        },
      ];

      // 名称映射表（如果以后改了名字，在这里加配置即可自动修复用户存档）
      const NAME_MAPPING = {
        // "旧名字": "新名字"
      };

      const PINYIN_MAP = {
        "/": "/",
        一: "yi",
        不: "bu",
        世: "shi",
        中: "zhong",
        丸: "wan",
        之: "zhi",
        习: "xi",
        书: "shu",
        二: "er",
        云: "yun",
        五: "wu",
        亚: "ya",
        人: "ren",
        体: "ti",
        余: "yu",
        你: "ni",
        健: "jian",
        傲: "ao",
        光: "guang",
        公: "gong",
        兵: "bing",
        冠: "guan",
        冰: "bing",
        准: "zhun",
        凉: "liang",
        凑: "cou",
        凡: "fan",
        切: "qie",
        刺: "ci",
        劳: "lao",
        厚: "hou",
        厨: "chu",
        口: "kou",
        只: "zhi",
        叭: "ba",
        可: "ke",
        台: "tai",
        号: "hao",
        名: "ming",
        味: "wei",
        商: "shang",
        善: "shan",
        喇: "la",
        土: "tu",
        地: "di",
        坏: "huai",
        型: "xing",
        塘: "tang",
        墨: "mo",
        壶: "hu",
        夕: "xi",
        夜: "ye",
        大: "da",
        天: "tian",
        太: "tai",
        头: "tou",
        奉: "feng",
        女: "nv",
        娇: "jiao",
        孙: "sun",
        学: "xue",
        宅: "zhai",
        宝: "bao",
        实: "shi",
        寒: "han",
        寻: "xun",
        封: "feng",
        小: "xiao",
        少: "shao",
        尖: "jian",
        山: "shan",
        岩: "yan",
        州: "zhou",
        巢: "chao",
        巧: "qiao",
        巨: "ju",
        常: "chang",
        帽: "mao",
        平: "ping",
        幻: "huan",
        幽: "you",
        应: "ying",
        庞: "pang",
        康: "kang",
        庸: "yong",
        建: "jian",
        开: "kai",
        张: "zhang",
        彩: "cai",
        微: "wei",
        心: "xin",
        恶: "e",
        戏: "xi",
        手: "shou",
        挑: "tiao",
        描: "miao",
        援: "yuan",
        撞: "zhuang",
        斑: "ban",
        新: "xin",
        无: "wu",
        明: "ming",
        星: "xing",
        春: "chun",
        普: "pu",
        晶: "jing",
        智: "zhi",
        暗: "an",
        木: "mu",
        未: "wei",
        朴: "pu",
        松: "song",
        板: "ban",
        枫: "feng",
        柏: "bai",
        染: "ran",
        标: "biao",
        案: "an",
        桩: "zhuang",
        棒: "bang",
        棘: "ji",
        森: "sen",
        椰: "ye",
        毒: "du",
        比: "bi",
        毛: "mao",
        水: "shui",
        油: "you",
        法: "fa",
        泡: "pao",
        洁: "jie",
        洒: "sa",
        浓: "nong",
        淡: "dan",
        深: "shen",
        清: "qing",
        渊: "yuan",
        温: "wen",
        湿: "shi",
        溶: "rong",
        滞: "zhi",
        滴: "di",
        漏: "lou",
        潮: "chao",
        火: "huo",
        灯: "deng",
        灵: "ling",
        炎: "yan",
        炒: "chao",
        炬: "ju",
        烛: "zhu",
        烟: "yan",
        燃: "ran",
        爆: "bao",
        爪: "zhao",
        爱: "ai",
        牛: "niu",
        牵: "qian",
        特: "te",
        猪: "zhu",
        猫: "mao",
        猴: "hou",
        玉: "yu",
        珊: "shan",
        珍: "zhen",
        琴: "qin",
        瑚: "hu",
        瓷: "ci",
        番: "fan",
        痘: "dou",
        瘦: "shou",
        癖: "pi",
        登: "deng",
        白: "bai",
        的: "de",
        盏: "zhan",
        看: "kan",
        石: "shi",
        矿: "kuang",
        破: "po",
        硕: "shuo",
        碧: "bi",
        社: "she",
        祖: "zu",
        种: "zhong",
        竹: "zhu",
        笨: "ben",
        等: "deng",
        筒: "tong",
        粉: "fen",
        系: "xi",
        素: "su",
        红: "hong",
        纤: "xian",
        级: "ji",
        绒: "rong",
        绝: "jue",
        绣: "xiu",
        绿: "lv",
        缩: "suo",
        美: "mei",
        羽: "yu",
        老: "lao",
        肉: "rou",
        胀: "zhang",
        能: "neng",
        膨: "peng",
        般: "ban",
        良: "liang",
        色: "se",
        芝: "zhi",
        花: "hua",
        苍: "cang",
        茄: "qie",
        草: "cao",
        荧: "ying",
        荪: "sun",
        荷: "he",
        莓: "mei",
        莲: "lian",
        菌: "jun",
        菜: "cai",
        萌: "meng",
        营: "ying",
        葛: "ge",
        董: "dong",
        蓝: "lan",
        蓬: "peng",
        蔫: "nian",
        藕: "ou",
        藤: "teng",
        蛋: "dan",
        螈: "yuan",
        衣: "yi",
        袖: "xiu",
        裂: "lie",
        西: "xi",
        见: "jian",
        规: "gui",
        角: "jiao",
        诩: "xu",
        课: "ke",
        谜: "mi",
        豆: "dou",
        象: "xiang",
        贾: "jia",
        超: "chao",
        路: "lu",
        身: "shen",
        躺: "tang",
        轻: "qing",
        边: "bian",
        过: "guo",
        迷: "mi",
        适: "shi",
        逃: "tao",
        通: "tong",
        邪: "xie",
        郃: "he",
        酥: "su",
        酪: "lao",
        金: "jin",
        铜: "tong",
        销: "xiao",
        锁: "suo",
        长: "zhang",
        阁: "ge",
        阳: "yang",
        阴: "yin",
        阵: "zhen",
        阿: "a",
        陈: "chen",
        陶: "tao",
        陷: "xian",
        隐: "yin",
        青: "qing",
        颈: "jing",
        颜: "yan",
        骑: "qi",
        高: "gao",
        魂: "hun",
        魔: "mo",
        鱼: "yu",
        鳞: "lin",
        鸟: "niao",
        鸢: "yuan",
        鹿: "lu",
        黄: "huang",
        黑: "hei",
        龙: "long",
      };

      const BRANCH_ORDER = [
        "柏木",
        "枫木",
        "松木",
        "常春藤木",
        "牵牛藤木",
        "爱心鳞木",
        "葛藤木",
        "青金矿木",
        "尖刺棘木",
        "炎溶岩木",
        "尖晶矿木",
        "绿松矿木",
        "绝世名琴",
        "绣衣书案",
        "黄金建木",
      ];
      const INGAME_ORDER = [
        "适中蓝莓味竹荪",
        "巨型荷塘夜色地星菌",
        "小斑比草帽菌",
        "中等善良刺头菌",
        "小巧黄金喇叭菌",
        "超小型木桩鸟巢菌",
        "清淡猪肉味竹荪",
        "一般暗黑猫爪菌",
        "适中墨鱼丸味竹荪",
        "超小看破一切泡泡菌",
        "袖珍善良刺头菌",
        "超级宅宅猴头菌",
        "巨巨寒冰刺头菌",
        "小巧超火爆喇叭菌",
        "常见菜色泡泡菌",
        "平凡笨蛋猴头菌",
        "平凡宅宅猴头菌",
        "浓厚猪肉味竹荪",
        "清淡番茄味竹荪",
        "中庸深渊鹿角菌",
        "大型西凉菜菜菌",
        "路边朴素地星菌",
        "超大菜色泡泡菌",
        "迷你红温猫爪菌",
        "微小笨蛋猴头菌",
        "普通恶毒草帽菌",
        "小巧封心锁爱喇叭菌",
        "通常幽州菜菜菌",
        "一般傲娇猫爪菌",
        "超大过劳泡泡菌",
        "超大看破一切泡泡菌",
        "普通斑比草帽菌",
        "特大陷阵营喇叭菌",
        "大型水平太菜菜菌",
        "超小新手泡泡菌",
        "寻常封心锁爱喇叭菌",
        "膨胀贾诩珊瑚菌",
        "庞大酥酪宝石菌",
        "迷你萌萌猫爪菌",
        "中庸素描鹿角菌",
        "标准不可燃鸟巢菌",
        "大型幽州菜菜菌",
        "巨型黄花菜地星菌",
        "缩水公孙珊珊瑚菌",
        "平凡隐鸢阁冠名猴头菌",
        "大号一口见阿祖幽灵菌",
        "超级笨蛋猴头菌",
        "迷你傲娇猫爪菌",
        "适中莲藕味竹荪",
        "小只轻骑兵地星菌",
        "大斑比草帽菌",
        "路边粉毛地星菌",
        "标准可燃鸟巢菌",
        "庞大番茄炒蛋宝石菌",
        "中庸蔫蔫鹿角菌",
        "袖珍太白金星刺头菌",
        "小号一口见阿祖幽灵菌",
        "微型素描鹿角菌",
        "常见过劳泡泡菌",
        "超大亚健康泡泡菌",
        "普通健美草帽菌",
        "小小坏种宝石菌",
        "微小隐鸢阁冠名猴头菌",
        "寻常超火爆喇叭菌",
        "缩水张郃珊瑚菌",
        "中级戏学珊瑚菌",
        "巨体碧玉鹿角菌",
        "纤小滞销美灵芝",
        "巨巨善良刺头菌",
        "超大型厨余鸟巢菌",
        "大健美草帽菌",
        "标准陶瓷鸟巢菌",
        "巨巨邪恶刺头菌",
        "巨大萌萌猫爪菌",
        "小只黄花菜地星菌",
        "小号幻象幽灵菌",
        "大号挑染幽灵菌",
        "清淡蓝莓味竹荪",
        "路边黄花菜地星菌",
        "中号蓝天白云幽灵菌",
        "通常水平太菜菜菌",
        "常规躺板板宝石菌",
        "大恶毒草帽菌",
        "硕大苍白美灵芝",
        "微小宅宅猴头菌",
        "中等太白金星刺头菌",
        "小型幽州菜菜菌",
        "大老土草帽菌",
        "大号冰山幽灵菌",
        "微型碧玉鹿角菌",
        "适中番茄味竹荪",
        "膨胀戏学珊瑚菌",
        "中号冰山幽灵菌",
        "小号蓝天白云幽灵菌",
        "中庸二刺螈鹿角菌",
        "寻常黄金喇叭菌",
        "通常椰椰菜菜菌",
        "巨大傲娇猫爪菌",
        "标准木桩鸟巢菌",
        "小小酥酪宝石菌",
        "寻常阴湿美灵芝",
        "巨体素描鹿角菌",
        "浓厚蓝莓味竹荪",
        "小号暗黑幽灵菌",
        "适中猪肉味竹荪",
        "纤小阴湿美灵芝",
        "庞大躺板板宝石菌",
        "超小型可燃鸟巢菌",
        "超级逃课猴头菌",
        "路边荷塘夜色地星菌",
        "巨巨魔法少女刺头菌",
        "小小番茄炒蛋宝石菌",
        "小型西凉菜菜菌",
        "硕大潮人美灵芝",
        "微型应援棒鹿角菌",
        "巨体深渊鹿角菌",
        "小健美草帽菌",
        "中等魔法少女刺头菌",
        "一般萌萌猫爪菌",
        "超大新手泡泡菌",
        "巨型轻骑兵地星菌",
        "标准五彩豆鸟巢菌",
        "超大型可燃鸟巢菌",
        "特大青春痘喇叭菌",
        "超小亚健康泡泡菌",
        "常见新手泡泡菌",
        "常见实习泡泡菌",
        "小只荷塘夜色地星菌",
        "小老土草帽菌",
        "特大黄金喇叭菌",
        "路边轻骑兵地星菌",
        "袖珍魔法少女刺头菌",
        "中号一口见阿祖幽灵菌",
        "普通老土草帽菌",
        "小洁癖草帽菌",
        "常规酥酪宝石菌",
        "大蓝瘦草帽菌",
        "中级陈登珊瑚菌",
        "微小社牛猴头菌",
        "常见亚健康泡泡菌",
        "巨大凑凑猫爪菌",
        "通常老菜菜菌",
        "小号挑染幽灵菌",
        "常规番茄炒蛋宝石菌",
        "小小躺板板宝石菌",
        "寻常滞销美灵芝",
        "大型椰椰菜菜菌",
        "巨巨太白金星刺头菌",
        "小巧陷阵营喇叭菌",
        "微小逃课猴头菌",
        "大洁癖草帽菌",
        "小巧夕阳喇叭菌",
        "庞大夜光宝石菌",
        "缩水董奉珊瑚菌",
        "超小型不可燃鸟巢菌",
        "超大型木桩鸟巢菌",
        "大型裂开菜菜菌",
        "小恶毒草帽菌",
        "中号挑染幽灵菌",
        "超小型陶瓷鸟巢菌",
        "寻常夕阳喇叭菌",
        "巨型朴素地星菌",
        "超小型厨余鸟巢菌",
        "中级张郃珊瑚菌",
        "平凡社牛猴头菌",
        "巨体二刺螈鹿角菌",
        "超大型五彩豆鸟巢菌",
        "袖珍小荧光刺头菌",
        "迷你撞色猫爪菌",
        "通常西凉菜菜菌",
        "迷你暗黑猫爪菌",
        "巨体蔫蔫鹿角菌",
        "巨型森系地星菌",
        "硕大阴湿美灵芝",
        "纤小苍白美灵芝",
        "浓厚墨鱼丸味竹荪",
        "中级公孙珊珊瑚菌",
        "寻常红颜美灵芝",
        "小小夜光宝石菌",
        "中级贾诩珊瑚菌",
        "庞大白切黑宝石菌",
        "浓厚黄花菜味竹荪",
        "超小实习泡泡菌",
        "常见看破一切泡泡菌",
        "大号蓝天白云幽灵菌",
        "小型水平太菜菜菌",
        "小只粉毛地星菌",
        "大型老菜菜菌",
        "大号幻象幽灵菌",
        "超小过劳泡泡菌",
        "巨大红温猫爪菌",
        "超级高智商猴头菌",
        "超小型五彩豆鸟巢菌",
        "特大夕阳喇叭菌",
        "寻常苍白美灵芝",
        "纤小潮人美灵芝",
        "寻常陷阵营喇叭菌",
        "一般凑凑猫爪菌",
        "常规坏种宝石菌",
        "普通洁癖草帽菌",
        "通常裂开菜菜菌",
        "小只朴素地星菌",
        "浓厚番茄味竹荪",
        "缩水贾诩珊瑚菌",
        "特大封心锁爱喇叭菌",
        "平凡逃课猴头菌",
        "小型椰椰菜菜菌",
        "寻常潮人美灵芝",
        "中等荧光刺头菌",
        "微型二刺螈鹿角菌",
        "标准厨余鸟巢菌",
        "巨型粉毛地星菌",
        "超大型陶瓷鸟巢菌",
        "小型老菜菜菌",
        "清淡莲藕味竹荪",
        "巨大撞色猫爪菌",
        "硕大红颜美灵芝",
        "庞大坏种宝石菌",
        "清淡黄花菜味竹荪",
        "超大型不可燃鸟巢菌",
        "小只森系地星菌",
        "小小白切黑宝石菌",
        "小型裂开菜菜菌",
        "超级社牛猴头菌",
        "硕大瘦身美灵芝",
        "浓厚莲藕味竹荪",
        "中号幻象幽灵菌",
        "膨胀董奉珊瑚菌",
        "常规夜光宝石菌",
        "缩水陈登珊瑚菌",
        "中庸碧玉鹿角菌",
        "巨体应援棒鹿角菌",
        "适中黄花菜味竹荪",
        "微型蔫蔫鹿角菌",
        "特大超火爆喇叭菌",
        "缩水戏学珊瑚菌",
        "巨大暗黑猫爪菌",
        "超小菜色泡泡菌",
        "纤小瘦身美灵芝",
        "巨巨荧光刺头菌",
        "小蓝瘦草帽菌",
        "常规白切黑宝石菌",
        "纤小红颜美灵芝",
        "中号暗黑幽灵菌",
        "超大实习泡泡菌",
        "中等邪恶刺头菌",
        "平凡高智商猴头菌",
        "小号冰山幽灵菌",
        "寻常青春痘喇叭菌",
        "大号暗黑幽灵菌",
        "普通蓝瘦草帽菌",
        "寻常瘦身美灵芝",
        "微小高智商猴头菌",
        "小巧青春痘喇叭菌",
        "膨胀陈登珊瑚菌",
        "膨胀张郃珊瑚菌",
        "微型深渊鹿角菌",
        "中级董奉珊瑚菌",
        "硕大滞销美灵芝",
        "一般红温猫爪菌",
        "膨胀公孙珊珊瑚菌",
        "一般撞色猫爪菌",
        "超级隐鸢阁冠名猴头菌",
        "迷你凑凑猫爪菌",
        "袖珍寒冰刺头菌",
        "中庸应援棒鹿角菌",
        "袖珍邪恶刺头菌",
        "清淡墨鱼丸味竹荪",
        "中等寒冰刺头菌",
        "路边森系地星菌",
        "未能长大的草帽菌",
        "未能长大的泡泡菌",
        "未能长大的刺头菌",
        "未能长大的猫爪菌",
        "未能长大的珊瑚菌",
        "未能长大的喇叭菌",
        "未能长大的地星菌",
        "未能长大的幽灵菌",
        "未能长大的菜菜菌",
        "未能长大的鹿角菌",
        "未能长大的猴头菌",
        "未能长大的鸟巢菌",
        "未能长大的美灵芝",
        "未能长大的竹荪",
        "未能长大的宝石菌",
      ];
      const INGAME_ORDER_INDEX = new Map(
        INGAME_ORDER.map((name, index) => [name.trim(), index])
      );
      const getIngameOrderIndex = (name) => {
        const key = String(name || "").trim();
        if (!key) return Number.MAX_SAFE_INTEGER;
        const index = INGAME_ORDER_INDEX.get(key);
        return index === undefined ? Number.MAX_SAFE_INTEGER : index;
      };
      const LONG_TIME_MUSHROOMS = new Set([
        "袖珍善良刺头菌",
        "袖珍魔法少女刺头菌",
        "巨巨荧光刺头菌",
        "小只朴素地星菌",
        "巨型粉毛地星菌",
        "小只轻骑兵地星菌",
        "微小社牛猴头菌",
        "超级高智商猴头菌",
        "微小逃课猴头菌",
        "小小番茄炒蛋宝石菌",
        "庞大坏种宝石菌",
        "小小夜光宝石菌",
        "硕大阴湿美灵芝",
        "纤小潮人美灵芝",
        "硕大潮人美灵芝",
        "巨型荷塘夜色地星菌",
        "小只黄花菜地星菌",
        "巨型黄花菜地星菌",
        "巨体应援棒鹿角菌",
        "微型蔫蔫鹿角菌",
        "巨体蔫蔫鹿角菌",
      ]);
      const EQUIPMENT_RARITY_CLASS = {
        branch: new Map([
          ["柏木", "rarity-common"],
          ["枫木", "rarity-common"],
          ["松木", "rarity-common"],
          ["牵牛藤木", "rarity-common"],
          ["常春藤木", "rarity-common"],
          ["牵牛藤木", "rarity-common"],
          ["爱心鳞木", "rarity-rare"],
          ["葛藤木", "rarity-rare"],
          ["炎溶岩木", "rarity-rare"],
          ["青金矿木", "rarity-rare"],
          ["尖刺棘木", "rarity-rare"],
          ["尖晶矿木", "rarity-legend"],
          ["绿松矿木", "rarity-legend"],
          ["绣衣书案", "rarity-legend"],
          ["绝世名琴", "rarity-legend"],
          ["黄金建木", "rarity-legend"],
        ]),
        lamp: new Map([
          ["火炬", "rarity-common"],
          ["魂魂烛台", "rarity-common"],
          ["铜盏油灯", "rarity-common"],
          ["羽绒无烟灯", "rarity-rare"],
          ["白龙长明灯", "rarity-legend"],
        ]),
        waterer: new Map([
          ["竹筒滴漏", "rarity-common"],
          ["莲蓬花洒", "rarity-common"],
          ["陶滴壶", "rarity-common"],
          ["小鸟长颈壶", "rarity-rare"],
          ["深蓝之谜", "rarity-legend"],
        ]),
      };
      const IMMORTAL_TAG_COLORS = {
        1: "#d4af37",
        2: "#d9782d",
        3: "#d44747",
      };

      const CSV_PATH = "./assets/nanyang.csv";

      const normalizeValue = (value, fallback = "/") => {
        if (value === undefined || value === null) return fallback;
        const trimmed = String(value).trim();
        return trimmed === "" ? fallback : trimmed;
      };

      const hashString = (input) => {
        let hash = 2166136261;
        for (let i = 0; i < input.length; i++) {
          hash ^= input.charCodeAt(i);
          hash = Math.imul(hash, 16777619);
        }
        return (hash >>> 0).toString(36);
      };

      const buildBaseKey = (row) => {
        return [
          row.category,
          row.branch,
          row.lamp,
          row.waterer,
          row.time,
          row.condition,
        ].join("|");
      };

      const makeMushroomId = (baseKey, count) => {
        const baseHash = hashString(baseKey);
        return count === 1 ? `ny-${baseHash}` : `ny-${baseHash}-${count}`;
      };

      const parseCsvLine = (line) => {
        const values = [];
        let current = "";
        let inQuotes = false;

        for (let i = 0; i < line.length; i++) {
          const char = line[i];
          if (char === '"') {
            if (inQuotes && line[i + 1] === '"') {
              current += '"';
              i += 1;
            } else {
              inQuotes = !inQuotes;
            }
          } else if (char === "," && !inQuotes) {
            values.push(current);
            current = "";
          } else {
            current += char;
          }
        }
        values.push(current);
        return values;
      };

      const parseCsvText = (text) => {
        const lines = text.split(/\r?\n/).filter((line) => line.trim() !== "");
        if (lines.length === 0) return [];
        const headers = parseCsvLine(lines[0]).map((header) => {
          const trimmed = header.trim();
          return trimmed.charCodeAt(0) === 0xfeff ? trimmed.slice(1) : trimmed;
        });
        return lines.slice(1).map((line) => {
          const values = parseCsvLine(line);
          const row = {};
          headers.forEach((header, idx) => {
            row[header] = (values[idx] || "").trim();
          });
          return row;
        });
      };

      const mapCsvRow = (row) => {
        return {
          id: normalizeValue(row["id"] || row["ID"] || row["\u7f16\u53f7"], ""),
          category: normalizeValue(row["\u79cd\u7c7b"] || row["\u7c7b\u522b"]),
          name: normalizeValue(
            row["\u83cc\u5b50\u540d\u79f0"] || row["\u540d\u79f0"],
            ""
          ),
          branch: normalizeValue(row["\u679d\u5e72"]),
          lamp: normalizeValue(
            row["\u65e5\u7167\u706f"] || row["\u706f\u5177"] || row["\u706f"]
          ),
          waterer: normalizeValue(
            row["\u8865\u6c34\u5668"] || row["\u6c34\u5177"] || row["\u6c34"]
          ),
          time: normalizeValue(row["\u65f6\u95f4"]),
          condition: normalizeValue(row["\u6761\u4ef6"]),
        };
      };

      const normalizeDatabase = (rows) => {
        const counts = new Map();
        const seenIds = new Set();

        return rows
          .map((row) => {
            const normalized = {
              id: normalizeValue(row.id, ""),
              category: normalizeValue(row.category),
              name: normalizeValue(row.name, ""),
              branch: normalizeValue(row.branch),
              lamp: normalizeValue(row.lamp),
              waterer: normalizeValue(row.waterer),
              time: normalizeValue(row.time),
              condition: normalizeValue(row.condition),
            };

            if (!normalized.name) return null;

            const baseKey = buildBaseKey(normalized);
            const count = (counts.get(baseKey) || 0) + 1;
            counts.set(baseKey, count);

            if (!normalized.id) {
              normalized.id = makeMushroomId(baseKey, count);
            } else if (seenIds.has(normalized.id)) {
              let suffix = 2;
              let candidate = `${normalized.id}-${suffix}`;
              while (seenIds.has(candidate)) {
                suffix += 1;
                candidate = `${normalized.id}-${suffix}`;
              }
              normalized.id = candidate;
            }
            seenIds.add(normalized.id);

            normalized.isFailed = normalized.condition === "\u672a\u6740\u866b";
            return normalized;
          })
          .filter(Boolean);
      };

      const loadCsvDatabase = async () => {
        try {
          const response = await fetch(CSV_PATH, { cache: "no-store" });
          if (!response.ok) {
            throw new Error(`CSV load failed: ${response.status}`);
          }
          const text = await response.text();
          const parsed = parseCsvText(text).map(mapCsvRow);
          const normalized = normalizeDatabase(parsed);
          if (normalized.length === 0) {
            throw new Error("CSV is empty");
          }
          return normalized;
        } catch (error) {
          console.warn("CSV load failed; fallback to embedded data.", error);
          return normalizeDatabase(RAW_DATA);
        }
      };

      const initApp = (databaseInput) => {
        createApp({
          setup() {
            const database = databaseInput;
            const tabOptions = new Set([
              "rec",
              "order",
              "inv",
              "col",
              "log",
              "order-log",
            ]);
            const storedTab = localStorage.getItem("mushroom_current_tab");
            const currentTab = ref(
              storedTab && tabOptions.has(storedTab) ? storedTab : "rec"
            );
            const currentTime = ref(
              localStorage.getItem("mushroom_current_time") || "白天"
            );
            const searchQuery = ref("");
            const useIngameOrder = ref(false);
            const showOnlyUncollected = ref(false);
            const handbookPickerVisible = ref(false);
            const handbookPickerCategory = ref("");
            const orderQuery = ref("");
            const orderPickerVisible = ref(false);
            const orderPickerCategory = ref("");
            const storedOrderHints = localStorage.getItem(
              "mushroom_order_hints"
            );
            const showOrderHints = ref(
              storedOrderHints !== null
                ? storedOrderHints === "true"
                : localStorage.getItem("mushroom_task_hints") === "true"
            );
            const storedOrderRank = localStorage.getItem("mushroom_order_rank");
            const orderAffectsRanking = ref(
              storedOrderRank !== null
                ? storedOrderRank === "true"
                : localStorage.getItem("mushroom_task_rank") === "true"
            );
            if (!showOrderHints.value) orderAffectsRanking.value = false;
            const users = ref([]);
            const currentUserIndex = ref(0);
            const currentUser = computed(() => {
              if (!users.value[currentUserIndex.value])
                return {
                  inventory: { branches: [], lamps: [], waterers: [] },
                  collected: [],
                  pending: [],
                  orders: [],
                  orderInventory: {},
                  orderHistory: [],
                  history: [],
                };
              return users.value[currentUserIndex.value];
            });
            const isInventoryEmpty = computed(() => {
              const inv = currentUser.value.inventory || {};
              const branches = Array.isArray(inv.branches) ? inv.branches : [];
              const lamps = Array.isArray(inv.lamps) ? inv.lamps : [];
              const waterers = Array.isArray(inv.waterers) ? inv.waterers : [];
              return (
                branches.length === 0 &&
                lamps.length === 0 &&
                waterers.length === 0
              );
            });
            const isHandbookEmpty = computed(() => {
              return currentUser.value.collected.length === 0;
            });
            const reversedHistory = computed(() => {
              return [...currentUser.value.history].reverse();
            });
            const reversedOrderHistory = computed(() => {
              return [...(currentUser.value.orderHistory || [])].reverse();
            });
            const orderPresets = ["刘辩", "傅融", "左慈", "袁基", "孙策"];
            const orderDraft = reactive({
              id: "",
              name: "",
              reward: 0,
              items: [],
            });
            const orderFormVisible = ref(false);
            const storedOrderListCollapsed = localStorage.getItem(
              "mushroom_order_list_collapsed"
            );
            const orderListCollapsed = ref(storedOrderListCollapsed === "true");
            const orderPanelRef = ref(null);
            const recListTop = ref(null);

            const manualToggleState = reactive({});
            const pinnedPlans = reactive({});
            const pinnedOrder = ref([]);
            const storedPinnedPlans = localStorage.getItem(
              "mushroom_pinned_plans"
            );
            if (storedPinnedPlans) {
              try {
                const parsed = JSON.parse(storedPinnedPlans);
                if (Array.isArray(parsed)) {
                  const cleaned = [];
                  const seen = new Set();
                  parsed.forEach((item) => {
                    if (typeof item !== "string" || !item) return;
                    if (seen.has(item)) return;
                    seen.add(item);
                    cleaned.push(item);
                    pinnedPlans[item] = true;
                  });
                  pinnedOrder.value = cleaned;
                }
              } catch (error) {
                console.warn("Failed to parse pinned plans.", error);
              }
            }
            const toastMessage = ref("");
            const toastVisible = ref(false);
            let toastTimer = null;
            const importInput = ref(null);
            const orderFloatPulse = ref(false);
            let orderFloatTimer = null;
            const storedOrderFloatCollapsed = localStorage.getItem(
              "mushroom_order_float_collapsed"
            );
            const orderFloatCollapsed = ref(
              storedOrderFloatCollapsed === "true"
            );
            const panelNotice = ref(null);
            let panelNoticeTimer = null;
            const focusOrderId = ref("");
            let focusTimer = null;
            const orderHoverTip = reactive({
              visible: false,
              x: 0,
              y: 0,
              lines: [],
            });

            const scrollToElement = (targetRef) => {
              if (!targetRef || !targetRef.value) return;
              targetRef.value.scrollIntoView({
                behavior: "smooth",
                block: "start",
              });
            };

            const scrollToOrderPanel = () => {
              scrollToElement(orderPanelRef);
            };

            const scrollToRecTop = () => {
              scrollToElement(recListTop);
            };

            const toggleTime = () => {
              currentTime.value =
                currentTime.value === "白天" ? "黑夜" : "白天";
            };

            const isLongTimeMushroom = (name) => {
              const trimmed = (name || "").trim();
              if (!trimmed) return false;
              return LONG_TIME_MUSHROOMS.has(trimmed);
            };

            const hasLongTimeInPlan = (rec) => {
              if (!rec) return false;
              const list = [];
              if (Array.isArray(rec.mushrooms)) {
                list.push(...rec.mushrooms);
              }
              if (Array.isArray(rec.orderMatches)) {
                list.push(...rec.orderMatches);
              }
              return list.some((item) => isLongTimeMushroom(item.name));
            };
            const getRarityClass = (type, value) => {
              const map = EQUIPMENT_RARITY_CLASS[type];
              if (!map) return "";
              const key = String(value || "").trim();
              if (!key || key === "/") return "";
              return map.get(key) || "";
            };
            const getLegendaryCount = (value) => {
              const resolvedId = normalizeMushroomId(value);
              const mushroom = idToMushroom.get(resolvedId);
              if (!mushroom) return 0;
              let count = 0;
              if (getRarityClass("branch", mushroom.branch) === "rarity-legend")
                count += 1;
              if (getRarityClass("lamp", mushroom.lamp) === "rarity-legend")
                count += 1;
              if (
                getRarityClass("waterer", mushroom.waterer) === "rarity-legend"
              )
                count += 1;
              return count;
            };
            const getImmortalTagStyle = (value) => {
              const count = getLegendaryCount(value);
              if (!count) return null;
              if (count === 2) {
                const base = IMMORTAL_TAG_COLORS[1] || "#d4af37";
                return {
                  background: base,
                  boxShadow: "inset 0 0 0 2px #FFD46A",
                };
              }
              const color =
                IMMORTAL_TAG_COLORS[count] || IMMORTAL_TAG_COLORS[3];
              return { background: color };
            };
            const getComplexityMeta = (value) => {
              const resolvedId = normalizeMushroomId(value);
              const mushroom = idToMushroom.get(resolvedId);
              if (!mushroom) return { label: "", className: "" };
              const name = (mushroom.name || "").trim();
              if (isLongTimeMushroom(name)) {
                return { label: "牢", className: "tag-jail" };
              }
              const hasLamp =
                mushroom.lamp && String(mushroom.lamp).trim() !== "/";
              const hasWaterer =
                mushroom.waterer && String(mushroom.waterer).trim() !== "/";
              const hasCondition =
                mushroom.condition && String(mushroom.condition).trim() !== "/";
              const complexity =
                (hasLamp ? 1 : 0) +
                (hasWaterer ? 1 : 0) +
                (hasCondition ? 1 : 0);
              let label = "易";
              if (hasCondition && complexity < 2) {
                label = "普";
              } else if (complexity >= 3) {
                label = "难";
              } else if (complexity >= 2) {
                label = "普";
              }
              const className =
                label === "易"
                  ? "tag-easy"
                  : label === "普"
                  ? "tag-normal"
                  : "tag-hard";
              return { label, className };
            };
            const getComplexityLabel = (value) => {
              return getComplexityMeta(value).label;
            };
            const getComplexityClass = (value) => {
              return getComplexityMeta(value).className;
            };
            const TOOLTIP_RARITY_CLASS = {
              "rarity-common": "tooltip-rarity-common",
              "rarity-rare": "tooltip-rarity-rare",
              "rarity-legend": "tooltip-rarity-legend",
            };
            const getTooltipRarityClass = (type, value) => {
              const baseClass = getRarityClass(type, value);
              return TOOLTIP_RARITY_CLASS[baseClass] || "";
            };
            const getTooltipConditionClass = (value) => {
              const text = String(value || "");
              if (text.includes("滋补汤")) return "tooltip-condition-soup";
              if (text.includes("消食片")) return "tooltip-condition-tablet";
              return "";
            };
            const orderTargetInfoCache = new Map();
            const formatRouteValue = (value, fallback) => {
              if (value === undefined || value === null) return fallback;
              const trimmed = String(value).trim();
              if (!trimmed || trimmed === "/") return fallback;
              return trimmed;
            };
            const getOrderTargetInfoLines = (value) => {
              const resolvedId = normalizeMushroomId(value);
              if (orderTargetInfoCache.has(resolvedId)) {
                return orderTargetInfoCache.get(resolvedId);
              }
              const mushroom = idToMushroom.get(resolvedId);
              if (!mushroom) {
                orderTargetInfoCache.set(resolvedId, []);
                return [];
              }
              const lines = [
                {
                  label: "木:",
                  value: formatRouteValue(mushroom.branch, "无/任意"),
                  className: getTooltipRarityClass("branch", mushroom.branch),
                },
                {
                  label: "灯:",
                  value: formatRouteValue(mushroom.lamp, "无/任意"),
                  className: getTooltipRarityClass("lamp", mushroom.lamp),
                },
                {
                  label: "水:",
                  value: formatRouteValue(mushroom.waterer, "无/任意"),
                  className: getTooltipRarityClass("waterer", mushroom.waterer),
                },
                {
                  label: "道具:",
                  value: formatRouteValue(mushroom.condition, "不需道具"),
                  className: getTooltipConditionClass(mushroom.condition),
                },
                {
                  label: "时段:",
                  value: formatRouteValue(mushroom.time, "全时段"),
                  className: "",
                },
                {
                  label: "需检查时间:",
                  value: isLongTimeMushroom(mushroom.name) ? "是" : "否",
                  className: "",
                },
              ];
              orderTargetInfoCache.set(resolvedId, lines);
              return lines;
            };
            const updateOrderHoverTipPosition = (event) => {
              if (!event) return;
              const offsetX = 12;
              const offsetY = 12;
              orderHoverTip.x = event.clientX + offsetX;
              orderHoverTip.y = event.clientY + offsetY;
            };
            const showOrderHoverTip = (id, event) => {
              const lines = getOrderTargetInfoLines(id);
              if (!lines.length) return;
              orderHoverTip.lines = lines;
              orderHoverTip.visible = true;
              updateOrderHoverTipPosition(event);
            };
            const moveOrderHoverTip = (event) => {
              if (!orderHoverTip.visible) return;
              updateOrderHoverTipPosition(event);
            };
            const hideOrderHoverTip = () => {
              orderHoverTip.visible = false;
            };

            const idToMushroom = new Map(database.map((m) => [m.id, m]));
            const nameToId = new Map(database.map((m) => [m.name, m.id]));
            const idSet = new Set(idToMushroom.keys());

            const resolveMushroomId = (value) => {
              if (idSet.has(value)) return value;
              const correctedName = NAME_MAPPING[value] || value;
              return nameToId.get(correctedName) || "";
            };

            const normalizeMushroomId = (value) => {
              return resolveMushroomId(value) || value;
            };

            const normalizeSearchValue = (value) => {
              return (value || "").toLowerCase().replace(/\s+/g, "");
            };
            const pinyinCache = new Map();
            const pinyinInitialCache = new Map();
            const toPinyin = (value) => {
              const key = value || "";
              if (pinyinCache.has(key)) return pinyinCache.get(key);
              let result = "";
              for (const ch of key) {
                result += PINYIN_MAP[ch] || ch;
              }
              const normalized = normalizeSearchValue(result);
              pinyinCache.set(key, normalized);
              return normalized;
            };
            const toPinyinInitials = (value) => {
              const key = value || "";
              if (pinyinInitialCache.has(key))
                return pinyinInitialCache.get(key);
              let result = "";
              for (const ch of key) {
                const pinyin = PINYIN_MAP[ch];
                if (pinyin) result += pinyin[0] || "";
                else result += ch;
              }
              const normalized = normalizeSearchValue(result);
              pinyinInitialCache.set(key, normalized);
              return normalized;
            };
            const matchesSearchText = (value, rawQuery, normalizedQuery) => {
              if (!rawQuery) return true;
              const text = value || "";
              if (text.includes(rawQuery)) return true;
              if (!normalizedQuery) return true;
              const normalizedText = normalizeSearchValue(text);
              if (normalizedText.includes(normalizedQuery)) return true;
              if (toPinyin(text).includes(normalizedQuery)) return true;
              return toPinyinInitials(text).includes(normalizedQuery);
            };
            const matchesOrderSearch = (m, rawQuery, normalizedQuery) => {
              if (!m) return false;
              return (
                matchesSearchText(m.name, rawQuery, normalizedQuery) ||
                matchesSearchText(m.category, rawQuery, normalizedQuery) ||
                matchesSearchText(m.branch, rawQuery, normalizedQuery)
              );
            };
            const matchesHandbookSearch = (m, rawQuery, normalizedQuery) => {
              if (!m) return false;
              return matchesSearchText(m.name, rawQuery, normalizedQuery);
            };

            const getHistoryName = (log) => {
              if (!log) return "";
              if (log.id && idToMushroom.has(log.id))
                return idToMushroom.get(log.id).name;
              if (log.name) return log.name;
              if (log.id) return log.id;
              return "";
            };

            const ensurePendingList = () => {
              if (!Array.isArray(currentUser.value.pending)) {
                currentUser.value.pending = [];
              }
              return currentUser.value.pending;
            };

            const isPendingHarvest = (id) => {
              const resolvedId = normalizeMushroomId(id);
              const pending = currentUser.value.pending || [];
              return pending.includes(resolvedId);
            };

            const markPendingHarvest = (id) => {
              const resolvedId = normalizeMushroomId(id);
              if (currentUser.value.collected.includes(resolvedId)) return;
              const pending = ensurePendingList();
              if (!pending.includes(resolvedId)) {
                pending.push(resolvedId);
              }
            };

            const cancelHarvest = (id) => {
              const resolvedId = normalizeMushroomId(id);
              const pending = ensurePendingList();
              const idx = pending.indexOf(resolvedId);
              if (idx > -1) pending.splice(idx, 1);
            };

            const confirmHarvest = (id) => {
              const resolvedId = normalizeMushroomId(id);
              cancelHarvest(resolvedId);
              if (!currentUser.value.collected.includes(resolvedId)) {
                currentUser.value.collected.push(resolvedId);
                const record = {
                  id: resolvedId,
                  timestamp: Date.now(),
                };
                currentUser.value.history.push(record);
                setPanelNotice({
                  type: "collect",
                  record,
                  message: `竟然收集到了【${getOrderItemName(resolvedId)}】`,
                });
              }
              if (getOrderRequiredTotal(resolvedId) > 0) {
                recordOrderIncrement(resolvedId, "harvest");
              }
            };

            const ensureOrderList = () => {
              if (!Array.isArray(currentUser.value.orders)) {
                currentUser.value.orders = [];
              }
              return currentUser.value.orders;
            };

            const ensureOrderInventory = () => {
              if (
                !currentUser.value.orderInventory ||
                typeof currentUser.value.orderInventory !== "object"
              ) {
                currentUser.value.orderInventory = {};
              }
              return currentUser.value.orderInventory;
            };

            const ensureOrderHistory = () => {
              if (!Array.isArray(currentUser.value.orderHistory)) {
                currentUser.value.orderHistory = [];
              }
              return currentUser.value.orderHistory;
            };

            const generateOrderId = () => {
              return `order-${Date.now().toString(36)}-${Math.random()
                .toString(36)
                .slice(2, 6)}`;
            };

            const formatOrderName = (name) => {
              const trimmed = (name || "").trim();
              if (!trimmed) return "未命名订单";
              if (trimmed.includes("订单")) return trimmed;
              return `${trimmed}的订单`;
            };
            const getOrderReward = (order) => {
              if (!order) return 0;
              const value = parseInt(order.reward, 10);
              return Number.isFinite(value) && value >= 0 ? value : 0;
            };

            const specialOrderOwners = new Set([
              "傅融",
              "左慈",
              "袁基",
              "刘辩",
              "孙策",
            ]);

            const isThreeColumnOrder = (name) => {
              const trimmed = (name || "").trim();
              if (!trimmed) return false;
              const normalized = trimmed.replace(/的?订单$/, "");
              return specialOrderOwners.has(normalized);
            };

            const getOrderItem = (id) => {
              const resolvedId = normalizeMushroomId(id);
              const item = idToMushroom.get(resolvedId);
              return (
                item || {
                  id: resolvedId,
                  name: resolvedId,
                  category: "",
                  branch: "",
                  lamp: "",
                  waterer: "",
                  time: "/",
                  condition: "/",
                  isFailed: false,
                }
              );
            };

            const getOrderItemName = (id) => {
              const item = getOrderItem(id);
              return item.name || item.id || "";
            };

            const getOrderCount = (id) => {
              const inv = ensureOrderInventory();
              const resolvedId = normalizeMushroomId(id);
              const value = parseInt(inv[resolvedId], 10);
              return Number.isFinite(value) && value >= 0 ? value : 0;
            };

            const setOrderCount = (id, value) => {
              const inv = ensureOrderInventory();
              const resolvedId = normalizeMushroomId(id);
              let next = parseInt(value, 10);
              if (!Number.isFinite(next) || next < 0) next = 0;
              inv[resolvedId] = next;
            };

            const incrementOrderCount = (id, delta = 1) => {
              const current = getOrderCount(id);
              setOrderCount(id, current + delta);
            };

            const recordOrderIncrement = (id, source) => {
              const resolvedId = normalizeMushroomId(id);
              if (!resolvedId) return;
              incrementOrderCount(resolvedId);
              const record = {
                id: generateOrderId(),
                name: "",
                reward: 0,
                action: "increment",
                source: source || "",
                items: [{ id: resolvedId, required: 1 }],
                timestamp: Date.now(),
              };
              ensureOrderHistory().push(record);
              setPanelNotice({
                type: "order",
                record,
                message: `【${getOrderItemName(resolvedId)}】库存 +1 了哦`,
              });
              showToast(`【${getOrderItemName(resolvedId)} 】库存 +1`);
            };

            const ensureCollectedForOrderIncrement = (id) => {
              const resolvedId = normalizeMushroomId(id);
              if (!resolvedId) return false;
              if (currentUser.value.collected.includes(resolvedId)) return true;
              const name = getOrderItemName(resolvedId);
              const confirmed = confirm(
                `"${name}" 还未在图鉴中标记已收集，是否更新图鉴并将库存 +1？`
              );
              if (!confirmed) return false;
              const pending = ensurePendingList();
              const pendingIdx = pending.indexOf(resolvedId);
              if (pendingIdx > -1) pending.splice(pendingIdx, 1);
              if (!currentUser.value.collected.includes(resolvedId)) {
                currentUser.value.collected.push(resolvedId);
                const record = {
                  id: resolvedId,
                  timestamp: Date.now(),
                };
                currentUser.value.history.push(record);
                setPanelNotice({
                  type: "collect",
                  record,
                  message: `已收集 ${getOrderItemName(resolvedId)}`,
                });
              }
              return true;
            };

            const requestOrderIncrement = (id, source) => {
              const resolvedId = normalizeMushroomId(id);
              if (!resolvedId) return;
              if (!ensureCollectedForOrderIncrement(resolvedId)) return;
              recordOrderIncrement(resolvedId, source);
            };

            const setOrderRequired = (item, value) => {
              let next = parseInt(value, 10);
              if (!Number.isFinite(next) || next < 1) next = 1;
              item.required = next;
            };

            const orders = computed(() => {
              return currentUser.value.orders || [];
            });

            const orderNeedMap = computed(() => {
              const needs = new Map();
              orders.value.forEach((order) => {
                if (!order || !Array.isArray(order.items)) return;
                order.items.forEach((item) => {
                  const resolvedId = normalizeMushroomId(item.id || "");
                  if (!resolvedId) return;
                  const required = Math.max(
                    1,
                    parseInt(item.required, 10) || 1
                  );
                  needs.set(
                    resolvedId,
                    (needs.get(resolvedId) || 0) + required
                  );
                });
              });
              return needs;
            });

            const getOrderRequiredTotal = (id) => {
              const resolvedId = normalizeMushroomId(id);
              return orderNeedMap.value.get(resolvedId) || 0;
            };

            const isOrderItemMet = (id, required) => {
              const need = Math.max(1, parseInt(required, 10) || 0);
              if (need <= 0) return false;
              return getOrderCount(id) >= need;
            };

            const orderTargets = computed(() => {
              const targets = [];
              orderNeedMap.value.forEach((required, id) => {
                const item = getOrderItem(id);
                if (isOrderItemMet(id, required)) return;
                targets.push({ ...item, id, required });
              });
              return targets;
            });

            const orderCandidates = computed(() => {
              const rawQuery = orderQuery.value.trim();
              if (!rawQuery) return [];
              const normalizedQuery = normalizeSearchValue(rawQuery);
              const selected = new Set(
                orderDraft.items.map((item) => normalizeMushroomId(item.id))
              );
              return database
                .filter((m) => !m.isFailed)
                .filter((m) => !selected.has(m.id))
                .filter((m) => matchesOrderSearch(m, rawQuery, normalizedQuery))
                .slice(0, 12);
            });
            const normalizeOrderCategory = (value) => {
              const raw = (value || "").trim();
              return raw && raw !== "/" ? raw : "未分类";
            };
            const stripOrderCategorySuffix = (name, category) => {
              const trimmed = (name || "").trim();
              const cat = (category || "").trim();
              if (cat && trimmed.endsWith(cat)) {
                return trimmed.slice(0, trimmed.length - cat.length);
              }
              return trimmed;
            };
            const orderPrefixRankMap = new Map([
              ["超小", 0],
              ["小小", 0],
              ["纤小", 0],
              ["小", 0],
              ["微小", 0],
              ["迷你", 0],
              ["袖珍", 0],
              ["小巧", 0],
              ["缩水", 0],
              ["小只", 0],
              ["微型", 0],
              ["清淡", 0],
              ["小号", 0],
              ["常见", 1],
              ["常规", 1],
              ["普通", 1],
              ["寻常", 1],
              ["适中", 1],
              ["中号", 1],
              ["中等", 1],
              ["中", 1],
              ["中级", 1],
              ["一般", 1],
              ["平凡", 1],
              ["路边", 1],
              ["中庸", 1],
              ["大号", 2],
              ["超大", 2],
              ["庞大", 2],
              ["硕大", 2],
              ["巨大", 2],
              ["巨巨", 2],
              ["特大", 2],
              ["大", 2],
              ["巨型", 2],
              ["巨体", 2],
              ["超级", 2],
              ["浓厚", 2],
              ["膨胀", 2],
            ]);
            const orderPrefixSmallKeywords = [
              "超小",
              "小小",
              "纤小",
              "迷你",
              "袖珍",
              "小巧",
              "缩水",
              "小只",
              "微小",
              "微型",
              "小",
              "清淡",
            ];
            const orderPrefixLargeKeywords = [
              "超大",
              "庞大",
              "硕大",
              "巨大",
              "巨巨",
              "特大",
              "巨型",
              "巨体",
              "超级",
              "浓厚",
              "膨胀",
              "大",
              "巨",
            ];
            const getOrderPrefixRank = (prefix) => {
              const trimmed = (prefix || "").trim();
              if (!trimmed) return 1;
              if (orderPrefixRankMap.has(trimmed)) {
                return orderPrefixRankMap.get(trimmed);
              }
              if (
                orderPrefixSmallKeywords.some((keyword) =>
                  trimmed.includes(keyword)
                )
              ) {
                return 0;
              }
              if (
                orderPrefixLargeKeywords.some((keyword) =>
                  trimmed.includes(keyword)
                )
              ) {
                return 2;
              }
              return 1;
            };
            const orderPrefixTokens = Array.from(
              new Set([
                ...orderPrefixRankMap.keys(),
                "超小型",
                "超大型",
                "小型",
                "大型",
                "小号",
                "中号",
                "大号",
                "标准",
                "通常",
              ])
            ).sort((a, b) => b.length - a.length);
            const getOrderFeatureFromPrefix = (core) => {
              const trimmed = (core || "").trim();
              if (!trimmed) return "";
              for (const token of orderPrefixTokens) {
                if (
                  trimmed.startsWith(token) &&
                  trimmed.length > token.length
                ) {
                  return trimmed.slice(token.length);
                }
              }
              return "";
            };

            const buildCategoryGroups = (options = {}) => {
              const excludeIds = options.excludeIds || new Set();
              const filterFn = options.filterFn;
              const includeFailed = options.includeFailed === true;
              const moveFailedToEnd = options.moveFailedToEnd === true;
              const source = includeFailed
                ? database
                : database.filter((m) => !m.isFailed);
              const categoryOrder = [];
              const allCategoryItems = new Map();
              const coreById = new Map();
              const indexById = new Map();
              source.forEach((m) => {
                const category = normalizeOrderCategory(m.category);
                if (!allCategoryItems.has(category)) {
                  allCategoryItems.set(category, []);
                  categoryOrder.push(category);
                }
                const list = allCategoryItems.get(category);
                list.push(m);
                indexById.set(m.id, list.length - 1);
                coreById.set(m.id, stripOrderCategorySuffix(m.name, category));
              });
              const suffixFeatureById = new Map();
              allCategoryItems.forEach((items) => {
                const cores = items.map((m) => coreById.get(m.id) || "");
                const suffixCount = new Map();
                cores.forEach((core) => {
                  const base = core || "";
                  for (let len = 2; len <= base.length; len += 1) {
                    const suffix = base.slice(base.length - len);
                    suffixCount.set(suffix, (suffixCount.get(suffix) || 0) + 1);
                  }
                });
                items.forEach((m, idx) => {
                  const core = cores[idx] || "";
                  let best = core;
                  let bestLen = 0;
                  for (let len = 2; len <= core.length; len += 1) {
                    const suffix = core.slice(core.length - len);
                    if ((suffixCount.get(suffix) || 0) >= 2 && len > bestLen) {
                      best = suffix;
                      bestLen = len;
                    }
                  }
                  suffixFeatureById.set(m.id, best);
                });
              });
              const featureKeyById = new Map();
              allCategoryItems.forEach((items) => {
                items.forEach((m) => {
                  const core = coreById.get(m.id) || "";
                  const explicit = getOrderFeatureFromPrefix(core);
                  const key = explicit || suffixFeatureById.get(m.id) || core;
                  featureKeyById.set(m.id, key);
                });
              });
              const prefixRankById = new Map();
              allCategoryItems.forEach((items) => {
                items.forEach((m) => {
                  const core = coreById.get(m.id) || "";
                  const feature = featureKeyById.get(m.id) || "";
                  const prefix =
                    feature && core.endsWith(feature)
                      ? core.slice(0, core.length - feature.length)
                      : core;
                  prefixRankById.set(m.id, getOrderPrefixRank(prefix));
                });
              });
              const groups = [];
              categoryOrder.forEach((category) => {
                const items = allCategoryItems.get(category) || [];
                const filtered = items.filter((m) => {
                  if (excludeIds.has(m.id)) return false;
                  if (filterFn && !filterFn(m)) return false;
                  return true;
                });
                if (!filtered.length) return;
                const featureGroups = new Map();
                filtered.forEach((m) => {
                  const key = featureKeyById.get(m.id) || "";
                  if (!featureGroups.has(key)) featureGroups.set(key, []);
                  featureGroups.get(key).push(m);
                });
                const ordered = [];
                featureGroups.forEach((groupItems) => {
                  const sorted = [...groupItems].sort((a, b) => {
                    const rankA = prefixRankById.get(a.id) ?? 1;
                    const rankB = prefixRankById.get(b.id) ?? 1;
                    if (rankA !== rankB) return rankA - rankB;
                    const idxA = indexById.get(a.id) ?? 0;
                    const idxB = indexById.get(b.id) ?? 0;
                    return idxA - idxB;
                  });
                  ordered.push(...sorted);
                });
                const isFailedItem = (item) =>
                  item.isFailed ||
                  (item.name || "").trim().startsWith("未能长大的");
                if (moveFailedToEnd) {
                  const normalItems = [];
                  const failedItems = [];
                  ordered.forEach((item) => {
                    if (isFailedItem(item)) failedItems.push(item);
                    else normalItems.push(item);
                  });
                  groups.push({
                    category,
                    items: [...normalItems, ...failedItems],
                  });
                } else {
                  groups.push({ category, items: ordered });
                }
              });
              return groups;
            };
            const orderCategoryGroups = computed(() => {
              const selected = new Set(
                orderDraft.items.map((item) => normalizeMushroomId(item.id))
              );
              return buildCategoryGroups({ excludeIds: selected });
            });
            const handbookCategoryGroups = computed(() => {
              const collectedSet = new Set(currentUser.value.collected || []);
              const filterFn = showOnlyUncollected.value
                ? (m) => !collectedSet.has(m.id)
                : null;
              return buildCategoryGroups({
                filterFn,
                includeFailed: true,
                moveFailedToEnd: true,
              });
            });
            const orderActiveCategory = computed(() => {
              const groups = orderCategoryGroups.value;
              if (groups.length === 0) return { category: "", items: [] };
              const active = groups.find(
                (group) => group.category === orderPickerCategory.value
              );
              return active || groups[0];
            });
            const setOrderPickerCategory = (category) => {
              orderPickerCategory.value = category;
            };
            const handbookActiveCategory = computed(() => {
              const groups = handbookCategoryGroups.value;
              if (groups.length === 0) return { category: "", items: [] };
              const active = groups.find(
                (group) => group.category === handbookPickerCategory.value
              );
              return active || groups[0];
            });
            const setHandbookPickerCategory = (category) => {
              handbookPickerCategory.value = category;
            };
            const markHandbookCollected = (id) => {
              toggleCollected(id);
            };

            const setOrderPreset = (preset) => {
              orderDraft.name = preset;
            };

            const addOrderItem = (id) => {
              const resolvedId = normalizeMushroomId(id);
              if (!resolvedId) return;
              if (
                orderDraft.items.some(
                  (item) => normalizeMushroomId(item.id) === resolvedId
                )
              ) {
                return;
              }
              orderDraft.items.push({ id: resolvedId, required: 1 });
              ensureOrderInventory();
              orderQuery.value = "";
            };

            const removeOrderItem = (id) => {
              const resolvedId = normalizeMushroomId(id);
              const idx = orderDraft.items.findIndex(
                (item) => normalizeMushroomId(item.id) === resolvedId
              );
              if (idx > -1) orderDraft.items.splice(idx, 1);
            };

            const isEditingOrder = computed(() => {
              return !!orderDraft.id;
            });

            const resetOrderDraft = () => {
              orderDraft.id = "";
              orderDraft.name = "";
              orderDraft.reward = 0;
              orderDraft.items = [];
              orderQuery.value = "";
              orderPickerVisible.value = false;
              orderPickerCategory.value = "";
            };

            const startNewOrder = () => {
              resetOrderDraft();
              orderFormVisible.value = true;
            };

            const toggleOrderListCollapse = () => {
              orderListCollapsed.value = !orderListCollapsed.value;
            };

            const closeOrderForm = () => {
              resetOrderDraft();
              orderFormVisible.value = false;
            };

            const saveOrder = () => {
              const normalizedName = (orderDraft.name || "").trim();
              const reward = Math.max(0, parseInt(orderDraft.reward, 10) || 0);
              const uniqueItems = [];
              const seen = new Set();
              orderDraft.items.forEach((item) => {
                const resolvedId = normalizeMushroomId(item.id);
                if (!resolvedId || seen.has(resolvedId)) return;
                const required = Math.max(1, parseInt(item.required, 10) || 1);
                uniqueItems.push({ id: resolvedId, required });
                seen.add(resolvedId);
                const inv = ensureOrderInventory();
                if (inv[resolvedId] === undefined) inv[resolvedId] = 0;
              });

              if (uniqueItems.length === 0) return;

              const list = ensureOrderList();
              const payload = {
                id: orderDraft.id || generateOrderId(),
                name: normalizedName,
                reward,
                items: uniqueItems,
              };

              if (orderDraft.id) {
                const idx = list.findIndex(
                  (order) => order.id === orderDraft.id
                );
                if (idx > -1) list.splice(idx, 1, payload);
                else list.push(payload);
              } else {
                list.push(payload);
              }

              closeOrderForm();
            };

            const editOrder = (order) => {
              if (!order) return;
              orderDraft.id = order.id;
              orderDraft.name = order.name || "";
              orderDraft.reward = Math.max(0, parseInt(order.reward, 10) || 0);
              const items = (order.items || []).map((item) => ({
                id: normalizeMushroomId(item.id),
                required: Math.max(1, parseInt(item.required, 10) || 1),
              }));
              orderDraft.items = items;
              orderQuery.value = "";
              orderFormVisible.value = true;
              nextTick(() => scrollToOrderPanel());
            };

            const cancelOrderEdit = () => {
              closeOrderForm();
            };

            const deleteOrder = (order) => {
              if (!order) return;
              const list = ensureOrderList();
              const idx = list.findIndex((item) => item.id === order.id);
              if (idx === -1) return;
              list.splice(idx, 1);
              const record = buildOrderRecord(order, "delete");
              ensureOrderHistory().push(record);
              setPanelNotice({
                type: "order",
                record,
                message: `已删除订单：${formatOrderName(order.name)}`,
              });
              if (orderDraft.id && orderDraft.id === order.id) {
                closeOrderForm();
              }
            };

            const isOrderReady = (order) => {
              if (
                !order ||
                !Array.isArray(order.items) ||
                order.items.length === 0
              )
                return false;
              return order.items.every((item) => {
                const required = Math.max(1, parseInt(item.required, 10) || 1);
                return getOrderCount(item.id) >= required;
              });
            };

            const readyOrders = computed(() => {
              return orders.value.filter((order) => isOrderReady(order));
            });

            const readyOrderMessage = computed(() => {
              const count = readyOrders.value.length;
              if (count <= 0) {
                const currentCount =
                  currentTime.value === "白天"
                    ? unlockableByTime.value.day
                    : unlockableByTime.value.night;
                return `${currentTime.value}还可解锁 ${currentCount} 种菌子，继续种植吧`;
              }
              if (count === 1)
                return "已有 1 单可交付，游戏内交货后记得也在网页上点点交付。点击可直达⬆️";
              return `已有 ${count} 单可交付，游戏内交货后记得也在网页上点点交付。点击可直达⬆️`;
            });

            const triggerOrderFloatPulse = () => {
              orderFloatPulse.value = true;
              if (orderFloatTimer) clearTimeout(orderFloatTimer);
              orderFloatTimer = setTimeout(() => {
                orderFloatPulse.value = false;
              }, 1200);
            };

            const readyOrderKey = computed(() =>
              readyOrders.value.map((order) => order.id).join("|")
            );

            watch(readyOrderKey, (next, prev) => {
              if (!next) return;
              if (next !== prev) triggerOrderFloatPulse();
            });

            const focusOrderCard = (order) => {
              if (!order) return;
              if (currentTab.value !== "rec" && currentTab.value !== "order") {
                currentTab.value = "order";
              }
              orderListCollapsed.value = false;
              nextTick(() => {
                const el = document.getElementById(`order-card-${order.id}`);
                if (el) {
                  el.scrollIntoView({ behavior: "smooth", block: "center" });
                }
                focusOrderId.value = order.id;
                if (focusTimer) clearTimeout(focusTimer);
                focusTimer = setTimeout(() => {
                  if (focusOrderId.value === order.id) {
                    focusOrderId.value = "";
                  }
                }, 1400);
              });
            };

            const buildOrderRecord = (order, action) => {
              return {
                id: order.id || generateOrderId(),
                name: order.name || "",
                reward: getOrderReward(order),
                action,
                items: (order.items || []).map((item) => ({
                  id: normalizeMushroomId(item.id),
                  required: Math.max(1, parseInt(item.required, 10) || 1),
                })),
                timestamp: Date.now(),
              };
            };

            const deliverOrder = (order) => {
              if (!order || !isOrderReady(order)) return;
              const list = ensureOrderList();
              const idx = list.findIndex((item) => item.id === order.id);
              if (idx > -1) list.splice(idx, 1);

              order.items.forEach((item) => {
                const resolvedId = normalizeMushroomId(item.id);
                if (!resolvedId) return;
                const required = Math.max(1, parseInt(item.required, 10) || 1);
                const current = getOrderCount(resolvedId);
                setOrderCount(resolvedId, Math.max(0, current - required));
              });

              const record = buildOrderRecord(order, "deliver");
              ensureOrderHistory().push(record);
              setPanelNotice({
                type: "order",
                record,
                message: `已交付【${formatOrderName(order.name)}】`,
              });
            };

            const formatOrderRecord = (record) => {
              if (!record || !Array.isArray(record.items)) return "";
              const action = record.action || "deliver";
              if (action === "increment") {
                return "库存 +1";
              }
              const reward = Math.max(0, parseInt(record.reward, 10) || 0);
              const actionLabel = action === "delete" ? "删除" : "交付";
              const detail = record.items
                .map((item) => {
                  const name = getOrderItemName(item.id);
                  const required = Math.max(
                    1,
                    parseInt(item.required, 10) || 1
                  );
                  return `${name} x${required}`;
                })
                .join(" / ");
              return `${actionLabel}: ${detail} | 报酬 ${reward}`;
            };

            const getOrderRecordTitle = (record) => {
              if (!record) return "";
              if (record.action === "increment") {
                const itemId =
                  record.items && record.items[0] && record.items[0].id;
                const itemName = getOrderItemName(itemId);
                return itemName || "库存 +1";
              }
              return formatOrderName(record.name);
            };

            const getOrderRecordActionLabel = (record) => {
              const action = (record && record.action) || "deliver";
              if (action === "delete") return "撤销删除";
              if (action === "increment") return "撤销 +1";
              return "撤销交付";
            };

            const revokeOrderRecord = (record) => {
              if (!record) return;
              const action = record.action || "deliver";
              if (action === "increment") {
                const item = record.items && record.items[0];
                if (item) {
                  const resolvedId = normalizeMushroomId(item.id);
                  if (resolvedId) {
                    const delta = Math.max(1, parseInt(item.required, 10) || 1);
                    const current = getOrderCount(resolvedId);
                    setOrderCount(resolvedId, Math.max(0, current - delta));
                  }
                }
                currentUser.value.orderHistory = (
                  currentUser.value.orderHistory || []
                ).filter((item) => item.timestamp !== record.timestamp);
                return;
              }
              const list = ensureOrderList();
              const restored = {
                id: record.id || generateOrderId(),
                name: record.name || "",
                items: (record.items || []).map((item) => ({
                  id: normalizeMushroomId(item.id),
                  required: Math.max(1, parseInt(item.required, 10) || 1),
                })),
              };

              if (action !== "delete") {
                restored.items.forEach((item) => {
                  const resolvedId = normalizeMushroomId(item.id);
                  if (!resolvedId) return;
                  const required = Math.max(
                    1,
                    parseInt(item.required, 10) || 1
                  );
                  const current = getOrderCount(resolvedId);
                  setOrderCount(resolvedId, current + required);
                });
              }

              if (!list.some((order) => order.id === restored.id)) {
                list.push(restored);
              } else {
                restored.id = generateOrderId();
                list.push(restored);
              }

              currentUser.value.orderHistory = (
                currentUser.value.orderHistory || []
              ).filter((item) => item.timestamp !== record.timestamp);
            };

            const buildPlanKey = (rec) => {
              return `${rec.branch}|${rec.lamp}|${rec.waterer}`;
            };

            const isPlanPinned = (rec) => {
              if (!rec) return false;
              return !!pinnedPlans[buildPlanKey(rec)];
            };

            const pinPlan = (rec) => {
              if (!rec) return;
              const key = buildPlanKey(rec);
              if (!pinnedPlans[key]) {
                pinnedPlans[key] = true;
                pinnedOrder.value.push(key);
                nextTick(() => scrollToRecTop());
                return true;
              }
              return false;
            };

            const unpinPlan = (rec) => {
              if (!rec) return;
              const key = buildPlanKey(rec);
              if (pinnedPlans[key]) {
                delete pinnedPlans[key];
                pinnedOrder.value = pinnedOrder.value.filter(
                  (item) => item !== key
                );
              }
            };

            const togglePinPlan = (rec) => {
              if (isPlanPinned(rec)) {
                unpinPlan(rec);
              } else {
                pinPlan(rec);
              }
            };

            const showToast = (message) => {
              toastMessage.value = message;
              toastVisible.value = true;
              if (toastTimer) clearTimeout(toastTimer);
              toastTimer = setTimeout(() => {
                toastVisible.value = false;
              }, 1600);
            };

            const setPanelNotice = (notice) => {
              panelNotice.value = notice;
              if (panelNoticeTimer) clearTimeout(panelNoticeTimer);
              panelNoticeTimer = setTimeout(() => {
                panelNotice.value = null;
              }, 6000);
            };

            const undoPanelNotice = () => {
              const notice = panelNotice.value;
              if (!notice) return;
              if (panelNoticeTimer) clearTimeout(panelNoticeTimer);
              panelNotice.value = null;
              if (notice.type === "collect") {
                revokeHistoryItem(notice.record);
              } else if (notice.type === "order") {
                revokeOrderRecord(notice.record);
              }
            };

            const buildExportPayload = () => {
              return {
                version: 1,
                exportedAt: new Date().toISOString(),
                users: users.value,
                currentUserIndex: currentUserIndex.value,
                currentTime: currentTime.value,
              };
            };

            const exportUserData = () => {
              const payload = buildExportPayload();
              const json = JSON.stringify(payload, null, 2);
              const blob = new Blob([json], { type: "application/json" });
              const url = URL.createObjectURL(blob);
              const link = document.createElement("a");
              const dateTag = new Date().toISOString().slice(0, 10);
              link.href = url;
              link.download = `mushroom_users_${dateTag}.json`;
              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
              URL.revokeObjectURL(url);
              showToast("已导出用户数据");
            };

            const triggerImport = () => {
              if (importInput.value) {
                importInput.value.click();
              }
            };

            const applyImportedData = (payload) => {
              let importedUsers = [];
              let importedIndex = 0;
              let importedTime = currentTime.value;

              if (Array.isArray(payload)) {
                importedUsers = payload;
              } else if (payload && Array.isArray(payload.users)) {
                importedUsers = payload.users;
                const indexValue = Number(payload.currentUserIndex);
                if (!Number.isNaN(indexValue)) importedIndex = indexValue;
                if (payload.currentTime) importedTime = payload.currentTime;
              }

              if (importedUsers.length === 0) {
                throw new Error("empty import");
              }

              const migrated = migrateUserData(importedUsers);
              users.value = migrated;
              if (Number.isFinite(importedIndex)) {
                currentUserIndex.value = Math.min(
                  Math.max(importedIndex, 0),
                  migrated.length - 1
                );
              } else {
                currentUserIndex.value = 0;
              }
              if (importedTime === "白天" || importedTime === "黑夜") {
                currentTime.value = importedTime;
              }
            };

            const handleImportFile = (event) => {
              const file = event.target.files && event.target.files[0];
              if (!file) return;

              const reader = new FileReader();
              reader.onload = () => {
                try {
                  const payload = JSON.parse(reader.result);
                  applyImportedData(payload);
                  showToast("已导入用户数据");
                } catch (error) {
                  console.error("Import failed:", error);
                  showToast("导入失败，请检查文件");
                } finally {
                  event.target.value = "";
                }
              };
              reader.readAsText(file);
            };

            const getAllOptions = (key, orderList) => {
              const set = new Set(
                database.map((i) => i[key]).filter((v) => v !== "/")
              );
              const values = Array.from(set);
              if (!orderList || orderList.length === 0) {
                return values.sort();
              }
              const orderSet = new Set(orderList);
              const ordered = orderList.filter((name) => set.has(name));
              const remaining = values
                .filter((name) => !orderSet.has(name))
                .sort();
              return [...ordered, ...remaining];
            };

            const allBranches = getAllOptions("branch", BRANCH_ORDER);
            const allLamps = getAllOptions("lamp");
            const allWaterers = getAllOptions("waterer");
            const categoryOrder = getAllOptions("category");

            const createCodebook = (list, includeAny) => {
              const entries = includeAny ? ["/", ...list] : [...list];
              const indexMap = new Map(
                entries.map((value, idx) => [value, idx.toString(36)])
              );
              return { list: entries, map: indexMap };
            };

            const branchCodebook = createCodebook(allBranches, true);
            const lampCodebook = createCodebook(allLamps, true);
            const watererCodebook = createCodebook(allWaterers, true);
            const categoryCodebook = createCodebook(categoryOrder, false);

            const encodeList = (items, map) => {
              if (!items || items.length === 0) return "";
              const codes = items
                .map((item) => map.get(item))
                .filter((value) => value !== undefined);
              codes.sort((a, b) => parseInt(a, 36) - parseInt(b, 36));
              return codes.join(".");
            };

            const decodeList = (value, list) => {
              if (!value) return [];
              return value
                .split(".")
                .filter(Boolean)
                .map((token) => {
                  const idx = parseInt(token, 36);
                  return Number.isNaN(idx) ? null : list[idx];
                })
                .filter(Boolean);
            };

            const encodeTimeValue = (timeValue) => {
              if (!timeValue || timeValue === "/") return "a";
              if (timeValue.includes("白天") && timeValue.includes("黑夜"))
                return "b";
              if (timeValue === "白天") return "d";
              if (timeValue === "黑夜") return "n";
              return "a";
            };

            const decodeTimeValue = (code) => {
              if (code === "d") return "白天";
              if (code === "n") return "黑夜";
              if (code === "b") return "白天/黑夜";
              return "/";
            };

            // 数据迁移函数
            const migrateUserData = (parsedUsers) => {
              let hasChanges = false;

              parsedUsers.forEach((user) => {
                if (!user.inventory)
                  user.inventory = { branches: [], lamps: [], waterers: [] };
                if (!Array.isArray(user.collected)) user.collected = [];
                if (!Array.isArray(user.pending)) user.pending = [];
                if (!Array.isArray(user.orders)) user.orders = [];
                if (
                  !user.orderInventory ||
                  typeof user.orderInventory !== "object"
                ) {
                  user.orderInventory = {};
                }
                if (!Array.isArray(user.orderHistory)) user.orderHistory = [];
                if (!Array.isArray(user.tasks)) user.tasks = [];
                if (!Array.isArray(user.history)) user.history = [];

                const newCollected = new Set();
                user.collected.forEach((entry) => {
                  const resolvedId = resolveMushroomId(entry);
                  if (resolvedId) {
                    newCollected.add(resolvedId);
                    if (resolvedId !== entry) hasChanges = true;
                  } else {
                    newCollected.add(entry);
                  }
                });

                if (
                  user.collected.length !== newCollected.size ||
                  [...newCollected].some((n, i) => n !== user.collected[i])
                ) {
                  user.collected = Array.from(newCollected);
                  hasChanges = true;
                }

                const newPending = new Set();
                user.pending.forEach((entry) => {
                  const resolvedId = resolveMushroomId(entry);
                  const candidate = resolvedId || entry;
                  if (!newCollected.has(candidate)) {
                    newPending.add(candidate);
                  }
                  if (resolvedId && resolvedId !== entry) hasChanges = true;
                });

                if (
                  user.pending.length !== newPending.size ||
                  [...newPending].some((n, i) => n !== user.pending[i])
                ) {
                  user.pending = Array.from(newPending);
                  hasChanges = true;
                }

                const normalizeOrderItems = (items) => {
                  const normalized = [];
                  const seen = new Set();
                  (items || []).forEach((item) => {
                    const rawId =
                      typeof item === "string" ? item : item.id || "";
                    const resolvedId = resolveMushroomId(rawId);
                    if (!resolvedId || seen.has(resolvedId)) return;
                    const required =
                      typeof item === "string"
                        ? 1
                        : Math.max(1, parseInt(item.required, 10) || 1);
                    normalized.push({ id: resolvedId, required });
                    seen.add(resolvedId);
                  });
                  return normalized;
                };

                if (user.tasks.length > 0) {
                  user.tasks = [];
                  hasChanges = true;
                }

                user.orders = user.orders
                  .map((order) => {
                    if (!order) return null;
                    const id = order.id || generateOrderId();
                    const name = order.name || "";
                    const reward = Math.max(0, parseInt(order.reward, 10) || 0);
                    const items = normalizeOrderItems(order.items || []);
                    if (items.length === 0) return null;
                    items.forEach((item) => {
                      if (user.orderInventory[item.id] === undefined) {
                        user.orderInventory[item.id] = 0;
                      }
                    });
                    if (
                      id !== order.id ||
                      items.length !== (order.items || []).length ||
                      reward !== (parseInt(order.reward, 10) || 0)
                    ) {
                      hasChanges = true;
                    }
                    return { id, name, reward, items };
                  })
                  .filter(Boolean);

                user.orderHistory = (user.orderHistory || []).map((record) => {
                  if (!record) return record;
                  const items = normalizeOrderItems(record.items || []);
                  const id = record.id || generateOrderId();
                  const name = record.name || "";
                  const reward = Math.max(0, parseInt(record.reward, 10) || 0);
                  const timestamp = record.timestamp || Date.now();
                  const action = record.action || "deliver";
                  const source = record.source || "";
                  if (
                    id !== record.id ||
                    name !== record.name ||
                    items.length !== (record.items || []).length ||
                    reward !== (parseInt(record.reward, 10) || 0) ||
                    timestamp !== record.timestamp ||
                    action !== record.action ||
                    source !== record.source
                  ) {
                    hasChanges = true;
                  }
                  return { id, name, reward, items, timestamp, action, source };
                });

                user.history = user.history.map((log) => {
                  if (!log) return log;
                  if (typeof log === "string") {
                    log = { name: log, timestamp: Date.now() };
                    hasChanges = true;
                  }

                  const logName = log.name || "";
                  const correctedName = NAME_MAPPING[logName] || logName;
                  const resolvedId =
                    log.id && idSet.has(log.id)
                      ? log.id
                      : nameToId.get(correctedName);

                  if (resolvedId && resolvedId !== log.id) {
                    log.id = resolvedId;
                    hasChanges = true;
                  }
                  if (logName && correctedName !== logName) {
                    log.name = correctedName;
                    hasChanges = true;
                  }
                  return log;
                });
              });

              return parsedUsers;
            };

            onMounted(() => {
              const storedUsers = localStorage.getItem("mushroom_users");
              if (storedUsers) {
                let parsedUsers = JSON.parse(storedUsers);

                // 1. 结构补全
                parsedUsers.forEach((u) => {
                  if (!u.history) u.history = [];
                  if (!u.pending) u.pending = [];
                  if (!u.orders) u.orders = [];
                  if (!u.orderInventory) u.orderInventory = {};
                  if (!u.orderHistory) u.orderHistory = [];
                  if (!u.tasks) u.tasks = [];
                });

                // 2. 执行数据迁移
                parsedUsers = migrateUserData(parsedUsers);

                users.value = parsedUsers;
              } else {
                users.value = [
                  {
                    name: "默认用户",
                    inventory: { branches: [], lamps: [], waterers: [] },
                    collected: [],
                    pending: [],
                    orders: [],
                    orderInventory: {},
                    orderHistory: [],
                    history: [],
                  },
                ];
              }

              const savedIndex = localStorage.getItem("mushroom_current_user");
              if (savedIndex !== null) {
                const idx = parseInt(savedIndex);
                if (idx >= 0 && idx < users.value.length) {
                  currentUserIndex.value = idx;
                }
              }
            });

            watch(
              users,
              (newVal) => {
                localStorage.setItem("mushroom_users", JSON.stringify(newVal));
              },
              { deep: true }
            );

            watch(currentUserIndex, (newVal) => {
              localStorage.setItem("mushroom_current_user", newVal);
            });

            watch(currentTime, (newVal) => {
              localStorage.setItem("mushroom_current_time", newVal);
            });

            watch(currentTab, (newVal) => {
              localStorage.setItem("mushroom_current_tab", newVal);
            });

            watch(orderListCollapsed, (newVal) => {
              localStorage.setItem(
                "mushroom_order_list_collapsed",
                newVal ? "true" : "false"
              );
            });

            watch(orderFloatCollapsed, (newVal) => {
              localStorage.setItem(
                "mushroom_order_float_collapsed",
                newVal ? "true" : "false"
              );
            });

            watch(
              pinnedOrder,
              (newVal) => {
                localStorage.setItem(
                  "mushroom_pinned_plans",
                  JSON.stringify(newVal)
                );
              },
              { deep: true }
            );

            watch(showOrderHints, (newVal) => {
              localStorage.setItem(
                "mushroom_order_hints",
                newVal ? "true" : "false"
              );
              if (!newVal) orderAffectsRanking.value = false;
            });

            watch(orderAffectsRanking, (newVal) => {
              localStorage.setItem(
                "mushroom_order_rank",
                newVal ? "true" : "false"
              );
            });
            watch(
              orderCategoryGroups,
              (groups) => {
                if (!groups.length) {
                  orderPickerCategory.value = "";
                  return;
                }
                const hasActive = groups.some(
                  (group) => group.category === orderPickerCategory.value
                );
                if (!hasActive) {
                  orderPickerCategory.value = groups[0].category;
                }
              },
              { immediate: true }
            );
            watch(
              handbookCategoryGroups,
              (groups) => {
                if (!groups.length) {
                  handbookPickerCategory.value = "";
                  return;
                }
                const hasActive = groups.some(
                  (group) => group.category === handbookPickerCategory.value
                );
                if (!hasActive) {
                  handbookPickerCategory.value = groups[0].category;
                }
              },
              { immediate: true }
            );

            const addUser = () => {
              const name = prompt("请输入新用户名:");
              if (name) {
                users.value.push({
                  name: name,
                  inventory: { branches: [], lamps: [], waterers: [] },
                  collected: [],
                  pending: [],
                  orders: [],
                  orderInventory: {},
                  orderHistory: [],
                  history: [],
                });
                currentUserIndex.value = users.value.length - 1;
              }
            };

            const deleteUser = () => {
              if (
                confirm(
                  `确定要删除用户 "${currentUser.value.name}" 吗？此操作无法撤销。`
                )
              ) {
                users.value.splice(currentUserIndex.value, 1);
                currentUserIndex.value = 0;
              }
            };

            const toggleInventory = (type, item) => {
              const list = currentUser.value.inventory[type];
              const idx = list.indexOf(item);
              if (idx > -1) list.splice(idx, 1);
              else list.push(item);
            };

            const toggleCollected = (id) => {
              const list = currentUser.value.collected;
              const resolvedId = normalizeMushroomId(id);
              const pending = ensurePendingList();
              const pendingIdx = pending.indexOf(resolvedId);
              if (pendingIdx > -1) {
                pending.splice(pendingIdx, 1);
                if (!list.includes(resolvedId)) {
                  list.push(resolvedId);
                }
                return;
              }
              const idx = list.indexOf(resolvedId);
              if (idx > -1) list.splice(idx, 1);
              else list.push(resolvedId);
            };

            const handleCollectionClick = (id, rec) => {
              if (rec) {
                const didPin = pinPlan(rec);
                if (didPin) {
                  showToast("已自动置顶方案");
                }
              }
              const resolvedId = normalizeMushroomId(id);
              if (currentUser.value.collected.includes(resolvedId)) return;
              if (isPendingHarvest(resolvedId)) {
                cancelHarvest(resolvedId);
                return;
              }
              markPendingHarvest(resolvedId);
            };

            const revokeHistoryItem = (logItem) => {
              const resolvedId =
                (logItem.id && idSet.has(logItem.id) && logItem.id) ||
                resolveMushroomId(logItem.name || "");
              if (resolvedId) {
                const colIdx = currentUser.value.collected.indexOf(resolvedId);
                if (colIdx > -1) {
                  currentUser.value.collected.splice(colIdx, 1);
                }
              }
              currentUser.value.history = currentUser.value.history.filter(
                (h) => h.timestamp !== logItem.timestamp
              );
            };

            const handleImgError = (e) => {
              e.target.style.display = "none";
              const span = document.createElement("span");
              span.className = "target-placeholder";
              span.textContent = "?";
              e.target.parentNode.appendChild(span);
            };

            const getMushroomImgSrc = (category, condition) => {
              let suffix = "_0";
              if (condition === "滋补汤") suffix = "_1";
              else if (condition === "消食片") suffix = "_2";
              else if (condition === "未杀虫") suffix = "_3";
              return `./assets/categories/${category}${suffix}.png`;
            };

            const getOrderTargetImgSrc = (name) => {
              const trimmed = (name || "").trim();
              if (!trimmed) return "";
              return `./assets/handbook/${trimmed}.png`;
            };

            const getBadgeClass = (condition) => {
              if (condition === "滋补汤") return "badge-soup";
              if (condition === "消食片") return "badge-tablet";
              if (condition === "未杀虫") return "badge-insect";
              return "badge-normal";
            };

            const isMushroomObtainable = (m) => {
              const inv = currentUser.value.inventory;
              if (m.branch !== "/" && !inv.branches.includes(m.branch))
                return false;
              if (m.lamp !== "/" && !inv.lamps.includes(m.lamp)) return false;
              if (m.waterer !== "/" && !inv.waterers.includes(m.waterer))
                return false;
              return true;
            };

            const isMushroomInTime = (m, timeLabel) => {
              const timeValue = (m.time || "").trim();
              if (!timeValue || timeValue === "/") return true;
              if (timeValue === timeLabel) return true;
              return timeValue.includes(timeLabel);
            };

            const unlockableCount = computed(() => {
              const collectedSet = new Set(currentUser.value.collected || []);
              return database.filter((m) => {
                if (!m || !m.id) return false;
                if (collectedSet.has(m.id)) return false;
                return isMushroomObtainable(m);
              }).length;
            });

            const unlockableByTime = computed(() => {
              const collectedSet = new Set(currentUser.value.collected || []);
              const countFor = (timeLabel) =>
                database.filter((m) => {
                  if (!m || !m.id) return false;
                  if (collectedSet.has(m.id)) return false;
                  if (!isMushroomObtainable(m)) return false;
                  return isMushroomInTime(m, timeLabel);
                }).length;
              return {
                day: countFor("白天"),
                night: countFor("黑夜"),
              };
            });

            const formatTime = (ts) => {
              return new Date(ts).toLocaleString();
            };

            const buildPlanSummary = (rec) => {
              const soup = new Set();
              const tablet = new Set();
              const insect = new Set();
              const normal = new Set();

              rec.mushrooms.forEach((m) => {
                if (m.condition === "滋补汤") soup.add(m.category);
                else if (m.condition === "消食片") tablet.add(m.category);
                else if (m.condition === "未杀虫") insect.add(m.category);
                else normal.add(m.category);
              });

              const timeSet = new Set(
                rec.mushrooms.map((m) => m.time).filter((t) => t !== "/")
              );
              let timeValue = "/";
              if (timeSet.size === 1) {
                timeValue = Array.from(timeSet)[0];
              } else if (timeSet.size > 1) {
                timeValue = Array.from(timeSet).sort().join("/");
              }

              const toSorted = (set) => Array.from(set).sort();

              return {
                branch: rec.branch,
                lamp: rec.lamp,
                waterer: rec.waterer,
                timeValue,
                soup: toSorted(soup),
                tablet: toSorted(tablet),
                insect: toSorted(insect),
                normal: toSorted(normal),
              };
            };

            const buildPlanPayload = (rec) => {
              const summary = buildPlanSummary(rec);
              return {
                枝干: summary.branch,
                日照灯: summary.lamp,
                补水器: summary.waterer,
                适用时间: summary.timeValue,
                条件信息: {
                  需要滋补汤的菌菇种类: summary.soup,
                  需要消食片的菌菇种类: summary.tablet,
                  需要未杀虫的菌菇种类: summary.insect,
                  无特殊条件的菌菇种类: summary.normal,
                },
              };
            };

            const buildPlanCode = (rec) => {
              const summary = buildPlanSummary(rec);
              const branchCode = branchCodebook.map.get(summary.branch) || "0";
              const lampCode = lampCodebook.map.get(summary.lamp) || "0";
              const watererCode =
                watererCodebook.map.get(summary.waterer) || "0";
              const timeCode = encodeTimeValue(summary.timeValue);
              const soupCode = encodeList(summary.soup, categoryCodebook.map);
              const tabletCode = encodeList(
                summary.tablet,
                categoryCodebook.map
              );
              const insectCode = encodeList(
                summary.insect,
                categoryCodebook.map
              );
              const normalCode = encodeList(
                summary.normal,
                categoryCodebook.map
              );

              return `v1|b${branchCode}|l${lampCode}|w${watererCode}|t${timeCode}|s${soupCode}|p${tabletCode}|i${insectCode}|n${normalCode}`;
            };

            const decodePlanCode = (code) => {
              if (!code) return null;
              const parts = code.split("|");
              if (parts[0] !== "v1") return null;
              const values = {};
              for (let i = 1; i < parts.length; i++) {
                const segment = parts[i];
                if (!segment) continue;
                const key = segment.slice(0, 1);
                values[key] = segment.slice(1);
              }

              const branch =
                branchCodebook.list[parseInt(values.b || "0", 36)] || "/";
              const lamp =
                lampCodebook.list[parseInt(values.l || "0", 36)] || "/";
              const waterer =
                watererCodebook.list[parseInt(values.w || "0", 36)] || "/";

              return {
                枝干: branch,
                日照灯: lamp,
                补水器: waterer,
                适用时间: decodeTimeValue(values.t),
                条件信息: {
                  需要滋补汤的菌菇种类: decodeList(
                    values.s,
                    categoryCodebook.list
                  ),
                  需要消食片的菌菇种类: decodeList(
                    values.p,
                    categoryCodebook.list
                  ),
                  需要未杀虫的菌菇种类: decodeList(
                    values.i,
                    categoryCodebook.list
                  ),
                  无特殊条件的菌菇种类: decodeList(
                    values.n,
                    categoryCodebook.list
                  ),
                },
              };
            };

            const copyPlanCode = async (rec) => {
              const code = buildPlanCode(rec);
              if (!code) return;
              try {
                await navigator.clipboard.writeText(code);
              } catch (error) {
                const textarea = document.createElement("textarea");
                textarea.value = code;
                textarea.style.position = "fixed";
                textarea.style.opacity = "0";
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand("copy");
                document.body.removeChild(textarea);
              }
              showToast("已复制神秘代码");
            };

            const isSectionExpanded = (group) => {
              if (searchQuery.value && searchQuery.value.trim() !== "")
                return true;
              if (useIngameOrder.value) return true;
              if (manualToggleState[group.branchName] !== undefined) {
                return manualToggleState[group.branchName];
              }
              if (!group.isOwned) return false;
              if (group.isComplete) return false;
              return true;
            };

            const toggleSection = (group) => {
              const current = isSectionExpanded(group);
              manualToggleState[group.branchName] = !current;
            };

            const selectGroupAll = (group) => {
              if (!group || !Array.isArray(group.items)) return;
              const list = currentUser.value.collected;
              const pending = ensurePendingList();
              group.items.forEach((item) => {
                const resolvedId = normalizeMushroomId(item.id);
                if (!resolvedId) return;
                const pendingIdx = pending.indexOf(resolvedId);
                if (pendingIdx > -1) {
                  pending.splice(pendingIdx, 1);
                }
                if (!list.includes(resolvedId)) {
                  list.push(resolvedId);
                }
              });
            };

            const scrollToSection = (branchName) => {
              manualToggleState[branchName] = true;
              setTimeout(() => {
                const el = document.getElementById("group-" + branchName);
                if (el)
                  el.scrollIntoView({ behavior: "smooth", block: "start" });
              }, 50);
            };

            const groupedDatabase = computed(() => {
              const rawQuery = searchQuery.value.trim();
              const normalizedQuery = normalizeSearchValue(rawQuery);
              let filtered = database.filter((m) => {
                const matchName = rawQuery
                  ? matchesHandbookSearch(m, rawQuery, normalizedQuery)
                  : true;
                const matchCollected = showOnlyUncollected.value
                  ? !currentUser.value.collected.includes(m.id)
                  : true;
                return matchName && matchCollected;
              });

              const collectedSet = new Set(currentUser.value.collected);
              const getProgressClass = (collectedCount, totalCount) => {
                if (totalCount === 0 || collectedCount === 0)
                  return "progress-empty";
                if (collectedCount === totalCount) return "progress-complete";
                return "progress-partial";
              };

              if (useIngameOrder.value) {
                const ordered = filtered
                  .map((item, index) => ({
                    item,
                    index,
                    order: getIngameOrderIndex(item.name),
                  }))
                  .sort((a, b) => {
                    const orderDiff = a.order - b.order;
                    if (orderDiff !== 0) return orderDiff;
                    return a.index - b.index;
                  })
                  .map(({ item }) => item);
                const collectedCount = ordered.filter((i) =>
                  collectedSet.has(i.id)
                ).length;
                const totalCount = ordered.length;
                const isComplete =
                  totalCount > 0 && collectedCount === totalCount;
                return [
                  {
                    branchName: "游戏内排序",
                    items: ordered,
                    isOwned: true,
                    collectedCount,
                    totalCount,
                    isComplete,
                    progressClass: getProgressClass(collectedCount, totalCount),
                  },
                ];
              }

              const groups = {};
              allBranches.forEach((b) => (groups[b] = []));
              groups["/"] = [];

              filtered.forEach((m) => {
                if (groups[m.branch]) groups[m.branch].push(m);
                else groups["/"].push(m);
              });

              const result = [];
              allBranches.forEach((b) => {
                if (groups[b].length > 0) {
                  const isOwned =
                    currentUser.value.inventory.branches.includes(b);
                  const items = groups[b];
                  const collectedCount = items.filter((i) =>
                    collectedSet.has(i.id)
                  ).length;
                  const totalCount = items.length;
                  const isComplete = collectedCount === totalCount;
                  result.push({
                    branchName: b,
                    items: items,
                    isOwned,
                    collectedCount,
                    totalCount,
                    isComplete,
                    progressClass: getProgressClass(collectedCount, totalCount),
                  });
                }
              });
              if (groups["/"].length > 0) {
                const items = groups["/"];
                const collectedCount = items.filter((i) =>
                  collectedSet.has(i.id)
                ).length;
                const totalCount = items.length;
                const isComplete = collectedCount === totalCount;
                result.push({
                  branchName: "/",
                  items: items,
                  isOwned: true,
                  collectedCount,
                  totalCount,
                  isComplete,
                  progressClass: getProgressClass(collectedCount, totalCount),
                });
              }

              return result;
            });

            const buildRecommendations = (orderOnlyMode) => {
              if (!currentUser.value) return [];

              const orderList = orderTargets.value.filter(
                (order) => order && idSet.has(order.id)
              );

              let targetMushrooms = orderOnlyMode
                ? orderList
                : database.filter((m) => {
                    const isUncollected = !currentUser.value.collected.includes(
                      m.id
                    );
                    const isNotFailed = !m.isFailed;
                    return isUncollected && isNotFailed;
                  });

              targetMushrooms = targetMushrooms.filter(
                (m) => m.time === "/" || m.time === currentTime.value
              );

              if (targetMushrooms.length === 0) return [];

              const orderWeightEnabled =
                !orderOnlyMode &&
                showOrderHints.value &&
                orderAffectsRanking.value &&
                orderList.length > 0;

              const uniqueConfigs = new Set();
              targetMushrooms.forEach((m) => {
                if (!m.branch || !m.lamp || !m.waterer) return;
                uniqueConfigs.add(`${m.branch}|${m.lamp}|${m.waterer}`);
              });

              const results = [];
              const myInv = currentUser.value.inventory;

              uniqueConfigs.forEach((configKey) => {
                const [cBranch, cLamp, cWaterer] = configKey.split("|");

                const hasBranch =
                  cBranch === "/" || myInv.branches.includes(cBranch);
                const hasLamp = cLamp === "/" || myInv.lamps.includes(cLamp);
                const hasWaterer =
                  cWaterer === "/" || myInv.waterers.includes(cWaterer);

                if (!hasBranch || !hasLamp || !hasWaterer) return;

                const yields = [];
                targetMushrooms.forEach((m) => {
                  const matchBranch = m.branch === "/" || m.branch === cBranch;
                  const matchLamp = m.lamp === "/" || m.lamp === cLamp;
                  const matchWaterer =
                    m.waterer === "/" || m.waterer === cWaterer;

                  if (matchBranch && matchLamp && matchWaterer) {
                    yields.push(m);
                  }
                });

                if (yields.length === 0) return;

                if (!orderOnlyMode) {
                  const categoriesInThisConfig = new Set(
                    yields.map((m) => m.category)
                  );
                  categoriesInThisConfig.forEach((cat) => {
                    const failedVariant = database.find(
                      (m) => m.category === cat && m.isFailed
                    );
                    if (
                      failedVariant &&
                      !currentUser.value.collected.includes(failedVariant.id)
                    ) {
                      const alreadyInList = yields.some(
                        (m) => m.id === failedVariant.id
                      );
                      if (!alreadyInList) {
                        yields.push(failedVariant);
                      }
                    }
                  });
                }

                const orderMatches = [];
                orderList.forEach((order) => {
                  if (!order) return;
                  const orderBranch = order.branch || "";
                  const orderLamp = order.lamp || "";
                  const orderWaterer = order.waterer || "";
                  const orderTime = order.time || "";
                  const matchBranch =
                    orderBranch === "/" || orderBranch === cBranch;
                  const matchLamp = orderLamp === "/" || orderLamp === cLamp;
                  const matchWaterer =
                    orderWaterer === "/" || orderWaterer === cWaterer;
                  const matchTime =
                    orderTime === "/" ||
                    orderTime === currentTime.value ||
                    orderTime.includes(currentTime.value);
                  if (matchBranch && matchLamp && matchWaterer && matchTime) {
                    orderMatches.push(order);
                  }
                });

                const orderCount = orderMatches.length;
                const usefulIds = new Set();
                yields.forEach((item) => usefulIds.add(item.id));
                orderMatches.forEach((item) => usefulIds.add(item.id));
                const usefulCount = usefulIds.size;
                const score = orderWeightEnabled ? usefulCount : yields.length;
                let orderSources = [];
                if (orderOnlyMode && orders.value.length > 0) {
                  const yieldMap = new Map(
                    yields.map((item) => [item.id, item])
                  );
                  orders.value.forEach((order, orderIndex) => {
                    if (!order || !Array.isArray(order.items)) return;
                    const matchedMap = new Map();
                    order.items.forEach((item) => {
                      const resolvedId = normalizeMushroomId(item.id || "");
                      if (!resolvedId) return;
                      const yieldItem = yieldMap.get(resolvedId);
                      if (!yieldItem) return;
                      const required = Math.max(
                        1,
                        parseInt(item.required, 10) || 1
                      );
                      const existing = matchedMap.get(resolvedId);
                      if (existing) {
                        existing.required += required;
                      } else {
                        matchedMap.set(resolvedId, {
                          ...yieldItem,
                          required,
                        });
                      }
                    });
                    const matchedItems = Array.from(matchedMap.values());
                    if (matchedItems.length > 0) {
                      const label = formatOrderName(order.name);
                      const key = order.id || `${label}-${orderIndex}`;
                      orderSources.push({
                        id: key,
                        name: label,
                        items: matchedItems,
                      });
                    }
                  });
                }

                results.push({
                  key: configKey,
                  branch: cBranch,
                  lamp: cLamp,
                  waterer: cWaterer,
                  mushrooms: yields,
                  count: yields.length,
                  orderMatches,
                  orderCount,
                  usefulCount,
                  score,
                  orderSources,
                });
              });

              const pinnedBranch = (() => {
                for (const key of pinnedOrder.value) {
                  if (typeof key !== "string") continue;
                  const [branch] = key.split("|");
                  if (branch) return branch;
                }
                return "";
              })();

              results.sort((a, b) => {
                const scoreDiff = b.score - a.score;
                if (scoreDiff !== 0) return scoreDiff;
                if (pinnedBranch) {
                  const aMatch = a.branch === pinnedBranch;
                  const bMatch = b.branch === pinnedBranch;
                  if (aMatch !== bMatch) return aMatch ? -1 : 1;
                }
                const countDiff = b.count - a.count;
                if (countDiff !== 0) return countDiff;
                return 0;
              });

              const finalResults = [];
              const hiddenIndices = new Set();

              for (let i = 0; i < results.length; i++) {
                if (hiddenIndices.has(i)) continue;
                const bigPlan = results[i];
                const bigPlanIds = new Set(bigPlan.mushrooms.map((m) => m.id));

                for (let j = i + 1; j < results.length; j++) {
                  if (hiddenIndices.has(j)) continue;
                  const smallPlan = results[j];
                  if (isPlanPinned(smallPlan)) continue;
                  const isSubset = smallPlan.mushrooms.every((m) =>
                    bigPlanIds.has(m.id)
                  );
                  if (isSubset) hiddenIndices.add(j);
                }
                finalResults.push(bigPlan);
              }

              const planMap = new Map(
                finalResults.map((plan) => [plan.key, plan])
              );
              const pinnedList = [];
              const pinnedSet = new Set();

              pinnedOrder.value.forEach((key) => {
                const plan = planMap.get(key);
                if (plan && !pinnedSet.has(key)) {
                  pinnedList.push(plan);
                  pinnedSet.add(key);
                }
              });

              const unpinnedList = finalResults.filter(
                (plan) => !pinnedSet.has(plan.key)
              );

              return [...pinnedList, ...unpinnedList];
            };

            const recommendations = computed(() => buildRecommendations(false));
            const orderRecommendations = computed(() =>
              buildRecommendations(true)
            );
            const activeRecommendations = computed(() =>
              currentTab.value === "order"
                ? orderRecommendations.value
                : recommendations.value
            );

            return {
              database,
              allBranches,
              allLamps,
              allWaterers,
              currentTab,
              currentTime,
              searchQuery,
              useIngameOrder,
              showOnlyUncollected,
              handbookPickerVisible,
              handbookPickerCategory,
              orderQuery,
              orderPickerVisible,
              orderPickerCategory,
              showOrderHints,
              orderAffectsRanking,
              orderPresets,
              orderDraft,
              orderFormVisible,
              orderListCollapsed,
              orderHoverTip,
              toggleOrderListCollapse,
              orderPanelRef,
              recListTop,
              orders,
              orderTargets,
              orderCandidates,
              orderCategoryGroups,
              orderActiveCategory,
              setOrderPickerCategory,
              handbookCategoryGroups,
              handbookActiveCategory,
              setHandbookPickerCategory,
              markHandbookCollected,
              startNewOrder,
              setOrderPreset,
              addOrderItem,
              removeOrderItem,
              setOrderCount,
              setOrderRequired,
              getOrderCount,
              getOrderRequiredTotal,
              isOrderItemMet,
              incrementOrderCount,
              requestOrderIncrement,
              getOrderItem,
              getOrderItemName,
              formatOrderName,
              getOrderReward,
              isThreeColumnOrder,
              isEditingOrder,
              saveOrder,
              editOrder,
              cancelOrderEdit,
              deleteOrder,
              isOrderReady,
              deliverOrder,
              reversedOrderHistory,
              formatOrderRecord,
              getOrderRecordTitle,
              getOrderRecordActionLabel,
              revokeOrderRecord,
              readyOrders,
              readyOrderMessage,
              orderFloatPulse,
              orderFloatCollapsed,
              panelNotice,
              undoPanelNotice,
              focusOrderId,
              focusOrderCard,
              isLongTimeMushroom,
              hasLongTimeInPlan,
              getRarityClass,
              getLegendaryCount,
              getImmortalTagStyle,
              getComplexityLabel,
              getComplexityClass,
              getOrderTargetInfoLines,
              showOrderHoverTip,
              moveOrderHoverTip,
              hideOrderHoverTip,
              users,
              currentUserIndex,
              currentUser,
              isInventoryEmpty,
              isHandbookEmpty,
              unlockableCount,
              unlockableByTime,
              addUser,
              deleteUser,
              exportUserData,
              triggerImport,
              handleImportFile,
              importInput,
              toggleInventory,
              toggleCollected,
              groupedDatabase,
              recommendations,
              activeRecommendations,
              toastMessage,
              toastVisible,
              isPlanPinned,
              togglePinPlan,
              toggleTime,
              handleImgError,
              getBadgeClass,
              isMushroomObtainable,
              handleCollectionClick,
              isPendingHarvest,
              confirmHarvest,
              cancelHarvest,
              reversedHistory,
              getHistoryName,
              revokeHistoryItem,
              formatTime,
              buildPlanCode,
              copyPlanCode,
              getMushroomImgSrc,
              getOrderTargetImgSrc,
              isSectionExpanded,
              toggleSection,
              selectGroupAll,
              scrollToSection,
            };
          },
        }).mount("#app");
      };

      loadCsvDatabase().then(initApp);
    </script>
  </body>
</html>
